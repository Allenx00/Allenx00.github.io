<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NeoSystem 高级监控终端 v4.0 - 安全登录</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- 代码高亮库 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/atom-one-dark.min.css">
    <!-- Leaflet地图库 -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    
    <script>hljs.highlightAll();</script>
    <style>
        :root {
            --primary: #00f3ff;
            --primary-dark: #0066ff;
            --secondary: #ff00ff;
            --ai-color: #00ff9d;
            --library-color: #ffcc00;
            --game-color: #ff6b6b;
            --map-color: #00cc88;
            --dark-bg: #0a0a16;
            --darker-bg: #050510;
            --card-bg: rgba(10, 15, 30, 0.8);
            --border-color: rgba(0, 243, 255, 0.2);
            --text-primary: #ffffff;
            --text-secondary: #b0b0ff;
            --success: #00ff9d;
            --warning: #ffcc00;
            --danger: #ff4757;
            --user-msg-bg: rgba(0, 102, 255, 0.2);
            --ai-msg-bg: rgba(0, 255, 157, 0.1);
            --library-bg: rgba(255, 204, 0, 0.1);
            --game-bg: rgba(255, 107, 107, 0.1);
            --map-bg: rgba(0, 204, 136, 0.1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Roboto Mono', monospace;
        }
        
        body {
            background-color: var(--darker-bg);
            color: var(--text-primary);
            overflow: hidden;
            height: 100vh;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(0, 102, 255, 0.1) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(255, 0, 255, 0.1) 0%, transparent 20%);
        }
        
        /* 登录界面样式 */
        .login-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(135deg, #0a0a16 0%, #050510 100%);
            z-index: 9999;
            transition: opacity 0.8s ease-in-out;
        }
        
        .login-container.hidden {
            opacity: 0;
            pointer-events: none;
            z-index: -1;
        }
        
        .login-box {
            width: 100%;
            max-width: 450px;
            background: rgba(5, 10, 20, 0.95);
            border-radius: 15px;
            padding: 50px 40px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }
        
        .login-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
        }
        
        .login-header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .login-logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            font-size: 2.2rem;
            font-weight: 700;
            color: var(--primary);
            text-shadow: 0 0 15px rgba(0, 243, 255, 0.7);
            margin-bottom: 10px;
        }
        
        .login-logo i {
            color: var(--secondary);
            font-size: 2.5rem;
        }
        
        .login-subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
            letter-spacing: 1px;
        }
        
        .login-form {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        
        .form-group {
            position: relative;
        }
        
        .form-label {
            display: block;
            margin-bottom: 10px;
            color: var(--text-secondary);
            font-size: 1rem;
        }
        
        .form-input {
            width: 100%;
            padding: 15px 20px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 1.1rem;
            transition: all 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 10px rgba(0, 243, 255, 0.3);
        }
        
        .form-input.error {
            border-color: var(--danger);
            box-shadow: 0 0 10px rgba(255, 71, 87, 0.3);
        }
        
        .password-toggle {
            position: absolute;
            right: 15px;
            top: 45px;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 1.2rem;
        }
        
        .login-btn {
            padding: 16px;
            background: linear-gradient(90deg, var(--primary), var(--primary-dark));
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }
        
        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 243, 255, 0.4);
        }
        
        .login-btn:active {
            transform: translateY(0);
        }
        
        .login-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .login-footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        .login-error {
            background: rgba(255, 71, 87, 0.1);
            border: 1px solid var(--danger);
            border-radius: 8px;
            padding: 12px 15px;
            color: var(--danger);
            font-size: 0.9rem;
            margin-top: 10px;
            display: none;
        }
        
        .login-error.show {
            display: block;
            animation: shake 0.5s ease-in-out;
        }
        
        .login-loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(0, 243, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
        }
        
        .access-code {
            color: var(--warning);
            font-weight: bold;
            letter-spacing: 2px;
            background: rgba(255, 204, 0, 0.1);
            padding: 5px 10px;
            border-radius: 4px;
            margin: 0 5px;
        }
        
        .security-notice {
            background: rgba(0, 102, 255, 0.1);
            border: 1px solid var(--primary);
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            font-size: 0.9rem;
        }
        
        .security-notice h4 {
            color: var(--primary);
            margin-bottom: 8px;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* 网格背景 */
        .grid-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(0, 243, 255, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 243, 255, 0.05) 1px, transparent 1px);
            background-size: 50px 50px;
            z-index: -1;
        }
        
        .container {
            display: flex;
            height: 100vh;
            position: relative;
            opacity: 0;
            transition: opacity 0.8s ease-in-out;
        }
        
        .container.show {
            opacity: 1;
        }
        
        /* 侧边栏 */
        .sidebar {
            width: 280px;
            background-color: rgba(5, 10, 20, 0.9);
            backdrop-filter: blur(10px);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            z-index: 10;
            box-shadow: 0 0 30px rgba(0, 102, 255, 0.2);
        }
        
        .logo-area {
            padding: 25px 20px;
            border-bottom: 1px solid var(--border-color);
            text-align: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
            text-shadow: 0 0 10px rgba(0, 243, 255, 0.7);
        }
        
        .logo i {
            color: var(--secondary);
        }
        
        .version {
            font-size: 0.7rem;
            color: var(--text-secondary);
            margin-top: 5px;
            letter-spacing: 1px;
        }
        
        .nav-menu {
            flex: 1;
            padding: 30px 0;
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            padding: 18px 25px;
            cursor: pointer;
            transition: all 0.3s;
            border-left: 4px solid transparent;
            gap: 15px;
            color: var(--text-secondary);
        }
        
        .nav-item:hover {
            background-color: rgba(0, 102, 255, 0.1);
            color: var(--text-primary);
        }
        
        .nav-item.active {
            background-color: rgba(0, 102, 255, 0.15);
            border-left-color: var(--primary);
            color: var(--text-primary);
        }
        
        .nav-item.ai-item {
            position: relative;
        }
        
        .nav-item.ai-item::after {
            content: "NEW";
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: var(--ai-color);
            color: var(--darker-bg);
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }
        
        .nav-item.library-item {
            position: relative;
        }
        
        .nav-item.library-item::after {
            content: "UPD";
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: var(--library-color);
            color: var(--darker-bg);
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }
        
        .nav-item.game-item {
            position: relative;
        }
        
        .nav-item.game-item::after {
            content: "NEW";
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: var(--game-color);
            color: var(--darker-bg);
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }
        
        .nav-item.map-item {
            position: relative;
        }
        
        .nav-item.map-item::after {
            content: "NEW";
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: var(--map-color);
            color: var(--darker-bg);
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }
        
        .nav-item i {
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
        }
        
        .nav-text {
            font-size: 1.1rem;
        }
        
        .system-status-sidebar {
            padding: 20px;
            border-top: 1px solid var(--border-color);
        }
        
        .status-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 0.9rem;
        }
        
        .status-label {
            color: var(--text-secondary);
        }
        
        .status-value {
            color: var(--primary);
            font-weight: 600;
        }
        
        /* 主内容区域 */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 20px;
            overflow: hidden;
        }
        
        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .page-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .page-title i {
            color: var(--secondary);
        }
        
        .time-display {
            font-size: 1.2rem;
            color: var(--text-secondary);
            font-weight: 600;
        }
        
        .content-area {
            flex: 1;
            overflow: auto;
            padding-right: 10px;
        }
        
        /* 隐藏滚动条但保持功能 */
        .content-area::-webkit-scrollbar {
            width: 8px;
        }
        
        .content-area::-webkit-scrollbar-track {
            background: rgba(0, 102, 255, 0.1);
            border-radius: 4px;
        }
        
        .content-area::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }
        
        /* 页面样式 */
        .page {
            display: none;
            animation: fadeIn 0.5s;
            height: 100%;
        }
        
        .page.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* AI助手页面 */
        .ai-assistant-container {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        .ai-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .ai-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--ai-color), var(--primary));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            color: var(--darker-bg);
        }
        
        .ai-info {
            flex: 1;
        }
        
        .ai-name {
            font-size: 1.5rem;
            color: var(--ai-color);
            margin-bottom: 5px;
        }
        
        .ai-status {
            font-size: 0.9rem;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .ai-status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--success);
            animation: pulse 2s infinite;
        }
        
        .ai-chat-container {
            display: flex;
            flex-direction: column;
            height: calc(100% - 150px);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            overflow: hidden;
            background-color: var(--card-bg);
        }
        
        .ai-chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .ai-message {
            max-width: 80%;
            padding: 15px;
            border-radius: 12px;
            line-height: 1.5;
            position: relative;
        }
        
        .ai-message.user {
            align-self: flex-end;
            background-color: var(--user-msg-bg);
            border-bottom-right-radius: 4px;
        }
        
        .ai-message.assistant {
            align-self: flex-start;
            background-color: var(--ai-msg-bg);
            border-bottom-left-radius: 4px;
            border-left: 3px solid var(--ai-color);
        }
        
        .ai-message-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }
        
        .ai-message.user .ai-message-header {
            color: var(--primary);
        }
        
        .ai-message.assistant .ai-message-header {
            color: var(--ai-color);
        }
        
        .ai-message-content {
            font-size: 1rem;
        }
        
        .ai-message-content pre {
            background-color: rgba(0, 0, 0, 0.3);
            padding: 10px;
            border-radius: 6px;
            overflow-x: auto;
            margin-top: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }
        
        .ai-message-content code {
            background-color: rgba(0, 0, 0, 0.3);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }
        
        .ai-chat-input {
            border-top: 1px solid var(--border-color);
            padding: 20px;
            background-color: rgba(0, 0, 0, 0.2);
        }
        
        .ai-input-group {
            display: flex;
            gap: 10px;
        }
        
        .ai-input-field {
            flex: 1;
            padding: 15px;
            background-color: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 1rem;
            resize: none;
            min-height: 60px;
            max-height: 120px;
        }
        
        .ai-input-field:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .ai-send-btn {
            padding: 15px 25px;
            background: linear-gradient(90deg, var(--ai-color), #00cc80);
            border: none;
            border-radius: 8px;
            color: var(--darker-bg);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            align-self: flex-end;
        }
        
        .ai-send-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 255, 157, 0.4);
        }
        
        .ai-quick-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        
        .ai-quick-btn {
            padding: 8px 15px;
            background-color: rgba(0, 102, 255, 0.1);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            color: var(--text-secondary);
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .ai-quick-btn:hover {
            background-color: rgba(0, 102, 255, 0.2);
            color: var(--text-primary);
        }
        
        /* AI配置面板 */
        .ai-config-panel {
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            border: 1px solid var(--border-color);
        }
        
        .ai-config-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            cursor: pointer;
        }
        
        .ai-config-title {
            font-size: 1rem;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .ai-config-content {
            display: none;
        }
        
        .ai-config-content.expanded {
            display: block;
        }
        
        .config-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .config-row {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .config-label {
            width: 100px;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        .config-input {
            flex: 1;
            padding: 10px;
            background-color: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 0.9rem;
        }
        
        .config-input:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .config-select {
            flex: 1;
            padding: 10px;
            background-color: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 0.9rem;
        }
        
        .config-btn {
            padding: 8px 15px;
            background: linear-gradient(90deg, var(--primary), var(--primary-dark));
            border: none;
            border-radius: 6px;
            color: white;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .config-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 243, 255, 0.4);
        }
        
        .config-btn-secondary {
            background: linear-gradient(90deg, var(--secondary), #cc00ff);
        }
        
        .api-status {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            margin-top: 10px;
        }
        
        .api-status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }
        
        .api-status-dot.connected {
            background-color: var(--success);
            animation: pulse 2s infinite;
        }
        
        .api-status-dot.disconnected {
            background-color: var(--danger);
        }
        
        .ai-mode-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .mode-btn {
            padding: 8px 15px;
            background-color: rgba(0, 102, 255, 0.1);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            color: var(--text-secondary);
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .mode-btn.active {
            background-color: rgba(0, 102, 255, 0.2);
            color: var(--text-primary);
            border-color: var(--primary);
        }
        
        /* 仪表板页面 */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 25px;
        }
        
        .dashboard-card {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            border: 1px solid var(--border-color);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .dashboard-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
        }
        
        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 102, 255, 0.3);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .card-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--primary);
        }
        
        .card-icon {
            font-size: 1.8rem;
            color: var(--secondary);
        }
        
        .card-content {
            font-size: 1rem;
            line-height: 1.6;
        }
        
        /* 系统监控页面 */
        .monitor-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 25px;
        }
        
        .resource-monitor {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            border: 1px solid var(--border-color);
        }
        
        .monitor-title {
            font-size: 1.5rem;
            margin-bottom: 25px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .resource-item {
            margin-bottom: 30px;
        }
        
        .resource-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .resource-name {
            font-size: 1.1rem;
            color: var(--text-primary);
        }
        
        .resource-percent {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary);
        }
        
        .progress-container {
            height: 12px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            border-radius: 6px;
            transition: width 1s ease-in-out;
        }
        
        .cpu-progress {
            background: linear-gradient(90deg, #00f3ff, #0066ff);
        }
        
        .memory-progress {
            background: linear-gradient(90deg, #ff00ff, #ff0066);
        }
        
        .storage-progress {
            background: linear-gradient(90deg, #00ff9d, #00ccff);
        }
        
        .network-progress {
            background: linear-gradient(90deg, #ffcc00, #ff6600);
        }
        
        .resource-details {
            display: flex;
            justify-content: space-between;
            margin-top: 8px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .data-source {
            font-size: 0.7rem;
            color: var(--warning);
            margin-top: 5px;
            font-style: italic;
        }
        
        .system-info {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            border: 1px solid var(--border-color);
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .info-item {
            padding: 15px;
            background-color: rgba(0, 102, 255, 0.1);
            border-radius: 8px;
        }
        
        .info-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }
        
        .info-value {
            font-size: 1.2rem;
            color: var(--primary);
            font-weight: 600;
        }
        
        /* 网络工具页面 */
        .network-tools {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
        }
        
        .tool-card {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            border: 1px solid var(--border-color);
        }
        
        .tool-title {
            font-size: 1.3rem;
            margin-bottom: 20px;
            color: var(--primary);
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-secondary);
        }
        
        .input-field {
            width: 100%;
            padding: 12px 15px;
            background-color: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 1rem;
        }
        
        .btn {
            padding: 12px 25px;
            background: linear-gradient(90deg, var(--primary), var(--primary-dark));
            border: none;
            border-radius: 6px;
            color: white;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 243, 255, 0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(90deg, var(--secondary), #cc00ff);
        }
        
        .btn-game {
            background: linear-gradient(90deg, var(--game-color), #ff4757);
        }
        
        .btn-game:hover {
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
        }
        
        .btn-map {
            background: linear-gradient(90deg, var(--map-color), #00aa77);
        }
        
        .btn-map:hover {
            box-shadow: 0 5px 15px rgba(0, 204, 136, 0.4);
        }
        
        .result-box {
            margin-top: 20px;
            padding: 15px;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
            border: 1px solid var(--border-color);
            min-height: 150px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            white-space: pre-wrap;
        }
        
        /* 进程管理器 */
        .process-manager {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        .process-controls {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .process-list {
            flex: 1;
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid var(--border-color);
            overflow-y: auto;
        }
        
        .process-header {
            display: grid;
            grid-template-columns: 3fr 1fr 1fr 1fr 1fr;
            padding: 15px;
            background-color: rgba(0, 102, 255, 0.1);
            border-radius: 8px;
            margin-bottom: 15px;
            font-weight: 600;
            color: var(--primary);
        }
        
        .process-row {
            display: grid;
            grid-template-columns: 3fr 1fr 1fr 1fr 1fr;
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
            transition: background-color 0.2s;
        }
        
        .process-row:hover {
            background-color: rgba(0, 102, 255, 0.05);
        }
        
        .process-row.selected {
            background-color: rgba(0, 102, 255, 0.15);
        }
        
        .process-name {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .process-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(0, 243, 255, 0.2);
            color: var(--primary);
        }
        
        /* 文件管理器 */
        .file-manager {
            display: grid;
            grid-template-columns: 1fr 3fr;
            gap: 25px;
            height: 100%;
        }
        
        .file-sidebar {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            border: 1px solid var(--border-color);
        }
        
        .file-list {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            border: 1px solid var(--border-color);
        }
        
        .directory-item {
            padding: 12px 15px;
            margin-bottom: 8px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .directory-item:hover {
            background-color: rgba(0, 102, 255, 0.1);
        }
        
        .directory-item.active {
            background-color: rgba(0, 102, 255, 0.2);
            border-left: 3px solid var(--primary);
        }
        
        .file-item {
            display: flex;
            align-items: center;
            padding: 12px;
            border-bottom: 1px solid var(--border-color);
            gap: 12px;
        }
        
        .file-item:hover {
            background-color: rgba(0, 102, 255, 0.05);
        }
        
        .file-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
        }
        
        .file-info {
            flex: 1;
        }
        
        .file-name {
            font-weight: 500;
            margin-bottom: 4px;
        }
        
        .file-details {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        
        /* 设置页面 */
        .settings-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
        }
        
        .settings-card {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            border: 1px solid var(--border-color);
        }
        
        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid var(--border-color);
        }
        
        .setting-label {
            color: var(--text-primary);
            font-size: 1.1rem;
        }
        
        /* 开关按钮 */
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.1);
            transition: .4s;
            border-radius: 34px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: var(--text-primary);
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: var(--primary);
        }
        
        input:checked + .slider:before {
            transform: translateX(30px);
        }
        
        /* 图书馆页面样式 */
        .library-container {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        .library-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .library-title {
            font-size: 2rem;
            color: var(--library-color);
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .library-title i {
            color: var(--library-color);
        }
        
        .library-search {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .search-input {
            padding: 12px 20px;
            background-color: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 1rem;
            width: 300px;
        }
        
        .search-input:focus {
            outline: none;
            border-color: var(--library-color);
        }
        
        .search-btn {
            padding: 12px 20px;
            background: linear-gradient(90deg, var(--library-color), #ff9900);
            border: none;
            border-radius: 8px;
            color: var(--darker-bg);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .search-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 204, 0, 0.4);
        }
        
        .language-categories {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        .category-btn {
            padding: 10px 20px;
            background-color: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .category-btn:hover {
            background-color: rgba(255, 204, 0, 0.1);
            color: var(--text-primary);
        }
        
        .category-btn.active {
            background-color: rgba(255, 204, 0, 0.2);
            color: var(--library-color);
            border-color: var(--library-color);
        }
        
        .library-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 25px;
            height: calc(100% - 150px);
        }
        
        .language-sidebar {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid var(--border-color);
            overflow-y: auto;
        }
        
        .language-list {
            list-style: none;
        }
        
        .language-item {
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            border-left: 4px solid transparent;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .language-item:hover {
            background-color: rgba(255, 204, 0, 0.1);
        }
        
        .language-item.active {
            background-color: rgba(255, 204, 0, 0.2);
            border-left-color: var(--library-color);
        }
        
        .language-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--darker-bg);
        }
        
        .language-info {
            flex: 1;
        }
        
        .language-name {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .language-type {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        
        .language-detail {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 30px;
            border: 1px solid var(--border-color);
            overflow-y: auto;
        }
        
        .language-detail-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .language-detail-icon {
            width: 80px;
            height: 80px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            color: var(--darker-bg);
        }
        
        .language-detail-info {
            flex: 1;
        }
        
        .language-detail-name {
            font-size: 2rem;
            color: var(--library-color);
            margin-bottom: 10px;
        }
        
        .language-detail-meta {
            display: flex;
            gap: 20px;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        .language-detail-content {
            margin-bottom: 30px;
        }
        
        .language-detail-section {
            margin-bottom: 25px;
        }
        
        .section-title {
            font-size: 1.3rem;
            color: var(--library-color);
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .language-description {
            line-height: 1.6;
            margin-bottom: 20px;
        }
        
        .language-features {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .feature-item {
            padding: 10px;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
            border-left: 3px solid var(--library-color);
        }
        
        .feature-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--library-color);
        }
        
        .code-example {
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            overflow-x: auto;
        }
        
        .code-example pre {
            margin: 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .code-example-title {
            color: var(--library-color);
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .code-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
        }
        
        .code-tab {
            padding: 8px 15px;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .code-tab:hover {
            background-color: rgba(255, 204, 0, 0.1);
        }
        
        .code-tab.active {
            background-color: rgba(255, 204, 0, 0.2);
            color: var(--library-color);
        }
        
        .resource-links {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
        }
        
        .resource-link {
            padding: 10px 15px;
            background-color: rgba(0, 102, 255, 0.1);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
        }
        
        .resource-link:hover {
            background-color: rgba(0, 102, 255, 0.2);
            transform: translateY(-2px);
        }
        
        /* 游戏页面样式 */
        .games-container {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        .games-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .games-title {
            font-size: 2rem;
            color: var(--game-color);
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .games-title i {
            color: var(--game-color);
        }
        
        .game-categories {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        .game-category-btn {
            padding: 10px 20px;
            background-color: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .game-category-btn:hover {
            background-color: rgba(255, 107, 107, 0.1);
            color: var(--text-primary);
        }
        
        .game-category-btn.active {
            background-color: rgba(255, 107, 107, 0.2);
            color: var(--game-color);
            border-color: var(--game-color);
        }
        
        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
            height: calc(100% - 150px);
        }
        
        .game-card {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            border: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            transition: all 0.3s;
        }
        
        .game-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--game-color), #ff4757);
        }
        
        .game-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(255, 107, 107, 0.3);
        }
        
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .game-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--game-color);
        }
        
        .game-icon {
            font-size: 2rem;
            color: var(--game-color);
        }
        
        .game-description {
            margin-bottom: 20px;
            line-height: 1.6;
            color: var(--text-secondary);
        }
        
        /* CPS测试游戏 */
        .cps-game-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            background-color: rgba(0, 0, 0, 0.2);
            margin-top: 15px;
        }
        
        .cps-display {
            font-size: 3rem;
            font-weight: 700;
            color: var(--game-color);
            margin-bottom: 20px;
            text-shadow: 0 0 10px rgba(255, 107, 107, 0.5);
        }
        
        .cps-timer {
            font-size: 1.5rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }
        
        .cps-button {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--game-color), #ff4757);
            border: none;
            color: white;
            font-size: 1.5rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.1s;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 20px rgba(255, 107, 107, 0.3);
            margin-bottom: 20px;
        }
        
        .cps-button:hover {
            transform: scale(1.05);
        }
        
        .cps-button:active {
            transform: scale(0.95);
            box-shadow: 0 5px 10px rgba(255, 107, 107, 0.5);
        }
        
        .cps-button.disabled {
            background: linear-gradient(135deg, #555, #777);
            cursor: not-allowed;
        }
        
        .cps-button.disabled:active {
            transform: scale(1);
        }
        
        .cps-results {
            margin-top: 20px;
            text-align: center;
            width: 100%;
        }
        
        .cps-result-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .cps-result-label {
            color: var(--text-secondary);
        }
        
        .cps-result-value {
            color: var(--game-color);
            font-weight: 600;
        }
        
        /* 打字游戏 */
        .typing-game-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            background-color: rgba(0, 0, 0, 0.2);
            margin-top: 15px;
        }
        
        .typing-display {
            font-size: 1.8rem;
            color: var(--game-color);
            margin-bottom: 20px;
            text-align: center;
            line-height: 1.5;
        }
        
        .typing-input {
            width: 100%;
            padding: 15px;
            background-color: rgba(0, 0, 0, 0.3);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 1.2rem;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .typing-input:focus {
            outline: none;
            border-color: var(--game-color);
        }
        
        .typing-stats {
            display: flex;
            justify-content: space-around;
            width: 100%;
            margin-bottom: 20px;
        }
        
        .typing-stat {
            text-align: center;
        }
        
        .typing-stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--game-color);
        }
        
        .typing-stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .typing-text-container {
            width: 100%;
            height: 200px;
            overflow-y: auto;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
        }
        
        .typing-text {
            font-size: 1.2rem;
            line-height: 1.6;
            color: var(--text-secondary);
        }
        
        .typing-correct {
            color: var(--success);
            background-color: rgba(0, 255, 157, 0.1);
        }
        
        .typing-incorrect {
            color: var(--danger);
            background-color: rgba(255, 71, 87, 0.1);
            text-decoration: underline;
        }
        
        .typing-current {
            background-color: rgba(255, 107, 107, 0.2);
            color: var(--game-color);
        }
        
        /* 世界地图页面样式 */
        .worldmap-container {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        .worldmap-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .worldmap-title {
            font-size: 2rem;
            color: var(--map-color);
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .worldmap-title i {
            color: var(--map-color);
        }
        
        .worldmap-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        .worldmap-content {
            display: grid;
            grid-template-columns: 3fr 1fr;
            gap: 25px;
            height: calc(100% - 120px);
        }
        
        .worldmap-display {
            background-color: var(--card-bg);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            overflow: hidden;
            position: relative;
        }
        
        #worldmap {
            width: 100%;
            height: 100%;
            background-color: #0a1929;
        }
        
        .worldmap-sidebar {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        
        .map-stats-card {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            border: 1px solid var(--border-color);
            position: relative;
            overflow: hidden;
        }
        
        .map-stats-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--map-color), #00aa77);
        }
        
        .map-stats-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--map-color);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .map-stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .map-stat-item {
            padding: 12px;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            border-left: 3px solid var(--map-color);
        }
        
        .map-stat-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }
        
        .map-stat-value {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--map-color);
        }
        
        .map-controls-card {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            border: 1px solid var(--border-color);
        }
        
        .map-controls-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--map-color);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .map-layer-controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .layer-control-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid var(--border-color);
        }
        
        .layer-control-label {
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--text-primary);
        }
        
        .map-legend {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.9rem;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
        }
        
        .legend-color.green {
            background-color: #00ff9d;
        }
        
        .legend-color.blue {
            background-color: #00a8ff;
        }
        
        .legend-color.red {
            background-color: #ff4757;
        }
        
        .legend-color.yellow {
            background-color: #ffcc00;
        }
        
        .legend-color.purple {
            background-color: #9c88ff;
        }
        
        /* 地图弹出窗口样式 */
        .map-popup {
            background-color: var(--card-bg);
            border: 1px solid var(--map-color);
            border-radius: 8px;
            padding: 15px;
            color: var(--text-primary);
            font-size: 0.9rem;
            min-width: 200px;
        }
        
        .map-popup-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--map-color);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .map-popup-content {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .map-popup-item {
            display: flex;
            justify-content: space-between;
        }
        
        .map-popup-label {
            color: var(--text-secondary);
        }
        
        .map-popup-value {
            color: var(--map-color);
            font-weight: 500;
        }
        
        /* 地图标记动画 */
        .map-marker-pulse {
            animation: pulse 2s infinite;
        }
        
        .map-marker-attack {
            animation: attackPulse 1.5s infinite;
        }
        
        @keyframes attackPulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 71, 87, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(255, 71, 87, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 71, 87, 0); }
        }
        
        /* 地图工具提示 */
        .map-tooltip {
            position: absolute;
            padding: 10px;
            background-color: rgba(5, 10, 20, 0.9);
            border: 1px solid var(--map-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 0.8rem;
            z-index: 1000;
            pointer-events: none;
            display: none;
            max-width: 300px;
        }
        
        /* 响应式设计 */
        @media (max-width: 1200px) {
            .monitor-grid, .network-tools, .settings-container {
                grid-template-columns: 1fr;
            }
            
            .file-manager {
                grid-template-columns: 1fr;
            }
            
            .library-content {
                grid-template-columns: 1fr;
            }
            
            .language-features {
                grid-template-columns: 1fr;
            }
            
            .games-grid {
                grid-template-columns: 1fr;
            }
            
            .worldmap-content {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .sidebar {
                width: 70px;
            }
            
            .logo-area .logo-text, .nav-text {
                display: none;
            }
            
            .logo-area {
                padding: 20px 10px;
            }
            
            .nav-item {
                justify-content: center;
                padding: 20px 10px;
            }
            
            .system-status-sidebar {
                display: none;
            }
            
            .library-header, .games-header, .worldmap-header {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
            
            .search-input {
                width: 100%;
            }
            
            .login-box {
                padding: 30px 20px;
                margin: 20px;
            }
            
            .login-logo {
                font-size: 1.8rem;
            }
            
            .worldmap-controls {
                flex-direction: column;
                align-items: flex-start;
            }
        }
        
        /* 连接状态指示器 */
        .connection-status {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }
        
        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: var(--success);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        /* 数据可视化图表 */
        .chart-container {
            height: 200px;
            margin-top: 20px;
            position: relative;
        }
        
        .chart-line {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: flex-end;
            justify-content: space-between;
        }
        
        .chart-bar {
            width: 12px;
            background: linear-gradient(to top, var(--primary), var(--primary-dark));
            border-radius: 3px 3px 0 0;
            transition: height 0.5s;
        }
        
        /* 通知 */
        .notification {
            position: fixed;
            bottom: 30px;
            right: 30px;
            padding: 15px 25px;
            background-color: var(--card-bg);
            border-left: 4px solid var(--primary);
            border-radius: 6px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            transform: translateX(100%);
            transition: transform 0.3s;
            max-width: 400px;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification-title {
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        /* 命令终端样式 */
        .terminal-output {
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .terminal-command {
            color: var(--ai-color);
        }
        
        .terminal-output {
            color: var(--text-secondary);
        }
        
        .terminal-error {
            color: var(--danger);
        }
        
        .terminal-success {
            color: var(--success);
        }
        
        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 5px;
            color: var(--text-secondary);
            font-style: italic;
        }
        
        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--ai-color);
            animation: typingPulse 1.5s infinite ease-in-out;
        }
        
        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }
        
        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }
        
        @keyframes typingPulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }
        
        /* 命令提示 */
        .command-hint {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 5px;
            font-style: italic;
        }
        
        /* 登出按钮 */
        .logout-btn {
            padding: 8px 15px;
            background: linear-gradient(90deg, var(--danger), #ff2e4e);
            border: none;
            border-radius: 6px;
            color: white;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
            margin-left: 10px;
        }
        
        .logout-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 71, 87, 0.4);
        }
        /* === 新增的代码编辑器、量子计算、机器学习样式 === */

        /* 代码编辑器页面样式 */
        .codeeditor-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            gap: 20px;
        }

        .codeeditor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .codeeditor-title {
            font-size: 2rem;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .codeeditor-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .codeeditor-content {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 25px;
            height: calc(100vh - 180px);
            overflow: hidden;
        }

        .editor-sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
            overflow-y: auto;
        }

        .file-explorer, .language-selector, .editor-settings {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid var(--border-color);
        }

        .file-list {
            margin-top: 15px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .file-item {
            padding: 12px 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 12px;
            border-left: 3px solid transparent;
        }

        .file-item:hover {
            background-color: rgba(0, 102, 255, 0.1);
        }

        .file-item.active {
            background-color: rgba(0, 102, 255, 0.2);
            border-left-color: var(--primary);
        }

        .editor-main {
            display: flex;
            flex-direction: column;
            gap: 15px;
            overflow: hidden;
        }

        .editor-tabs {
            display: flex;
            gap: 5px;
            background-color: var(--card-bg);
            border-radius: 8px 8px 0 0;
            padding: 10px 15px 0 15px;
            border: 1px solid var(--border-color);
            border-bottom: none;
            flex-wrap: wrap;
        }

        .editor-tab {
            padding: 8px 15px;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 6px 6px 0 0;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 120px;
        }

        .editor-tab:hover {
            background-color: rgba(0, 102, 255, 0.1);
        }

        .editor-tab.active {
            background-color: var(--card-bg);
            border-bottom: 3px solid var(--primary);
        }

        .code-editor-wrapper {
            flex: 1;
            background-color: var(--card-bg);
            border-radius: 0 0 12px 12px;
            border: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }

        .editor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 20px;
            background-color: rgba(0, 0, 0, 0.3);
            border-bottom: 1px solid var(--border-color);
        }

        .file-info {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
            color: var(--primary);
        }

        #code-textarea {
            flex: 1;
            width: 100%;
            min-height: 300px;
            background-color: #1e1e1e;
            color: #d4d4d4;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            padding: 20px;
            border: none;
            resize: none;
            outline: none;
            white-space: pre;
            overflow-wrap: normal;
            overflow-x: auto;
        }

        .editor-output {
            height: 200px;
            background-color: var(--card-bg);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            margin-top: 10px;
        }

        .output-tabs {
            display: flex;
            background-color: rgba(0, 0, 0, 0.3);
            border-bottom: 1px solid var(--border-color);
        }

        .output-tab {
            padding: 10px 20px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .output-tab:hover {
            background-color: rgba(0, 102, 255, 0.1);
        }

        .output-tab.active {
            background-color: rgba(0, 102, 255, 0.2);
            border-bottom: 2px solid var(--primary);
        }

        .output-area {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            font-family: 'Consolas', monospace;
            font-size: 13px;
            line-height: 1.4;
            background-color: rgba(0, 0, 0, 0.2);
            white-space: pre-wrap;
        }

        /* 量子计算页面样式 */
        .quantum-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            gap: 20px;
        }

        .quantum-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .quantum-title {
            font-size: 2rem;
            color: var(--game-color);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .quantum-content {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 25px;
            height: calc(100vh - 180px);
            overflow: hidden;
        }

        .quantum-sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
            overflow-y: auto;
        }

        .quantum-gates, .quantum-circuit-controls {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid var(--border-color);
        }

        .gate-list {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 15px;
        }

        .gate-item {
            padding: 15px 10px;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .gate-item:hover {
            background-color: rgba(255, 107, 107, 0.1);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.2);
        }

        .gate-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--game-color), #ff4757);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.2rem;
            color: white;
        }

        .range-input {
            width: 100%;
            margin: 10px 0;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 5px;
            height: 6px;
            outline: none;
        }

        .quantum-main {
            display: flex;
            flex-direction: column;
            gap: 25px;
            overflow: hidden;
        }

        .quantum-circuit, .quantum-visualization {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid var(--border-color);
        }

        .circuit-container {
            min-height: 200px;
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            padding: 20px;
            margin-top: 15px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: flex-start;
            position: relative;
        }

        .visualization-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
            flex-wrap: wrap;
        }

        .viz-tab {
            padding: 8px 15px;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .viz-tab:hover {
            background-color: rgba(255, 107, 107, 0.1);
        }

        .viz-tab.active {
            background-color: rgba(255, 107, 107, 0.2);
            color: var(--game-color);
        }

        .visualization-content {
            height: 400px;
            position: relative;
        }

        .viz-container {
            display: none;
            height: 100%;
            flex-direction: column;
        }

        .viz-container.active {
            display: flex;
        }

        .bloch-sphere-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .bloch-sphere {
            width: 300px;
            height: 300px;
            background: radial-gradient(circle at 30% 30%, #1a1a2e, #0a0a16);
            border-radius: 50%;
            position: relative;
            border: 2px solid var(--border-color);
            box-shadow: 0 0 30px rgba(255, 107, 107, 0.1);
        }

        .bloch-axis {
            position: absolute;
            font-weight: 700;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .bloch-axis.x-axis {
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
        }

        .bloch-axis.y-axis {
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
        }

        .bloch-axis.z-axis {
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
        }

        .quantum-state-dot {
            width: 16px;
            height: 16px;
            background-color: var(--game-color);
            border-radius: 50%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 0 20px var(--game-color);
            animation: pulse 2s infinite;
        }

        .bloch-info {
            margin-top: 20px;
            padding: 15px;
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            text-align: center;
        }

        .probability-chart {
            flex: 1;
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            padding: 20px;
            display: flex;
            align-items: flex-end;
            justify-content: space-around;
            gap: 10px;
        }

        .prob-bar {
            width: 60px;
            background: linear-gradient(to top, var(--game-color), #ff4757);
            border-radius: 4px 4px 0 0;
            transition: height 0.5s ease;
        }

        .probability-info {
            margin-top: 20px;
        }

        .prob-item {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 12px;
            padding: 10px;
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 6px;
        }

        .prob-bar-container {
            flex: 1;
            height: 20px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .prob-bar-inline {
            height: 100%;
            background: linear-gradient(90deg, var(--game-color), #ff4757);
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        /* 机器学习页面样式 */
        .machinelearning-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            gap: 20px;
        }

        .machinelearning-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .machinelearning-title {
            font-size: 2rem;
            color: var(--ai-color);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .machinelearning-content {
            display: grid;
            grid-template-columns: 320px 1fr;
            gap: 25px;
            height: calc(100vh - 180px);
            overflow: hidden;
        }

        .ml-sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
            overflow-y: auto;
        }

        .ml-datasets, .ml-algorithms, .ml-parameters {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid var(--border-color);
        }

        .dataset-list, .algorithm-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }

        .dataset-item, .algorithm-item {
            padding: 12px 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 12px;
            border-left: 3px solid transparent;
        }

        .dataset-item:hover, .algorithm-item:hover {
            background-color: rgba(0, 255, 157, 0.1);
        }

        .dataset-item.active, .algorithm-item.active {
            background-color: rgba(0, 255, 157, 0.2);
            border-left-color: var(--ai-color);
        }

        .algorithm-categories {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .algorithm-category-btn {
            padding: 8px 15px;
            background-color: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s;
        }

        .algorithm-category-btn:hover {
            background-color: rgba(0, 255, 157, 0.1);
            color: var(--text-primary);
        }

        .algorithm-category-btn.active {
            background-color: rgba(0, 255, 157, 0.2);
            color: var(--ai-color);
            border-color: var(--ai-color);
        }

        .parameter-group {
            margin-top: 15px;
            display: none;
        }

        .parameter-group.active {
            display: block;
        }

        .ml-main {
            display: flex;
            flex-direction: column;
            gap: 25px;
            overflow: hidden;
        }

        .ml-visualization, .ml-results {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid var(--border-color);
        }

        .visualization-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .viz-controls {
            display: flex;
            gap: 10px;
        }

        .visualization-area {
            height: 300px;
            position: relative;
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .ml-canvas-container {
            width: 100%;
            height: 100%;
            position: relative;
        }

        .chart-legend {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background-color: rgba(0, 0, 0, 0.8);
            border-radius: 8px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 3px;
        }

        .results-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
            flex-wrap: wrap;
        }

        .results-tab {
            padding: 8px 15px;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .results-tab:hover {
            background-color: rgba(0, 255, 157, 0.1);
        }

        .results-tab.active {
            background-color: rgba(0, 255, 157, 0.2);
            color: var(--ai-color);
        }

        .results-content {
            height: 250px;
            position: relative;
            overflow: hidden;
        }

        .results-area {
            display: none;
            height: 100%;
            overflow-y: auto;
            padding: 10px;
        }

        .results-area.active {
            display: block;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .metric-item {
            padding: 15px;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            text-align: center;
        }

        .metric-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        .metric-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--ai-color);
        }

        .confusion-matrix {
            margin-top: 20px;
        }

        .confusion-matrix table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        .confusion-matrix th, .confusion-matrix td {
            padding: 8px;
            text-align: center;
            border: 1px solid var(--border-color);
        }

        .confusion-matrix th {
            background-color: rgba(0, 0, 0, 0.3);
            color: var(--ai-color);
            font-weight: 600;
        }

        .feature-list {
            margin-top: 20px;
        }

        .feature-item {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 12px;
            padding: 10px;
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 6px;
        }

        .feature-bar-container {
            flex: 1;
            height: 20px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .feature-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--ai-color), #00cc80);
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .log-output {
            height: 200px;
            overflow-y: auto;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 15px;
            font-family: 'Consolas', monospace;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .log-entry {
            margin-bottom: 5px;
            padding: 2px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .prediction-inputs {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .prediction-output {
            margin-top: 20px;
            padding: 20px;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
        }

        .prediction-result {
            text-align: center;
            margin-bottom: 20px;
        }

        .prediction-class {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--ai-color);
            margin: 10px 0;
        }

        .prediction-confidence {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        .probability-distribution {
            margin-top: 20px;
        }

        .prob-dist-item {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 10px;
            padding: 8px 12px;
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 6px;
        }

        /* 响应式调整 */
        @media (max-width: 1200px) {
            .codeeditor-content, .quantum-content, .machinelearning-content {
                grid-template-columns: 1fr;
            }
            
            .ml-sidebar {
                max-height: 300px;
            }
        }

        @media (max-width: 768px) {
            .codeeditor-controls, .quantum-controls, .machinelearning-controls {
                flex-direction: column;
                gap: 10px;
                align-items: flex-start;
            }
            
            .gate-list {
                grid-template-columns: 1fr;
            }
            
            .prediction-inputs {
                grid-template-columns: 1fr;
            }
            
            .metrics-grid {
                grid-template-columns: 1fr;
            }
            
            .editor-tabs {
                overflow-x: auto;
                flex-wrap: nowrap;
            }
        }
        /* 量子计算优化样式 */
        .quantum-circuit-diagram {
            display: grid;
            grid-template-columns: 80px repeat(auto-fill, 100px);
            grid-template-rows: repeat(auto-fill, 60px);
            gap: 10px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            min-height: 300px;
        }

        .qubit-line {
            display: contents;
        }

        .qubit-label {
            grid-column: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--game-color);
            font-weight: bold;
            font-size: 1.1rem;
        }

        .qubit-wire {
            grid-column: 2 / -1;
            height: 2px;
            background: linear-gradient(90deg, var(--border-color) 0%, transparent 100%);
            align-self: center;
        }

        .quantum-gate {
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--game-color);
            color: white;
            border-radius: 6px;
            font-weight: bold;
            width: 40px;
            height: 40px;
            margin: 0 auto;
            box-shadow: 0 0 10px rgba(255, 107, 107, 0.3);
            cursor: pointer;
            transition: all 0.3s;
        }

        .quantum-gate:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(255, 107, 107, 0.5);
        }

        .cnot-gate {
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--secondary);
            color: white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            margin: 0 auto;
        }

        .cnot-control {
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            margin: 0 auto;
        }

        /* 机器学习优化样式 */
        .ml-chart-container {
            position: relative;
            width: 100%;
            height: 100%;
        }

        .ml-tooltip {
            position: absolute;
            padding: 10px;
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid var(--ai-color);
            border-radius: 6px;
            color: white;
            font-size: 12px;
            pointer-events: none;
            z-index: 1000;
            display: none;
        }

        .feature-importance-chart {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }

        .feature-bar {
            height: 25px;
            background: linear-gradient(90deg, var(--ai-color), #00cc80);
            border-radius: 4px;
            transition: width 1s ease;
            display: flex;
            align-items: center;
            padding-left: 10px;
            color: var(--darker-bg);
            font-weight: bold;
            font-size: 0.9rem;
        }

        .model-comparison {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .model-card {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 15px;
            border: 1px solid var(--border-color);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .model-card:hover {
            transform: translateY(-5px);
            border-color: var(--ai-color);
        }

        .model-card.active {
            background: rgba(0, 255, 157, 0.1);
            border-color: var(--ai-color);
        }

        .learning-curve {
            height: 200px;
            margin-top: 20px;
            position: relative;
        }

        /* 预测结果优化样式 */
        .prediction-visualization {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        .confidence-meter {
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }

        .confidence-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success), #00ff9d);
            border-radius: 10px;
            transition: width 1s ease;
        }

        .prediction-details {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .detail-label {
            color: var(--text-secondary);
        }

        .detail-value {
            color: var(--ai-color);
            font-weight: bold;
        }

        /* 交互效果增强 */
        .quantum-gate.selected {
            background: var(--secondary);
            box-shadow: 0 0 20px rgba(255, 0, 255, 0.5);
        }

        .dataset-preview {
            margin-top: 15px;
            max-height: 200px;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 6px;
            padding: 10px;
        }

        .dataset-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 10px;
            padding: 8px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
        }

        .dataset-header {
            font-weight: bold;
            color: var(--ai-color);
            background: rgba(0, 0, 0, 0.3);
        }

        /* 动画效果 */
        @keyframes quantumPulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(255, 107, 107, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0); }
        }

        .quantum-active {
            animation: quantumPulse 2s infinite;
        }

        @keyframes trainingProgress {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .training-in-progress {
            background: linear-gradient(90deg, var(--ai-color), #00cc80, var(--ai-color));
            background-size: 200% 100%;
            animation: trainingProgress 2s infinite;
        }

        /* 响应式调整 */
        @media (max-width: 768px) {
            .quantum-circuit-diagram {
                grid-template-columns: 60px repeat(auto-fill, 80px);
                grid-template-rows: repeat(auto-fill, 50px);
            }
            
            .quantum-gate {
                width: 35px;
                height: 35px;
                font-size: 0.9rem;
            }
            
            .prediction-visualization {
                grid-template-columns: 1fr;
            }
            
            .model-comparison {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- 登录界面 -->
    <div class="login-container" id="login-container">
        <div class="login-box">
            <div class="login-header">
                <div class="login-logo">
                    <i class="fas fa-server"></i>
                    <span>NeoSystem</span>
                </div>
                <div class="login-subtitle">高级监控终端 v4.0 - 安全访问</div>
            </div>
            
            <div class="login-form">
                <div class="form-group">
                    <label class="form-label" for="username">用户名</label>
                    <input type="text" id="username" class="form-input" placeholder="请输入用户名" autocomplete="username">
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="password">密码</label>
                    <input type="password" id="password" class="form-input" placeholder="请输入密码" autocomplete="current-password">
                    <button type="button" class="password-toggle" id="password-toggle">
                        <i class="fas fa-eye"></i>
                    </button>
                </div>
                
                <div class="login-error" id="login-error">
                    <i class="fas fa-exclamation-circle"></i>
                    <span id="error-message">用户名或密码错误</span>
                </div>
                
                <button class="login-btn" id="login-btn">
                    <span id="login-btn-text">登录系统</span>
                </button>
                
                <div class="security-notice">
                    <h4><i class="fas fa-shield-alt"></i> 安全提示</h4>
                    <p>这是受保护的高级监控系统。未经授权的访问将被记录并报告。</p>
                    <p>授权访问码: <span class="access-code">wxh:Wxh201801</span></p>
                </div>
            </div>
            
            <div class="login-footer">
                <p>© 2023 NeoSystem 监控终端 | 仅供授权人员使用</p>
            </div>
        </div>
    </div>
    
    <div class="grid-bg"></div>
    
    <div class="container" id="main-container">
        <!-- 侧边栏 -->
        <div class="sidebar">
            <div class="logo-area">
                <div class="logo">
                    <i class="fas fa-server"></i>
                    <span class="logo-text">NeoSystem</span>
                </div>
                <div class="version">v4.0 - 游戏增强版</div>
                <div class="user-info" id="user-info" style="margin-top: 10px; font-size: 0.8rem; color: var(--text-secondary);">
                    <i class="fas fa-user"></i> <span id="logged-user">未登录</span>
                </div>
            </div>
            
            <div class="nav-menu">
                <div class="nav-item active" data-page="dashboard">
                    <i class="fas fa-chart-line"></i>
                    <span class="nav-text">仪表板</span>
                </div>
                <div class="nav-item" data-page="monitor">
                    <i class="fas fa-desktop"></i>
                    <span class="nav-text">系统监控</span>
                </div>
                <div class="nav-item" data-page="network">
                    <i class="fas fa-wifi"></i>
                    <span class="nav-text">网络工具</span>
                </div>
                <div class="nav-item" data-page="process">
                    <i class="fas fa-tasks"></i>
                    <span class="nav-text">进程管理</span>
                </div>
                <div class="nav-item" data-page="files">
                    <i class="fas fa-folder"></i>
                    <span class="nav-text">文件管理</span>
                </div>
                <div class="nav-item" data-page="security">
                    <i class="fas fa-shield-alt"></i>
                    <span class="nav-text">安全扫描</span>
                </div>
                <div class="nav-item library-item" data-page="library">
                    <i class="fas fa-book"></i>
                    <span class="nav-text">图书馆</span>
                </div>
                <div class="nav-item ai-item" data-page="ai">
                    <i class="fas fa-robot"></i>
                    <span class="nav-text">AI助手</span>
                </div>
                <div class="nav-item game-item" data-page="games">
                    <i class="fas fa-gamepad"></i>
                    <span class="nav-text">小游戏</span>
                </div>
                <div class="nav-item map-item" data-page="worldmap">
                    <i class="fas fa-globe-americas"></i>
                    <span class="nav-text">世界地图</span>
                </div>
                <!-- 在现有导航项目之后添加 -->
                <div class="nav-item codeeditor-item" data-page="codeeditor">
                    <i class="fas fa-code"></i>
                    <span class="nav-text">代码编辑器</span>
                </div>
                <div class="nav-item quantum-item" data-page="quantum">
                    <i class="fas fa-atom"></i>
                    <span class="nav-text">量子计算</span>
                </div>
                <div class="nav-item machinelearning-item" data-page="machinelearning">
                    <i class="fas fa-brain"></i>
                    <span class="nav-text">机器学习</span>
                </div>
                <div class="nav-item" data-page="settings">
                    <i class="fas fa-cog"></i>
                    <span class="nav-text">设置</span>
                </div>
            </div>
            
            <div class="system-status-sidebar">
                <div class="status-item">
                    <span class="status-label">系统状态</span>
                    <span class="status-value" id="sidebar-status">正常</span>
                </div>
                <div class="status-item">
                    <span class="status-label">在线时间</span>
                    <span class="status-value" id="uptime">0:00:00</span>
                </div>
                <div class="status-item">
                    <span class="status-label">登录用户</span>
                    <span class="status-value" id="sidebar-user">未登录</span>
                </div>
                <div class="status-item">
                    <span class="status-label">最后更新</span>
                    <span class="status-value" id="last-update">刚刚</span>
                </div>
                <button class="logout-btn" id="logout-btn" style="width: 100%; margin-top: 10px;">
                    <i class="fas fa-sign-out-alt"></i> 退出登录
                </button>
            </div>
        </div>
        
        <!-- 主内容区域 -->
        <div class="main-content">
            <div class="top-bar">
                <div class="page-title">
                    <i class="fas fa-chart-line"></i>
                    <span id="current-page-title">系统仪表板</span>
                </div>
                
                <div class="connection-status">
                    <div class="status-dot"></div>
                    <span>系统连接正常</span>
                    <span class="time-display" id="current-time">00:00:00</span>
                    <button class="logout-btn" id="top-logout-btn">
                        <i class="fas fa-sign-out-alt"></i> 退出
                    </button>
                </div>
            </div>
            
            <div class="content-area">
                <!-- 仪表板页面 -->
                <div class="page active" id="dashboard-page">
                    <div class="dashboard-grid">
                        <div class="dashboard-card">
                            <div class="card-header">
                                <h3 class="card-title">CPU 使用率</h3>
                                <i class="fas fa-microchip card-icon"></i>
                            </div>
                            <div class="card-content">
                                <div class="resource-item">
                                    <div class="resource-header">
                                        <span class="resource-name">处理器负载</span>
                                        <span class="resource-percent" id="cpu-percent">0%</span>
                                    </div>
                                    <div class="progress-container">
                                        <div class="progress-bar cpu-progress" id="cpu-progress" style="width: 0%"></div>
                                    </div>
                                    <div class="resource-details">
                                        <span id="cpu-details">核心: 0 | 频率: 0 GHz</span>
                                        <span id="cpu-temp">温度: 0°C</span>
                                    </div>
                                    <div class="data-source" id="cpu-data-source">数据源: 模拟数据</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="dashboard-card">
                            <div class="card-header">
                                <h3 class="card-title">内存使用情况</h3>
                                <i class="fas fa-memory card-icon"></i>
                            </div>
                            <div class="card-content">
                                <div class="resource-item">
                                    <div class="resource-header">
                                        <span class="resource-name">RAM 使用量</span>
                                        <span class="resource-percent" id="ram-percent">0%</span>
                                    </div>
                                    <div class="progress-container">
                                        <div class="progress-bar memory-progress" id="ram-progress" style="width: 0%"></div>
                                    </div>
                                    <div class="resource-details">
                                        <span id="ram-details">0 GB / 0 GB</span>
                                        <span id="ram-available">可用: 0 GB</span>
                                    </div>
                                    <div class="data-source" id="ram-data-source">数据源: 模拟数据</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="dashboard-card">
                            <div class="card-header">
                                <h3 class="card-title">存储空间</h3>
                                <i class="fas fa-hdd card-icon"></i>
                            </div>
                            <div class="card-content">
                                <div class="resource-item">
                                    <div class="resource-header">
                                        <span class="resource-name">硬盘使用率</span>
                                        <span class="resource-percent" id="storage-percent">0%</span>
                                    </div>
                                    <div class="progress-container">
                                        <div class="progress-bar storage-progress" id="storage-progress" style="width: 0%"></div>
                                    </div>
                                    <div class="resource-details">
                                        <span id="storage-details">0 GB / 0 GB</span>
                                        <span id="storage-free">剩余: 0 GB</span>
                                    </div>
                                    <div class="data-source">数据源: 模拟数据</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="dashboard-card">
                            <div class="card-header">
                                <h3 class="card-title">网络状态</h3>
                                <i class="fas fa-network-wired card-icon"></i>
                            </div>
                            <div class="card-content">
                                <div class="resource-item">
                                    <div class="resource-header">
                                        <span class="resource-name">网络活动</span>
                                        <span class="resource-percent" id="network-activity">0 KB/s</span>
                                    </div>
                                    <div class="progress-container">
                                        <div class="progress-bar network-progress" id="network-progress" style="width: 0%"></div>
                                    </div>
                                    <div class="resource-details">
                                        <span id="network-up">上传: 0 KB/s</span>
                                        <span id="network-down">下载: 0 KB/s</span>
                                    </div>
                                    <div class="data-source">数据源: 模拟数据</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="dashboard-card">
                            <div class="card-header">
                                <h3 class="card-title">系统信息</h3>
                                <i class="fas fa-info-circle card-icon"></i>
                            </div>
                            <div class="card-content">
                                <div class="info-grid">
                                    <div class="info-item">
                                        <div class="info-label">操作系统</div>
                                        <div class="info-value" id="os-type">未知</div>
                                    </div>
                                    <div class="info-item">
                                        <div class="info-label">浏览器</div>
                                        <div class="info-value" id="browser-type">未知</div>
                                    </div>
                                    <div class="info-item">
                                        <div class="info-label">屏幕分辨率</div>
                                        <div class="info-value" id="screen-res">0x0</div>
                                    </div>
                                    <div class="info-item">
                                        <div class="info-label">在线状态</div>
                                        <div class="info-value" id="online-status">离线</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="dashboard-card">
                            <div class="card-header">
                                <h3 class="card-title">CPU 历史负载</h3>
                                <i class="fas fa-chart-area card-icon"></i>
                            </div>
                            <div class="card-content">
                                <div class="chart-container">
                                    <div class="chart-line" id="cpu-chart">
                                        <!-- 图表条将通过JS动态生成 -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 系统监控页面 -->
                <div class="page" id="monitor-page">
                    <div class="monitor-grid">
                        <div class="resource-monitor">
                            <h2 class="monitor-title"><i class="fas fa-desktop"></i> 实时资源监控</h2>
                            
                            <div class="resource-item">
                                <div class="resource-header">
                                    <span class="resource-name">CPU 使用率</span>
                                    <span class="resource-percent" id="monitor-cpu-percent">0%</span>
                                </div>
                                <div class="progress-container">
                                    <div class="progress-bar cpu-progress" id="monitor-cpu-progress" style="width: 0%"></div>
                                </div>
                                <div class="resource-details">
                                    <span id="monitor-cpu-details">核心: 0 | 线程: 0</span>
                                    <span id="monitor-cpu-temp">温度: 0°C</span>
                                </div>
                                <div class="data-source" id="monitor-cpu-data-source">数据源: 模拟数据</div>
                            </div>
                            
                            <div class="resource-item">
                                <div class="resource-header">
                                    <span class="resource-name">内存使用</span>
                                    <span class="resource-percent" id="monitor-ram-percent">0%</span>
                                </div>
                                <div class="progress-container">
                                    <div class="progress-bar memory-progress" id="monitor-ram-progress" style="width: 0%"></div>
                                </div>
                                <div class="resource-details">
                                    <span id="monitor-ram-details">已用: 0 GB | 缓存: 0 GB</span>
                                    <span id="monitor-ram-speed">速度: 0 MHz</span>
                                </div>
                                <div class="data-source" id="monitor-ram-data-source">数据源: 模拟数据</div>
                            </div>
                            
                            <div class="resource-item">
                                <div class="resource-header">
                                    <span class="resource-name">存储设备</span>
                                    <span class="resource-percent" id="monitor-storage-percent">0%</span>
                                </div>
                                <div class="progress-container">
                                    <div class="progress-bar storage-progress" id="monitor-storage-progress" style="width: 0%"></div>
                                </div>
                                <div class="resource-details">
                                    <span id="monitor-storage-details">读取: 0 MB/s | 写入: 0 MB/s</span>
                                    <span id="monitor-storage-health">健康度: 100%</span>
                                </div>
                                <div class="data-source">数据源: 模拟数据</div>
                            </div>
                            
                            <div class="resource-item">
                                <div class="resource-header">
                                    <span class="resource-name">网络带宽</span>
                                    <span class="resource-percent" id="monitor-network-usage">0 KB/s</span>
                                </div>
                                <div class="progress-container">
                                    <div class="progress-bar network-progress" id="monitor-network-progress" style="width: 0%"></div>
                                </div>
                                <div class="resource-details">
                                    <span id="monitor-network-up">上传: 0 KB/s</span>
                                    <span id="monitor-network-down">下载: 0 KB/s</span>
                                </div>
                                <div class="data-source">数据源: 模拟数据</div>
                            </div>
                        </div>
                        
                        <div class="system-info">
                            <h2 class="monitor-title"><i class="fas fa-info-circle"></i> 系统详情</h2>
                            <div class="info-grid">
                                <div class="info-item">
                                    <div class="info-label">系统平台</div>
                                    <div class="info-value" id="system-platform">未知</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">用户代理</div>
                                    <div class="info-value" id="user-agent">未知</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">语言</div>
                                    <div class="info-value" id="system-language">未知</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">时区</div>
                                    <div class="info-value" id="timezone">未知</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">Cookie 启用</div>
                                    <div class="info-value" id="cookies-enabled">未知</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">JavaScript 启用</div>
                                    <div class="info-value" id="js-enabled">未知</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">设备内存</div>
                                    <div class="info-value" id="device-memory">未知</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">并发线程</div>
                                    <div class="info-value" id="hardware-concurrency">未知</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 网络工具页面 -->
                <div class="page" id="network-page">
                    <div class="network-tools">
                        <div class="tool-card">
                            <h3 class="tool-title"><i class="fas fa-globe"></i> 网络诊断</h3>
                            <div class="input-group">
                                <label class="input-label" for="ping-host">Ping 主机</label>
                                <input type="text" id="ping-host" class="input-field" value="8.8.8.8" placeholder="输入主机名或 IP 地址">
                            </div>
                            <button class="btn" id="ping-btn">开始 Ping 测试</button>
                            <div class="result-box" id="ping-result">等待测试结果...</div>
                        </div>
                        
                        <div class="tool-card">
                            <h3 class="tool-title"><i class="fas fa-route"></i> 路由追踪</h3>
                            <div class="input-group">
                                <label class="input-label" for="traceroute-host">追踪目标</label>
                                <input type="text" id="traceroute-host" class="input-field" value="google.com" placeholder="输入主机名或 IP 地址">
                            </div>
                            <button class="btn btn-secondary" id="traceroute-btn">开始路由追踪</button>
                            <div class="result-box" id="traceroute-result">等待测试结果...</div>
                        </div>
                        
                        <div class="tool-card">
                            <h3 class="tool-title"><i class="fas fa-search"></i> 端口扫描</h3>
                            <div class="input-group">
                                <label class="input-label" for="scan-host">扫描目标</label>
                                <input type="text" id="scan-host" class="input-field" value="localhost" placeholder="输入主机名或 IP 地址">
                            </div>
                            <div class="input-group">
                                <label class="input-label" for="scan-ports">端口范围</label>
                                <input type="text" id="scan-ports" class="input-field" value="1-100" placeholder="例如: 1-100">
                            </div>
                            <button class="btn" id="scan-btn">开始端口扫描</button>
                            <div class="result-box" id="scan-result">等待扫描结果...</div>
                        </div>
                        
                        <div class="tool-card">
                            <h3 class="tool-title"><i class="fas fa-tachometer-alt"></i> 网速测试</h3>
                            <div class="input-group">
                                <label class="input-label">测试类型</label>
                                <select id="speed-test-type" class="input-field">
                                    <option value="download">下载速度</option>
                                    <option value="upload">上传速度</option>
                                    <option value="both">双向测试</option>
                                </select>
                            </div>
                            <button class="btn btn-secondary" id="speed-test-btn">开始网速测试</button>
                            <div class="result-box" id="speed-test-result">等待测试结果...</div>
                        </div>
                    </div>
                </div>
                
                <!-- 进程管理页面 -->
                <div class="page" id="process-page">
                    <div class="process-manager">
                        <div class="process-controls">
                            <h2 class="monitor-title"><i class="fas fa-tasks"></i> 系统进程管理</h2>
                            <div>
                                <button class="btn" id="refresh-processes">刷新进程</button>
                                <button class="btn" id="sort-cpu">按CPU排序</button>
                                <button class="btn" id="sort-memory">按内存排序</button>
                                <button class="btn btn-secondary" id="kill-process">结束进程</button>
                            </div>
                        </div>
                        
                        <div class="process-list">
                            <div class="process-header">
                                <div>进程名称</div>
                                <div>PID</div>
                                <div>CPU %</div>
                                <div>内存 %</div>
                                <div>状态</div>
                            </div>
                            <div id="process-list-content">
                                <!-- 进程列表将通过JS动态生成 -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 文件管理页面 -->
                <div class="page" id="files-page">
                    <div class="file-manager">
                        <div class="file-sidebar">
                            <h3 class="tool-title"><i class="fas fa-folder"></i> 目录</h3>
                            <div id="directory-list" style="margin-top: 20px;">
                                <!-- 目录列表将通过JS动态生成 -->
                            </div>
                        </div>
                        
                        <div class="file-list">
                            <h3 class="tool-title"><i class="fas fa-file"></i> 文件列表</h3>
                            <div id="file-list-content" style="margin-top: 20px;">
                                <p>选择一个目录查看文件</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 安全扫描页面 -->
                <div class="page" id="security-page">
                    <div class="dashboard-grid">
                        <div class="dashboard-card">
                            <div class="card-header">
                                <h3 class="card-title">安全扫描</h3>
                                <i class="fas fa-shield-alt card-icon"></i>
                            </div>
                            <div class="card-content">
                                <p>扫描系统潜在的安全问题</p>
                                <button class="btn" id="security-scan-btn" style="margin-top: 20px;">开始安全扫描</button>
                                <div class="result-box" id="security-scan-result" style="margin-top: 20px;">等待扫描...</div>
                            </div>
                        </div>
                        
                        <div class="dashboard-card">
                            <div class="card-header">
                                <h3 class="card-title">漏洞检测</h3>
                                <i class="fas fa-bug card-icon"></i>
                            </div>
                            <div class="card-content">
                                <p>检测系统已知漏洞</p>
                                <button class="btn btn-secondary" id="vulnerability-scan-btn" style="margin-top: 20px;">开始漏洞扫描</button>
                                <div class="result-box" id="vulnerability-scan-result" style="margin-top: 20px;">等待扫描...</div>
                            </div>
                        </div>
                        
                        <div class="dashboard-card">
                            <div class="card-header">
                                <h3 class="card-title">恶意软件扫描</h3>
                                <i class="fas fa-virus card-icon"></i>
                            </div>
                            <div class="card-content">
                                <p>扫描潜在的恶意软件</p>
                                <button class="btn" id="malware-scan-btn" style="margin-top: 20px;">开始恶意软件扫描</button>
                                <div class="result-box" id="malware-scan-result" style="margin-top: 20px;">等待扫描...</div>
                            </div>
                        </div>
                        
                        <div class="dashboard-card">
                            <div class="card-header">
                                <h3 class="card-title">防火墙状态</h3>
                                <i class="fas fa-fire card-icon"></i>
                            </div>
                            <div class="card-content">
                                <div class="info-grid">
                                    <div class="info-item">
                                        <div class="info-label">防火墙状态</div>
                                        <div class="info-value" id="firewall-status">启用</div>
                                    </div>
                                    <div class="info-item">
                                        <div class="info-label">活动规则</div>
                                        <div class="info-value" id="firewall-rules">42</div>
                                    </div>
                                    <div class="info-item">
                                        <div class="info-label">拦截次数</div>
                                        <div class="info-value" id="firewall-blocks">128</div>
                                    </div>
                                    <div class="info-item">
                                        <div class="info-label">最后更新</div>
                                        <div class="info-value" id="firewall-updated">今天</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 图书馆页面 -->
                <div class="page" id="library-page">
                    <div class="library-container">
                        <div class="library-header">
                            <div class="library-title">
                                <i class="fas fa-book"></i>
                                <span>编程语言图书馆</span>
                            </div>
                            
                            <div class="library-search">
                                <input type="text" class="search-input" id="library-search" placeholder="搜索编程语言...">
                                <button class="search-btn" id="library-search-btn">
                                    <i class="fas fa-search"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="language-categories">
                            <div class="category-btn active" data-category="all">全部语言</div>
                            <div class="category-btn" data-category="web">Web开发</div>
                            <div class="category-btn" data-category="system">系统编程</div>
                            <div class="category-btn" data-category="script">脚本语言</div>
                            <div class="category-btn" data-category="data">数据科学</div>
                            <div class="category-btn" data-category="mobile">移动开发</div>
                            <div class="category-btn" data-category="functional">函数式编程</div>
                        </div>
                        
                        <div class="library-content">
                            <div class="language-sidebar">
                                <ul class="language-list" id="language-list">
                                    <!-- 语言列表将通过JS动态生成 -->
                                </ul>
                            </div>
                            
                            <div class="language-detail" id="language-detail">
                                <div class="language-detail-placeholder">
                                    <h3 style="color: var(--library-color); text-align: center; margin-top: 100px;">
                                        <i class="fas fa-book-open" style="font-size: 3rem; margin-bottom: 20px;"></i><br>
                                        请从左侧选择一个编程语言
                                    </h3>
                                    <p style="text-align: center; color: var(--text-secondary); margin-top: 20px;">
                                        浏览各种编程语言的详细信息、代码示例和最佳实践
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- AI助手页面 -->
                <div class="page" id="ai-page">
                    <div class="ai-assistant-container">
                        <div class="ai-header">
                            <div class="ai-avatar">
                                <i class="fas fa-robot"></i>
                            </div>
                            <div class="ai-info">
                                <div class="ai-name">NeoAI 助手</div>
                                <div class="ai-status">
                                    <div class="ai-status-dot"></div>
                                    <span>在线 - 准备为您提供技术支持</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- AI模式选择 -->
                        <div class="ai-mode-selector" id="ai-mode-selector">
                            <div class="mode-btn active" data-mode="local">本地模式</div>
                            <div class="mode-btn" data-mode="api">API模式</div>
                            <div class="mode-btn" data-mode="hybrid">混合模式</div>
                        </div>
                        
                        <div class="ai-chat-container">
                            <div class="ai-chat-messages" id="ai-chat-messages">
                                <div class="ai-message assistant">
                                    <div class="ai-message-header">
                                        <i class="fas fa-robot"></i>
                                        <span>NeoAI 助手</span>
                                    </div>
                                    <div class="ai-message-content">
                                        您好！我是NeoAI助手，可以为您提供以下帮助：<br><br>
                                        1. 解答系统监控相关问题<br>
                                        2. 提供网络诊断建议<br>
                                        3. 协助解决系统安全问题<br>
                                        4. 解释各种技术术语<br>
                                        5. 提供性能优化建议<br><br>
                                        <strong>当前模式：本地模式</strong> - 使用预定义知识库<br>
                                        切换到API模式可连接真实AI服务获取更准确的回答<br><br>
                                        请输入您的问题，或点击下方快速按钮开始对话！
                                    </div>
                                </div>
                            </div>
                            
                            <div class="ai-chat-input">
                                <!-- AI配置面板 -->
                                <div class="ai-config-panel" id="ai-config-panel">
                                    <div class="ai-config-header" id="config-toggle">
                                        <div class="ai-config-title">
                                            <i class="fas fa-cog"></i>
                                            <span>AI配置设置</span>
                                        </div>
                                        <i class="fas fa-chevron-down" id="config-arrow"></i>
                                    </div>
                                    <div class="ai-config-content" id="config-content">
                                        <div class="config-form">
                                            <div class="config-row">
                                                <span class="config-label">API密钥</span>
                                                <input type="password" id="api-key" class="config-input" placeholder="输入您的API密钥">
                                            </div>
                                            <div class="config-row">
                                                <span class="config-label">AI服务</span>
                                                <select id="ai-service" class="config-select">
                                                    <option value="deepseek">DeepSeek</option>
                                                    <option value="openai">OpenAI GPT</option>
                                                    <option value="anthropic">Claude (Anthropic)</option>
                                                    <option value="gemini">Google Gemini</option>
                                                    <option value="custom">自定义API</option>
                                                </select>
                                            </div>
                                            <div class="config-row" id="custom-api-row" style="display: none;">
                                                <span class="config-label">API端点</span>
                                                <input type="text" id="custom-api-endpoint" class="config-input" placeholder="https://api.example.com/v1/chat">
                                            </div>
                                            <div class="config-row">
                                                <span class="config-label">AI模型</span>
                                                <select id="ai-model" class="config-select">
                                                    <option value="deepseek-chat">DeepSeek Chat</option>
                                                    <option value="deepseek-coder">DeepSeek Coder</option>
                                                    <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
                                                    <option value="gpt-4">GPT-4</option>
                                                    <option value="gpt-4-turbo">GPT-4 Turbo</option>
                                                    <option value="claude-3-haiku">Claude 3 Haiku</option>
                                                    <option value="gemini-pro">Gemini Pro</option>
                                                </select>
                                            </div>
                                            <div class="config-row">
                                                <button class="config-btn" id="test-api-btn">测试API连接</button>
                                                <button class="config-btn config-btn-secondary" id="save-config-btn">保存配置</button>
                                                <button class="config-btn" id="clear-chat-btn">清空对话</button>
                                            </div>
                                            <div class="api-status" id="api-status">
                                                <div class="api-status-dot disconnected"></div>
                                                <span>API未配置</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="ai-input-group">
                                    <textarea class="ai-input-field" id="ai-input-field" placeholder="输入您的问题... (按Enter发送，Shift+Enter换行)"></textarea>
                                    <button class="ai-send-btn" id="ai-send-btn">
                                        <i class="fas fa-paper-plane"></i>
                                    </button>
                                </div>
                                
                                <div class="ai-quick-actions" id="ai-quick-actions">
                                    <div class="ai-quick-btn" data-command="如何优化系统性能？">性能优化</div>
                                    <div class="ai-quick-btn" data-command="解释CPU使用率高的原因">CPU问题</div>
                                    <div class="ai-quick-btn" data-command="如何进行网络诊断？">网络诊断</div>
                                    <div class="ai-quick-btn" data-command="如何查看系统日志？">系统日志</div>
                                    <div class="ai-quick-btn" data-command="如何提高系统安全性？">安全建议</div>
                                    <div class="ai-quick-btn" data-command="显示可用命令列表">命令列表</div>
                                    <div class="ai-quick-btn" data-command="当前系统状态报告">系统报告</div>
                                    <div class="ai-quick-btn" data-command="帮我生成一个系统监控脚本">生成脚本</div>
                                </div>
                                
                                <div class="command-hint">提示：输入 "help" 查看所有可用命令，点击AI配置设置配置外部AI服务</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 游戏页面 -->
                <div class="page" id="games-page">
                    <div class="games-container">
                        <div class="games-header">
                            <div class="games-title">
                                <i class="fas fa-gamepad"></i>
                                <span>系统小游戏</span>
                            </div>
                            
                            <div class="connection-status">
                                <div class="status-dot"></div>
                                <span>游戏服务器连接正常</span>
                            </div>
                        </div>
                        
                        <div class="game-categories">
                            <div class="game-category-btn active" data-category="all">全部游戏</div>
                            <div class="game-category-btn" data-category="reaction">反应测试</div>
                            <div class="game-category-btn" data-category="typing">打字游戏</div>
                            <div class="game-category-btn" data-category="system">系统相关</div>
                        </div>
                        
                        <div class="games-grid">
                            <!-- CPS测试游戏 -->
                            <div class="game-card" data-category="reaction">
                                <div class="game-header">
                                    <h3 class="game-title">CPS 测试</h3>
                                    <i class="fas fa-mouse-pointer game-icon"></i>
                                </div>
                                <p class="game-description">
                                    测试你的点击速度！在10秒内尽可能多地点击按钮，计算你的每秒点击次数(CPS)。
                                </p>
                                
                                <div class="cps-game-container">
                                    <div class="cps-display" id="cps-display">0.0</div>
                                    <div class="cps-timer" id="cps-timer">准备开始</div>
                                    <button class="cps-button" id="cps-button">
                                        点击开始！
                                    </button>
                                    
                                    <div class="cps-results" id="cps-results">
                                        <div class="cps-result-item">
                                            <span class="cps-result-label">最高CPS:</span>
                                            <span class="cps-result-value" id="cps-highscore">0.0</span>
                                        </div>
                                        <div class="cps-result-item">
                                            <span class="cps-result-label">总点击次数:</span>
                                            <span class="cps-result-value" id="cps-total-clicks">0</span>
                                        </div>
                                        <div class="cps-result-item">
                                            <span class="cps-result-label">平均CPS:</span>
                                            <span class="cps-result-value" id="cps-average">0.0</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <button class="btn btn-game" id="cps-reset-btn" style="margin-top: 15px; width: 100%;">重新开始</button>
                            </div>
                            
                            <!-- 打字速度测试游戏 -->
                            <div class="game-card" data-category="typing">
                                <div class="game-header">
                                    <h3 class="game-title">打字速度测试</h3>
                                    <i class="fas fa-keyboard game-icon"></i>
                                </div>
                                <p class="game-description">
                                    测试你的打字速度和准确率！输入显示的文本，计算你的打字速度（每分钟字数）和准确率。
                                </p>
                                
                                <div class="typing-game-container">
                                    <div class="typing-stats">
                                        <div class="typing-stat">
                                            <div class="typing-stat-value" id="typing-wpm">0</div>
                                            <div class="typing-stat-label">WPM</div>
                                        </div>
                                        <div class="typing-stat">
                                            <div class="typing-stat-value" id="typing-accuracy">100%</div>
                                            <div class="typing-stat-label">准确率</div>
                                        </div>
                                        <div class="typing-stat">
                                            <div class="typing-stat-value" id="typing-time">60s</div>
                                            <div class="typing-stat-label">剩余时间</div>
                                        </div>
                                    </div>
                                    
                                    <div class="typing-text-container">
                                        <div class="typing-text" id="typing-text">
                                            请点击开始按钮开始打字测试。你将有一分钟时间输入显示的文本。尽量快速而准确地打字！
                                        </div>
                                    </div>
                                    
                                    <input type="text" class="typing-input" id="typing-input" placeholder="点击开始后在此输入..." disabled>
                                    
                                    <button class="btn btn-game" id="typing-start-btn">开始打字测试</button>
                                </div>
                            </div>
                            
                            <!-- 系统知识测验 -->
                            <div class="game-card" data-category="system">
                                <div class="game-header">
                                    <h3 class="game-title">系统知识测验</h3>
                                    <i class="fas fa-brain game-icon"></i>
                                </div>
                                <p class="game-description">
                                    测试你的系统知识！回答关于操作系统、网络、编程和安全的问题，看看你有多了解计算机系统。
                                </p>
                                
                                <div class="typing-game-container" style="justify-content: flex-start;">
                                    <div class="typing-stats">
                                        <div class="typing-stat">
                                            <div class="typing-stat-value" id="quiz-score">0</div>
                                            <div class="typing-stat-label">得分</div>
                                        </div>
                                        <div class="typing-stat">
                                            <div class="typing-stat-value" id="quiz-question">1/10</div>
                                            <div class="typing-stat-label">问题</div>
                                        </div>
                                        <div class="typing-stat">
                                            <div class="typing-stat-value" id="quiz-timer">--</div>
                                            <div class="typing-stat-label">时间</div>
                                        </div>
                                    </div>
                                    
                                    <div class="typing-text-container">
                                        <div class="typing-text" id="quiz-question-text">
                                            点击开始按钮开始测验。你将回答10个关于计算机系统的选择题。每个问题有30秒时间回答。
                                        </div>
                                    </div>
                                    
                                    <div id="quiz-options" style="width: 100%;">
                                        <!-- 选项将通过JS动态生成 -->
                                    </div>
                                    
                                    <button class="btn btn-game" id="quiz-start-btn" style="margin-top: 15px;">开始测验</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 世界地图页面 -->
                <div class="page" id="worldmap-page">
                    <div class="worldmap-container">
                        <div class="worldmap-header">
                            <div class="worldmap-title">
                                <i class="fas fa-globe-americas"></i>
                                <span>全球网络监控地图</span>
                            </div>
                            
                            <div class="worldmap-controls">
                                <div class="connection-status">
                                    <div class="status-dot"></div>
                                    <span>地图数据连接正常</span>
                                </div>
                                <button class="btn btn-map" id="refresh-map">
                                    <i class="fas fa-sync-alt"></i> 刷新地图
                                </button>
                                <button class="btn btn-map" id="clear-map">
                                    <i class="fas fa-trash-alt"></i> 清除标记
                                </button>
                            </div>
                        </div>
                        
                        <div class="worldmap-content">
                            <div class="worldmap-display">
                                <div id="worldmap"></div>
                            </div>
                            
                            <div class="worldmap-sidebar">
                                <div class="map-stats-card">
                                    <h3 class="map-stats-title">
                                        <i class="fas fa-chart-bar"></i>
                                        全球网络统计
                                    </h3>
                                    <div class="map-stats-grid">
                                        <div class="map-stat-item">
                                            <div class="map-stat-label">活跃节点</div>
                                            <div class="map-stat-value" id="active-nodes">0</div>
                                        </div>
                                        <div class="map-stat-item">
                                            <div class="map-stat-label">攻击事件</div>
                                            <div class="map-stat-value" id="attack-events">0</div>
                                        </div>
                                        <div class="map-stat-item">
                                            <div class="map-stat-label">在线用户</div>
                                            <div class="map-stat-value" id="online-users">0</div>
                                        </div>
                                        <div class="map-stat-item">
                                            <div class="map-stat-label">服务器节点</div>
                                            <div class="map-stat-value" id="server-nodes">0</div>
                                        </div>
                                        <div class="map-stat-item">
                                            <div class="map-stat-label">数据传输</div>
                                            <div class="map-stat-value" id="data-transfer">0 TB</div>
                                        </div>
                                        <div class="map-stat-item">
                                            <div class="map-stat-label">响应时间</div>
                                            <div class="map-stat-value" id="avg-response">0 ms</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="map-controls-card">
                                    <h3 class="map-controls-title">
                                        <i class="fas fa-layer-group"></i>
                                        地图图层控制
                                    </h3>
                                    <div class="map-layer-controls">
                                        <div class="layer-control-item">
                                            <label class="layer-control-label">
                                                <input type="checkbox" id="layer-nodes" checked>
                                                <i class="fas fa-server" style="color: var(--map-color);"></i>
                                                <span>网络节点</span>
                                            </label>
                                        </div>
                                        <div class="layer-control-item">
                                            <label class="layer-control-label">
                                                <input type="checkbox" id="layer-attacks" checked>
                                                <i class="fas fa-bolt" style="color: var(--danger);"></i>
                                                <span>攻击事件</span>
                                            </label>
                                        </div>
                                        <div class="layer-control-item">
                                            <label class="layer-control-label">
                                                <input type="checkbox" id="layer-users" checked>
                                                <i class="fas fa-user" style="color: var(--primary);"></i>
                                                <span>在线用户</span>
                                            </label>
                                        </div>
                                        <div class="layer-control-item">
                                            <label class="layer-control-label">
                                                <input type="checkbox" id="layer-connections" checked>
                                                <i class="fas fa-project-diagram" style="color: var(--secondary);"></i>
                                                <span>网络连接</span>
                                            </label>
                                        </div>
                                        <div class="layer-control-item">
                                            <label class="layer-control-label">
                                                <input type="checkbox" id="layer-traffic" checked>
                                                <i class="fas fa-wave-square" style="color: var(--warning);"></i>
                                                <span>流量热图</span>
                                            </label>
                                        </div>
                                    </div>
                                    
                                    <div class="map-legend">
                                        <div class="legend-item">
                                            <div class="legend-color green"></div>
                                            <span>网络节点</span>
                                        </div>
                                        <div class="legend-item">
                                            <div class="legend-color blue"></div>
                                            <span>在线用户</span>
                                        </div>
                                        <div class="legend-item">
                                            <div class="legend-color red"></div>
                                            <span>攻击事件</span>
                                        </div>
                                        <div class="legend-item">
                                            <div class="legend-color yellow"></div>
                                            <span>高流量区域</span>
                                        </div>
                                        <div class="legend-item">
                                            <div class="legend-color purple"></div>
                                            <span>服务器集群</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 代码编辑器页面 -->
                <div class="page" id="codeeditor-page">
                    <div class="codeeditor-container">
                        <div class="codeeditor-header">
                            <div class="codeeditor-title">
                                <i class="fas fa-code"></i>
                                <span>高级代码编辑器</span>
                            </div>
                            
                            <div class="codeeditor-controls">
                                <div class="connection-status">
                                    <div class="status-dot"></div>
                                    <span>编辑器就绪</span>
                                </div>
                                <button class="btn btn-map" id="new-file-btn">
                                    <i class="fas fa-file"></i> 新建文件
                                </button>
                                <button class="btn btn-map" id="save-file-btn">
                                    <i class="fas fa-save"></i> 保存
                                </button>
                                <button class="btn btn-map" id="run-code-btn">
                                    <i class="fas fa-play"></i> 运行代码
                                </button>
                            </div>
                        </div>
                        
                        <div class="codeeditor-content">
                            <div class="editor-sidebar">
                                <div class="file-explorer">
                                    <h3 class="tool-title">
                                        <i class="fas fa-folder-open"></i>
                                        文件管理器
                                    </h3>
                                    <div class="file-list" id="editor-file-list">
                                        <div class="file-item active" data-file="main.py">
                                            <i class="fab fa-python"></i>
                                            <span>main.py</span>
                                        </div>
                                        <div class="file-item" data-file="index.html">
                                            <i class="fab fa-html5"></i>
                                            <span>index.html</span>
                                        </div>
                                        <div class="file-item" data-file="style.css">
                                            <i class="fab fa-css3-alt"></i>
                                            <span>style.css</span>
                                        </div>
                                        <div class="file-item" data-file="script.js">
                                            <i class="fab fa-js"></i>
                                            <span>script.js</span>
                                        </div>
                                        <div class="file-item" data-file="data.json">
                                            <i class="fas fa-code"></i>
                                            <span>data.json</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="language-selector">
                                    <h3 class="tool-title">
                                        <i class="fas fa-language"></i>
                                        编程语言
                                    </h3>
                                    <select id="language-select" class="input-field">
                                        <option value="python">Python</option>
                                        <option value="javascript">JavaScript</option>
                                        <option value="html">HTML</option>
                                        <option value="css">CSS</option>
                                        <option value="json">JSON</option>
                                        <option value="markdown">Markdown</option>
                                        <option value="cpp">C++</option>
                                        <option value="java">Java</option>
                                        <option value="php">PHP</option>
                                        <option value="sql">SQL</option>
                                    </select>
                                </div>
                                
                                <div class="editor-settings">
                                    <h3 class="tool-title">
                                        <i class="fas fa-sliders-h"></i>
                                        编辑器设置
                                    </h3>
                                    <div class="setting-item">
                                        <span class="setting-label">自动保存</span>
                                        <label class="switch">
                                            <input type="checkbox" id="auto-save" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="setting-item">
                                        <span class="setting-label">代码折叠</span>
                                        <label class="switch">
                                            <input type="checkbox" id="code-folding" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="setting-item">
                                        <span class="setting-label">行号显示</span>
                                        <label class="switch">
                                            <input type="checkbox" id="line-numbers" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="editor-main">
                                <div class="editor-tabs">
                                    <div class="editor-tab active" data-file="main.py">
                                        <span>main.py</span>
                                        <i class="fas fa-times"></i>
                                    </div>
                                    <!-- 更多标签将通过JS动态生成 -->
                                </div>
                                
                                <div class="code-editor">
                                    <div class="editor-header">
                                        <div class="file-info">
                                            <i class="fab fa-python"></i>
                                            <span>main.py</span>
                                        </div>
                                        <div class="editor-stats">
                                            <span>行: 1 | 列: 1</span>
                                        </div>
                                    </div>
                                    
                                    <div class="editor-area">
                                        <div class="line-numbers">
                                            <div>1</div>
                                        </div>
                                        <textarea id="code-input" class="code-input" spellcheck="false"># NeoSystem 代码编辑器
                # 欢迎使用高级代码编辑器
                # 支持多种编程语言，实时语法高亮

                def fibonacci(n):
                    """计算斐波那契数列"""
                    if n <= 1:
                        return n
                    else:
                        return fibonacci(n-1) + fibonacci(n-2)

                def main():
                    print("=== NeoSystem 代码编辑器 ===")
                    print("欢迎使用高级代码编辑器")
                    
                    # 计算斐波那契数列前10项
                    for i in range(10):
                        result = fibonacci(i)
                        print(f"斐波那契({i}) = {result}")
                    
                    print("=" * 30)
                    print("代码执行完成！")

                if __name__ == "__main__":
                    main()</textarea>
                                        <div id="code-highlight" class="code-highlight"></div>
                                    </div>
                                </div>
                                
                                <div class="editor-output">
                                    <div class="output-tabs">
                                        <div class="output-tab active">输出</div>
                                        <div class="output-tab">终端</div>
                                        <div class="output-tab">问题</div>
                                    </div>
                                    
                                    <div class="output-content">
                                        <div class="output-area" id="output-area">
                                            <div class="output-line">>>> 代码执行就绪...</div>
                                            <div class="output-line">>>> 点击"运行代码"按钮执行当前代码</div>
                                            <div class="output-line">>>> 或者输入你自己的代码并运行</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 量子计算模拟页面 -->
                <div class="page" id="quantum-page">
                    <div class="quantum-container">
                        <div class="quantum-header">
                            <div class="quantum-title">
                                <i class="fas fa-atom"></i>
                                <span>量子计算模拟器</span>
                            </div>
                            
                            <div class="quantum-controls">
                                <div class="connection-status">
                                    <div class="status-dot"></div>
                                    <span>量子模拟器就绪</span>
                                </div>
                                <button class="btn btn-game" id="quantum-reset-btn">
                                    <i class="fas fa-redo"></i> 重置模拟
                                </button>
                                <button class="btn btn-game" id="quantum-run-btn">
                                    <i class="fas fa-play"></i> 运行模拟
                                </button>
                            </div>
                        </div>
                        
                        <div class="quantum-content">
                            <div class="quantum-sidebar">
                                <div class="quantum-gates">
                                    <h3 class="tool-title">
                                        <i class="fas fa-th"></i>
                                        量子门操作
                                    </h3>
                                    <div class="gate-list">
                                        <div class="gate-item" data-gate="H">
                                            <div class="gate-icon">H</div>
                                            <span>Hadamard门</span>
                                        </div>
                                        <div class="gate-item" data-gate="X">
                                            <div class="gate-icon">X</div>
                                            <span>Pauli-X门</span>
                                        </div>
                                        <div class="gate-item" data-gate="Y">
                                            <div class="gate-icon">Y</div>
                                            <span>Pauli-Y门</span>
                                        </div>
                                        <div class="gate-item" data-gate="Z">
                                            <div class="gate-icon">Z</div>
                                            <span>Pauli-Z门</span>
                                        </div>
                                        <div class="gate-item" data-gate="CNOT">
                                            <div class="gate-icon">CX</div>
                                            <span>CNOT门</span>
                                        </div>
                                        <div class="gate-item" data-gate="SWAP">
                                            <div class="gate-icon">SW</div>
                                            <span>SWAP门</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="quantum-circuit-controls">
                                    <h3 class="tool-title">
                                        <i class="fas fa-sliders-h"></i>
                                        电路控制
                                    </h3>
                                    <div class="input-group">
                                        <label class="input-label">量子比特数量</label>
                                        <input type="range" id="qubit-count" min="1" max="5" value="2" class="range-input">
                                        <span id="qubit-count-display">2</span>
                                    </div>
                                    
                                    <div class="input-group">
                                        <label class="input-label">测量次数</label>
                                        <input type="number" id="measure-count" class="input-field" value="1000" min="100" max="10000">
                                    </div>
                                    
                                    <div class="input-group">
                                        <label class="input-label">初始状态</label>
                                        <select id="initial-state" class="input-field">
                                            <option value="00">|00⟩</option>
                                            <option value="01">|01⟩</option>
                                            <option value="10">|10⟩</option>
                                            <option value="11">|11⟩</option>
                                        </select>
                                    </div>
                                    
                                    <button class="btn" id="add-gate-btn">
                                        <i class="fas fa-plus"></i> 添加量子门
                                    </button>
                                </div>
                            </div>
                            
                            <div class="quantum-main">
                                <div class="quantum-circuit">
                                    <h3 class="tool-title">
                                        <i class="fas fa-project-diagram"></i>
                                        量子电路图
                                    </h3>
                                    <div class="circuit-container" id="circuit-container">
                                        <!-- 量子电路图将通过JS动态生成 -->
                                    </div>
                                </div>
                                
                                <div class="quantum-visualization">
                                    <div class="visualization-tabs">
                                        <div class="viz-tab active" data-viz="bloch">布洛赫球面</div>
                                        <div class="viz-tab" data-viz="probabilities">概率分布</div>
                                        <div class="viz-tab" data-viz="statevector">状态向量</div>
                                        <div class="viz-tab" data-viz="histogram">测量直方图</div>
                                    </div>
                                    
                                    <div class="visualization-content">
                                        <div class="viz-container active" id="bloch-viz">
                                            <div class="bloch-sphere" id="bloch-sphere">
                                                <!-- 布洛赫球面将通过JS动态生成 -->
                                                <div class="bloch-axis x-axis">X</div>
                                                <div class="bloch-axis y-axis">Y</div>
                                                <div class="bloch-axis z-axis">Z</div>
                                                <div class="quantum-state" id="quantum-state"></div>
                                            </div>
                                            <div class="bloch-info">
                                                <h4>布洛赫球面表示</h4>
                                                <p>量子比特状态：|ψ⟩ = α|0⟩ + β|1⟩</p>
                                                <p id="bloch-state">当前：|0⟩</p>
                                                <p id="bloch-coords">坐标：(0, 0, 1)</p>
                                            </div>
                                        </div>
                                        
                                        <div class="viz-container" id="probabilities-viz">
                                            <div class="probability-chart" id="probability-chart">
                                                <!-- 概率分布图将通过JS动态生成 -->
                                            </div>
                                            <div class="probability-info">
                                                <h4>量子态概率分布</h4>
                                                <div id="probability-list">
                                                    <div class="prob-item">
                                                        <span class="prob-state">|00⟩</span>
                                                        <div class="prob-bar-container">
                                                            <div class="prob-bar" style="width: 100%"></div>
                                                        </div>
                                                        <span class="prob-value">100%</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="viz-container" id="statevector-viz">
                                            <div class="statevector-display">
                                                <h4>量子状态向量</h4>
                                                <div id="statevector-output">
                                                    |ψ⟩ = 1.000|00⟩ + 0.000|01⟩ + 0.000|10⟩ + 0.000|11⟩
                                                </div>
                                                <div class="statevector-matrix">
                                                    <h5>密度矩阵：</h5>
                                                    <div id="density-matrix">
                                                        [[1, 0, 0, 0]<br>
                                                        [0, 0, 0, 0]<br>
                                                        [0, 0, 0, 0]<br>
                                                        [0, 0, 0, 0]]
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="viz-container" id="histogram-viz">
                                            <div class="histogram-chart" id="histogram-chart">
                                                <!-- 测量直方图将通过JS动态生成 -->
                                            </div>
                                            <div class="histogram-info">
                                                <h4>量子测量结果</h4>
                                                <div id="measurement-results">
                                                    <p>模拟测量次数：1000</p>
                                                    <div id="measurement-stats">
                                                        |00⟩: 100% (1000次)<br>
                                                        |01⟩: 0% (0次)<br>
                                                        |10⟩: 0% (0次)<br>
                                                        |11⟩: 0% (0次)
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 机器学习页面 -->
                <div class="page" id="machinelearning-page">
                    <div class="machinelearning-container">
                        <div class="machinelearning-header">
                            <div class="machinelearning-title">
                                <i class="fas fa-brain"></i>
                                <span>机器学习实验室</span>
                            </div>
                            
                            <div class="machinelearning-controls">
                                <div class="connection-status">
                                    <div class="status-dot"></div>
                                    <span>ML引擎就绪</span>
                                </div>
                                <button class="btn btn-game" id="ml-train-btn">
                                    <i class="fas fa-play"></i> 训练模型
                                </button>
                                <button class="btn btn-game" id="ml-predict-btn">
                                    <i class="fas fa-chart-line"></i> 预测
                                </button>
                            </div>
                        </div>
                        
                        <div class="machinelearning-content">
                            <div class="ml-sidebar">
                                <div class="ml-datasets">
                                    <h3 class="tool-title">
                                        <i class="fas fa-database"></i>
                                        数据集
                                    </h3>
                                    <div class="dataset-list">
                                        <div class="dataset-item active" data-dataset="iris">
                                            <i class="fas fa-seedling"></i>
                                            <span>鸢尾花数据集</span>
                                        </div>
                                        <div class="dataset-item" data-dataset="diabetes">
                                            <i class="fas fa-heartbeat"></i>
                                            <span>糖尿病数据集</span>
                                        </div>
                                        <div class="dataset-item" data-dataset="wine">
                                            <i class="fas fa-wine-glass-alt"></i>
                                            <span>葡萄酒数据集</span>
                                        </div>
                                        <div class="dataset-item" data-dataset="breast_cancer">
                                            <i class="fas fa-medkit"></i>
                                            <span>乳腺癌数据集</span>
                                        </div>
                                        <div class="dataset-item" data-dataset="custom">
                                            <i class="fas fa-upload"></i>
                                            <span>上传自定义数据</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="ml-algorithms">
                                    <h3 class="tool-title">
                                        <i class="fas fa-cogs"></i>
                                        机器学习算法
                                    </h3>
                                    <div class="algorithm-categories">
                                        <div class="algorithm-category-btn active" data-category="classification">分类</div>
                                        <div class="algorithm-category-btn" data-category="regression">回归</div>
                                        <div class="algorithm-category-btn" data-category="clustering">聚类</div>
                                        <div class="algorithm-category-btn" data-category="neural">神经网络</div>
                                    </div>
                                    
                                    <div class="algorithm-list">
                                        <div class="algorithm-item active" data-algorithm="logistic">
                                            <i class="fas fa-chart-line"></i>
                                            <span>逻辑回归</span>
                                        </div>
                                        <div class="algorithm-item" data-algorithm="svm">
                                            <i class="fas fa-bullseye"></i>
                                            <span>支持向量机</span>
                                        </div>
                                        <div class="algorithm-item" data-algorithm="decision_tree">
                                            <i class="fas fa-sitemap"></i>
                                            <span>决策树</span>
                                        </div>
                                        <div class="algorithm-item" data-algorithm="random_forest">
                                            <i class="fas fa-tree"></i>
                                            <span>随机森林</span>
                                        </div>
                                        <div class="algorithm-item" data-algorithm="knn">
                                            <i class="fas fa-users"></i>
                                            <span>K最近邻</span>
                                        </div>
                                        <div class="algorithm-item" data-algorithm="neural_network">
                                            <i class="fas fa-network-wired"></i>
                                            <span>神经网络</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="ml-parameters">
                                    <h3 class="tool-title">
                                        <i class="fas fa-sliders-h"></i>
                                        模型参数
                                    </h3>
                                    <div class="parameter-group" id="logistic-params">
                                        <div class="input-group">
                                            <label class="input-label">正则化参数(C)</label>
                                            <input type="range" id="logistic-c" min="0.01" max="10" step="0.01" value="1" class="range-input">
                                            <span id="logistic-c-value">1.00</span>
                                        </div>
                                        <div class="input-group">
                                            <label class="input-label">最大迭代次数</label>
                                            <input type="number" id="logistic-max-iter" class="input-field" value="100">
                                        </div>
                                    </div>
                                    
                                    <div class="parameter-group" id="neural-params" style="display: none;">
                                        <div class="input-group">
                                            <label class="input-label">隐藏层</label>
                                            <input type="text" id="neural-hidden-layers" class="input-field" value="10,10">
                                        </div>
                                        <div class="input-group">
                                            <label class="input-label">学习率</label>
                                            <input type="range" id="neural-learning-rate" min="0.001" max="0.1" step="0.001" value="0.01" class="range-input">
                                            <span id="neural-learning-rate-value">0.010</span>
                                        </div>
                                        <div class="input-group">
                                            <label class="input-label">训练轮数</label>
                                            <input type="number" id="neural-epochs" class="input-field" value="100">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="ml-main">
                                <div class="ml-visualization">
                                    <div class="visualization-header">
                                        <h3 class="tool-title">
                                            <i class="fas fa-chart-area"></i>
                                            数据可视化
                                        </h3>
                                        <div class="viz-controls">
                                            <select id="viz-x-axis" class="input-field">
                                                <option value="sepal_length">花萼长度</option>
                                                <option value="sepal_width">花萼宽度</option>
                                                <option value="petal_length">花瓣长度</option>
                                                <option value="petal_width">花瓣宽度</option>
                                            </select>
                                            <select id="viz-y-axis" class="input-field">
                                                <option value="sepal_width">花萼宽度</option>
                                                <option value="sepal_length">花萼长度</option>
                                                <option value="petal_length">花瓣长度</option>
                                                <option value="petal_width">花瓣宽度</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div class="visualization-area">
                                        <div class="ml-chart" id="ml-chart">
                                            <!-- 机器学习图表将通过JS动态生成 -->
                                            <canvas id="ml-canvas" width="800" height="400"></canvas>
                                        </div>
                                        <div class="chart-legend" id="chart-legend">
                                            <div class="legend-item">
                                                <div class="legend-color" style="background-color: #ff6b6b;"></div>
                                                <span>山鸢尾 (Setosa)</span>
                                            </div>
                                            <div class="legend-item">
                                                <div class="legend-color" style="background-color: #00cc88;"></div>
                                                <span>变色鸢尾 (Versicolor)</span>
                                            </div>
                                            <div class="legend-item">
                                                <div class="legend-color" style="background-color: #00a8ff;"></div>
                                                <span>维吉尼亚鸢尾 (Virginica)</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="ml-results">
                                    <div class="results-tabs">
                                        <div class="results-tab active">模型评估</div>
                                        <div class="results-tab">特征重要性</div>
                                        <div class="results-tab">训练日志</div>
                                        <div class="results-tab">预测结果</div>
                                    </div>
                                    
                                    <div class="results-content">
                                        <div class="results-area active" id="evaluation-results">
                                            <h4>模型性能评估</h4>
                                            <div class="metrics-grid">
                                                <div class="metric-item">
                                                    <div class="metric-label">准确率</div>
                                                    <div class="metric-value" id="accuracy-metric">0.95</div>
                                                </div>
                                                <div class="metric-item">
                                                    <div class="metric-label">精确率</div>
                                                    <div class="metric-value" id="precision-metric">0.94</div>
                                                </div>
                                                <div class="metric-item">
                                                    <div class="metric-label">召回率</div>
                                                    <div class="metric-value" id="recall-metric">0.93</div>
                                                </div>
                                                <div class="metric-item">
                                                    <div class="metric-label">F1分数</div>
                                                    <div class="metric-value" id="f1-metric">0.935</div>
                                                </div>
                                            </div>
                                            
                                            <div class="confusion-matrix">
                                                <h5>混淆矩阵</h5>
                                                <table id="confusion-table">
                                                    <tr>
                                                        <th></th>
                                                        <th>预测: Setosa</th>
                                                        <th>预测: Versicolor</th>
                                                        <th>预测: Virginica</th>
                                                    </tr>
                                                    <tr>
                                                        <th>实际: Setosa</th>
                                                        <td>15</td>
                                                        <td>0</td>
                                                        <td>0</td>
                                                    </tr>
                                                    <tr>
                                                        <th>实际: Versicolor</th>
                                                        <td>0</td>
                                                        <td>14</td>
                                                        <td>1</td>
                                                    </tr>
                                                    <tr>
                                                        <th>实际: Virginica</th>
                                                        <td>0</td>
                                                        <td>1</td>
                                                        <td>15</td>
                                                    </tr>
                                                </table>
                                            </div>
                                        </div>
                                        
                                        <div class="results-area" id="feature-importance">
                                            <h4>特征重要性分析</h4>
                                            <div id="feature-chart">
                                                <!-- 特征重要性图表将通过JS动态生成 -->
                                            </div>
                                            <div class="feature-list" id="feature-list">
                                                <div class="feature-item">
                                                    <span class="feature-name">花瓣长度</span>
                                                    <div class="feature-bar-container">
                                                        <div class="feature-bar" style="width: 90%"></div>
                                                    </div>
                                                    <span class="feature-value">0.90</span>
                                                </div>
                                                <div class="feature-item">
                                                    <span class="feature-name">花瓣宽度</span>
                                                    <div class="feature-bar-container">
                                                        <div class="feature-bar" style="width: 75%"></div>
                                                    </div>
                                                    <span class="feature-value">0.75</span>
                                                </div>
                                                <div class="feature-item">
                                                    <span class="feature-name">花萼长度</span>
                                                    <div class="feature-bar-container">
                                                        <div class="feature-bar" style="width: 40%"></div>
                                                    </div>
                                                    <span class="feature-value">0.40</span>
                                                </div>
                                                <div class="feature-item">
                                                    <span class="feature-name">花萼宽度</span>
                                                    <div class="feature-bar-container">
                                                        <div class="feature-bar" style="width: 20%"></div>
                                                    </div>
                                                    <span class="feature-value">0.20</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="results-area" id="training-log">
                                            <h4>训练过程日志</h4>
                                            <div class="log-output" id="training-log-output">
                                                <div class="log-entry">[INFO] 加载鸢尾花数据集...</div>
                                                <div class="log-entry">[INFO] 数据集大小: 150个样本, 4个特征</div>
                                                <div class="log-entry">[INFO] 划分训练集/测试集: 80%/20%</div>
                                                <div class="log-entry">[INFO] 初始化逻辑回归模型...</div>
                                                <div class="log-entry">[INFO] 开始训练模型...</div>
                                                <div class="log-entry">[INFO] 迭代 1/100 - 损失: 1.2345</div>
                                                <div class="log-entry">[INFO] 迭代 10/100 - 损失: 0.8765</div>
                                                <div class="log-entry">[INFO] 迭代 50/100 - 损失: 0.4321</div>
                                                <div class="log-entry">[INFO] 训练完成!</div>
                                                <div class="log-entry">[INFO] 测试集准确率: 95.0%</div>
                                            </div>
                                        </div>
                                        
                                        <div class="results-area" id="prediction-results">
                                            <h4>实时预测</h4>
                                            <div class="prediction-inputs">
                                                <div class="input-group">
                                                    <label class="input-label">花萼长度</label>
                                                    <input type="number" id="predict-sepal-length" class="input-field" value="5.1" step="0.1">
                                                </div>
                                                <div class="input-group">
                                                    <label class="input-label">花萼宽度</label>
                                                    <input type="number" id="predict-sepal-width" class="input-field" value="3.5" step="0.1">
                                                </div>
                                                <div class="input-group">
                                                    <label class="input-label">花瓣长度</label>
                                                    <input type="number" id="predict-petal-length" class="input-field" value="1.4" step="0.1">
                                                </div>
                                                <div class="input-group">
                                                    <label class="input-label">花瓣宽度</label>
                                                    <input type="number" id="predict-petal-width" class="input-field" value="0.2" step="0.1">
                                                </div>
                                            </div>
                                            
                                            <button class="btn" id="run-prediction-btn">
                                                <i class="fas fa-calculator"></i> 执行预测
                                            </button>
                                            
                                            <div class="prediction-output" id="prediction-output">
                                                <div class="prediction-result">
                                                    <h5>预测结果:</h5>
                                                    <div class="prediction-class">山鸢尾 (Setosa)</div>
                                                    <div class="prediction-confidence">置信度: 98.5%</div>
                                                </div>
                                                <div class="probability-distribution">
                                                    <h5>类别概率:</h5>
                                                    <div class="prob-dist-item">
                                                        <span>Setosa: </span>
                                                        <div class="prob-bar-container">
                                                            <div class="prob-bar" style="width: 98.5%"></div>
                                                        </div>
                                                        <span>98.5%</span>
                                                    </div>
                                                    <div class="prob-dist-item">
                                                        <span>Versicolor: </span>
                                                        <div class="prob-bar-container">
                                                            <div class="prob-bar" style="width: 1.2%"></div>
                                                        </div>
                                                        <span>1.2%</span>
                                                    </div>
                                                    <div class="prob-dist-item">
                                                        <span>Virginica: </span>
                                                        <div class="prob-bar-container">
                                                            <div class="prob-bar" style="width: 0.3%"></div>
                                                        </div>
                                                        <span>0.3%</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 设置页面 -->
                <div class="page" id="settings-page">
                    <div class="settings-container">
                        <div class="settings-card">
                            <h3 class="tool-title"><i class="fas fa-cog"></i> 系统设置</h3>
                            <div class="setting-item">
                                <span class="setting-label">自动更新</span>
                                <label class="switch">
                                    <input type="checkbox" id="auto-update" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <span class="setting-label">实时监控</span>
                                <label class="switch">
                                    <input type="checkbox" id="real-time-monitor" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <span class="setting-label">暗黑模式</span>
                                <label class="switch">
                                    <input type="checkbox" id="dark-mode" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <span class="setting-label">系统通知</span>
                                <label class="switch">
                                    <input type="checkbox" id="system-notifications" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="setting-item">
                                <span class="setting-label">AI助手</span>
                                <label class="switch">
                                    <input type="checkbox" id="ai-assistant" checked>
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                        
                        <div class="settings-card">
                            <h3 class="tool-title"><i class="fas fa-palette"></i> 外观设置</h3>
                            <div class="input-group">
                                <label class="input-label" for="theme-select">主题颜色</label>
                                <select id="theme-select" class="input-field">
                                    <option value="cyber">赛博朋克 (默认)</option>
                                    <option value="matrix">矩阵绿</option>
                                    <option value="neon">霓虹紫</option>
                                    <option value="ocean">海洋蓝</option>
                                    <option value="ai">AI主题</option>
                                    <option value="game">游戏主题</option>
                                    <option value="map">地图主题</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label class="input-label" for="update-interval">更新间隔 (秒)</label>
                                <select id="update-interval" class="input-field">
                                    <option value="1">1 秒</option>
                                    <option value="2" selected>2 秒</option>
                                    <option value="5">5 秒</option>
                                    <option value="10">10 秒</option>
                                </select>
                            </div>
                            <button class="btn" id="apply-settings" style="margin-top: 20px;">应用设置</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 通知 -->
    <div class="notification" id="notification">
        <div class="notification-title" id="notification-title">系统通知</div>
        <div id="notification-message">这是一条系统消息</div>
    </div>
    
    <!-- 地图工具提示 -->
    <div class="map-tooltip" id="map-tooltip"></div>



    
    <script>
        // 全局变量
        let currentPage = 'dashboard';
        let systemUptime = 0;
        let cpuHistory = [];
        let networkHistory = [];
        let processList = [];
        let updateInterval = 2000; // 默认2秒更新
        let updateTimer;
        let aiChatHistory = [];
        let currentDirectory = 'home';
        let currentLanguage = null;
        let aiConfig = {
            mode: 'local', // 'local', 'api', 'hybrid'
            apiKey: '',
            aiService: 'deepseek', // 默认使用DeepSeek
            aiModel: 'deepseek-chat',
            customEndpoint: '',
            apiConnected: false,
            maxTokens: 2000,
            temperature: 0.7
        };
        // 登录状态
        let isLoggedIn = false;
        let currentUser = null;
        
        // 正确的登录凭据
        const CORRECT_USERNAME = 'wxh';
        const CORRECT_PASSWORD = 'Wxh201801';
        
        // 游戏相关变量
        let cpsGame = {
            isRunning: false,
            startTime: 0,
            clickCount: 0,
            timer: null,
            timeLeft: 10,
            highScore: 0,
            totalClicks: 0,
            averageCPS: 0
        };
        
        let typingGame = {
            isRunning: false,
            startTime: 0,
            timeLeft: 60,
            timer: null,
            currentText: '',
            typedText: '',
            correctChars: 0,
            totalChars: 0,
            wpm: 0,
            accuracy: 100
        };
        
        let quizGame = {
            isRunning: false,
            currentQuestion: 0,
            score: 0,
            timer: null,
            timeLeft: 30,
            questions: []
        };
        
        // 地图相关变量
        let worldMap = null;
        let mapMarkers = [];
        let mapConnections = [];
        let mapData = {
            nodes: [],
            attacks: [],
            users: [],
            connections: [],
            traffic: []
        };
        
        // 图书馆数据
        const programmingLanguages = [
            {
                id: 'python',
                name: 'Python',
                category: ['script', 'data', 'web'],
                year: 1991,
                creator: 'Guido van Rossum',
                iconColor: '#3776AB',
                description: 'Python是一种高级、解释型、通用编程语言。以其清晰的语法和代码可读性而闻名，支持多种编程范式，包括面向对象、命令式、函数式和过程式编程。',
                features: [
                    { title: '简单易学', description: '语法清晰简洁，适合初学者' },
                    { title: '强大的库', description: '拥有丰富的标准库和第三方库' },
                    { title: '跨平台', description: '可在多种操作系统上运行' },
                    { title: '动态类型', description: '无需声明变量类型' },
                    { title: '开源', description: '免费使用和分发' },
                    { title: '社区支持', description: '拥有庞大的开发者社区' }
                ],
                useCases: ['Web开发', '数据科学', '人工智能', '自动化脚本', '科学计算'],
                codeExamples: [
                    {
                        title: 'Hello World',
                        code: `print("Hello, World!")`
                    },
                    {
                        title: '函数定义',
                        code: `def fibonacci(n):
    if n <= 1:
        return n
    else:
        return fibonacci(n-1) + fibonacci(n-2)

# 调用函数
result = fibonacci(10)
print(f"斐波那契数列第10项: {result}")`
                    },
                    {
                        title: '列表推导式',
                        code: `# 生成平方数列表
squares = [x**2 for x in range(10)]
print(squares)  # 输出: [0, 1, 4, 9, 16, 25, 36, 49, 64, 81]

# 条件过滤
even_squares = [x**2 for x in range(10) if x % 2 == 0]
print(even_squares)  # 输出: [0, 4, 16, 36, 64]`
                    }
                ],
                resources: [
                    { name: '官方文档', url: 'https://docs.python.org/' },
                    { name: 'PyPI', url: 'https://pypi.org/' },
                    { name: 'Python教程', url: 'https://docs.python.org/3/tutorial/' }
                ]
            },
            {
                id: 'javascript',
                name: 'JavaScript',
                category: ['web', 'script'],
                year: 1995,
                creator: 'Brendan Eich',
                iconColor: '#F7DF1E',
                description: 'JavaScript是一种高级的、解释型的编程语言，主要用于Web开发。它是Web的三大核心技术之一，与HTML和CSS配合使用，可以为网页添加交互功能。',
                features: [
                    { title: '客户端脚本', description: '在浏览器中直接运行' },
                    { title: '事件驱动', description: '基于事件和回调的编程模型' },
                    { title: '异步编程', description: '支持Promise和async/await' },
                    { title: '原型继承', description: '基于原型的面向对象编程' },
                    { title: '动态类型', description: '灵活的类型系统' },
                    { title: '全栈能力', description: '可用于前端和后端开发' }
                ],
                useCases: ['网页交互', 'Web应用', '服务器端开发', '移动应用', '游戏开发'],
                codeExamples: [
                    {
                        title: 'Hello World',
                        code: `console.log("Hello, World!");`
                    },
                    {
                        title: '箭头函数',
                        code: `// 传统函数
function multiply(a, b) {
    return a * b;
}

// 箭头函数
const multiplyArrow = (a, b) => a * b;

console.log(multiply(5, 3));       // 输出: 15
console.log(multiplyArrow(5, 3));  // 输出: 15`
                    },
                    {
                        title: 'Promise和异步',
                        code: `// 创建Promise
const fetchData = () => {
    return new Promise((resolve, reject) => {
        setTimeout(() => {
            resolve('数据加载成功');
        }, 2000);
    });
};

// 使用async/await
async function getData() {
    try {
        const result = await fetchData();
        console.log(result);  // 输出: 数据加载成功
    } catch (error) {
        console.error('错误:', error);
    }
}

getData();`
                    }
                ],
                resources: [
                    { name: 'MDN文档', url: 'https://developer.mozilla.org/zh-CN/docs/Web/JavaScript' },
                    { name: 'Node.js', url: 'https://nodejs.org/' },
                    { name: 'npm', url: 'https://www.npmjs.com/' }
                ]
            },
            {
                id: 'java',
                name: 'Java',
                category: ['system', 'web', 'mobile'],
                year: 1995,
                creator: 'James Gosling',
                iconColor: '#007396',
                description: 'Java是一种高级的、面向对象的编程语言，以其"一次编写，到处运行"的理念而闻名。Java广泛应用于企业级应用、Android开发和大型系统。',
                features: [
                    { title: '平台无关性', description: '通过JVM实现跨平台运行' },
                    { title: '面向对象', description: '纯粹的面向对象编程语言' },
                    { title: '内存管理', description: '自动垃圾回收机制' },
                    { title: '多线程支持', description: '内置多线程编程能力' },
                    { title: '安全性', description: '提供安全管理器和字节码验证' },
                    { title: '丰富的API', description: '庞大的标准类库' }
                ],
                useCases: ['企业应用', 'Android开发', 'Web应用', '大数据', '金融服务'],
                codeExamples: [
                    {
                        title: 'Hello World',
                        code: `public class HelloWorld {
    public static void main(String[] args) {
        System.out.println("Hello, World!");
    }
}`
                    },
                    {
                        title: '类和对象',
                        code: `// 定义一个类
class Person {
    private String name;
    private int age;
    
    // 构造方法
    public Person(String name, int age) {
        this.name = name;
        this.age = age;
    }
    
    // 方法
    public void introduce() {
        System.out.println("我叫" + name + "，今年" + age + "岁。");
    }
}

// 使用类
public class Main {
    public static void main(String[] args) {
        Person person = new Person("张三", 25);
        person.introduce();  // 输出: 我叫张三，今年25岁。
    }
}`
                    }
                ],
                resources: [
                    { name: '官方文档', url: 'https://docs.oracle.com/javase/' },
                    { name: 'Spring框架', url: 'https://spring.io/' },
                    { name: 'Android开发', url: 'https://developer.android.com/' }
                ]
            }
        ];
        

        
        // 登录系统
        function initLoginSystem() {
            const loginContainer = document.getElementById('login-container');
            const mainContainer = document.getElementById('main-container');
            const loginBtn = document.getElementById('login-btn');
            const usernameInput = document.getElementById('username');
            const passwordInput = document.getElementById('password');
            const passwordToggle = document.getElementById('password-toggle');
            const loginError = document.getElementById('login-error');
            const errorMessage = document.getElementById('error-message');
            const logoutBtn = document.getElementById('logout-btn');
            const topLogoutBtn = document.getElementById('top-logout-btn');
            
            // 检查是否有保存的登录状态
            checkSavedLogin();
            
            // 密码显示/隐藏切换
            passwordToggle.addEventListener('click', function() {
                const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                passwordInput.setAttribute('type', type);
                this.innerHTML = type === 'password' ? '<i class="fas fa-eye"></i>' : '<i class="fas fa-eye-slash"></i>';
            });
            
            // 登录按钮点击
            loginBtn.addEventListener('click', handleLogin);
            
            // 回车键登录
            usernameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') handleLogin();
            });
            
            passwordInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') handleLogin();
            });
            
            // 登出按钮
            logoutBtn.addEventListener('click', logout);
            topLogoutBtn.addEventListener('click', logout);
            
            function handleLogin() {
                const username = usernameInput.value.trim();
                const password = passwordInput.value.trim();
                
                // 验证输入
                if (!username || !password) {
                    showError('请输入用户名和密码');
                    return;
                }
                
                // 显示加载状态
                loginBtn.disabled = true;
                loginBtn.innerHTML = '<span class="login-loading"></span>验证中...';
                
                // 模拟网络延迟
                setTimeout(() => {
                    // 验证凭据
                    if (username === CORRECT_USERNAME && password === CORRECT_PASSWORD) {
                        loginSuccess(username);
                    } else {
                        loginFailed();
                    }
                }, 800);
            }
            
            function loginSuccess(username) {
                currentUser = username;
                isLoggedIn = true;
                
                // 保存登录状态到本地存储
                localStorage.setItem('neosystem_logged_in', 'true');
                localStorage.setItem('neosystem_username', username);
                localStorage.setItem('neosystem_login_time', new Date().toISOString());
                
                // 更新用户界面
                document.getElementById('logged-user').textContent = username;
                document.getElementById('sidebar-user').textContent = username;
                
                // 隐藏登录界面，显示主系统
                loginContainer.classList.add('hidden');
                setTimeout(() => {
                    mainContainer.classList.add('show');
                    // 初始化系统监控
                    startSystemMonitoring();
                    // 显示欢迎通知
                    showNotification("登录成功", `欢迎回来，${username}！NeoSystem 高级监控终端 v4.0 已就绪`, 5000);
                }, 500);
                
                // 重置登录按钮
                resetLoginButton();
            }
            
            function loginFailed() {
                showError('用户名或密码错误');
                
                // 重置登录按钮
                resetLoginButton();
                
                // 清除密码字段
                passwordInput.value = '';
                passwordInput.focus();
                
                // 添加错误样式
                usernameInput.classList.add('error');
                passwordInput.classList.add('error');
                
                // 3秒后移除错误样式
                setTimeout(() => {
                    usernameInput.classList.remove('error');
                    passwordInput.classList.remove('error');
                }, 3000);
            }
            
            function showError(message) {
                errorMessage.textContent = message;
                loginError.classList.add('show');
                
                // 5秒后隐藏错误
                setTimeout(() => {
                    loginError.classList.remove('show');
                }, 5000);
            }
            
            function resetLoginButton() {
                loginBtn.disabled = false;
                loginBtn.innerHTML = '<span id="login-btn-text">登录系统</span>';
            }
            
            function logout() {
                if (confirm('确定要退出登录吗？')) {
                    // 清除登录状态
                    isLoggedIn = false;
                    currentUser = null;
                    localStorage.removeItem('neosystem_logged_in');
                    localStorage.removeItem('neosystem_username');
                    localStorage.removeItem('neosystem_login_time');
                    
                    // 停止系统监控
                    clearInterval(updateTimer);
                    
                    // 隐藏主系统，显示登录界面
                    mainContainer.classList.remove('show');
                    setTimeout(() => {
                        loginContainer.classList.remove('hidden');
                        
                        // 清除输入字段
                        document.getElementById('username').value = '';
                        document.getElementById('password').value = '';
                        document.getElementById('username').focus();
                        
                        // 重置用户界面
                        document.getElementById('logged-user').textContent = '未登录';
                        document.getElementById('sidebar-user').textContent = '未登录';
                        
                        // 显示登出通知
                        showNotification("已退出登录", "您已成功退出系统", 3000);
                    }, 500);
                }
            }
            
            function checkSavedLogin() {
                const savedLogin = localStorage.getItem('neosystem_logged_in');
                const savedUsername = localStorage.getItem('neosystem_username');
                const loginTime = localStorage.getItem('neosystem_login_time');
                
                if (savedLogin === 'true' && savedUsername === CORRECT_USERNAME) {
                    // 检查登录是否过期（24小时）
                    if (loginTime) {
                        const loginDate = new Date(loginTime);
                        const now = new Date();
                        const hoursSinceLogin = (now - loginDate) / (1000 * 60 * 60);
                        
                        if (hoursSinceLogin < 24) {
                            // 自动登录
                            currentUser = savedUsername;
                            isLoggedIn = true;
                            
                            // 更新用户界面
                            document.getElementById('logged-user').textContent = savedUsername;
                            document.getElementById('sidebar-user').textContent = savedUsername;
                            
                            // 隐藏登录界面，显示主系统
                            loginContainer.classList.add('hidden');
                            mainContainer.classList.add('show');
                            
                            // 初始化系统监控
                            startSystemMonitoring();
                            
                            // 显示欢迎通知
                            showNotification("自动登录成功", `欢迎回来，${savedUsername}！`, 3000);
                            return;
                        }
                    }
                }
                
                // 清除过期的登录状态
                localStorage.removeItem('neosystem_logged_in');
                localStorage.removeItem('neosystem_username');
                localStorage.removeItem('neosystem_login_time');
            }
        }
        
        // 初始化世界地图
        function initWorldMap() {
            // 创建地图
            worldMap = L.map('worldmap').setView([30, 0], 2);
            
            // 添加深色主题的地图图层
            L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
                subdomains: 'abcd',
                maxZoom: 18
            }).addTo(worldMap);
            
            // 添加自定义网格图层
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
                opacity: 0.1,
                maxZoom: 18
            }).addTo(worldMap);
            
            // 初始化地图数据
            generateMapData();
            
            // 渲染地图数据
            renderMapData();
            
            // 添加地图点击事件
            worldMap.on('click', function(e) {
                // 随机添加一个网络节点
                addRandomNode(e.latlng);
                updateMapStats();
            });
            
            // 初始化地图控件
            initMapControls();
        }
        
        // 生成地图数据
        function generateMapData() {
            // 清空现有数据
            mapData.nodes = [];
            mapData.attacks = [];
            mapData.users = [];
            mapData.connections = [];
            mapData.traffic = [];
            
            // 预定义的主要城市坐标
            const majorCities = [
                { name: "纽约", lat: 40.7128, lng: -74.0060, country: "美国" },
                { name: "伦敦", lat: 51.5074, lng: -0.1278, country: "英国" },
                { name: "东京", lat: 35.6762, lng: 139.6503, country: "日本" },
                { name: "上海", lat: 31.2304, lng: 121.4737, country: "中国" },
                { name: "新加坡", lat: 1.3521, lng: 103.8198, country: "新加坡" },
                { name: "法兰克福", lat: 50.1109, lng: 8.6821, country: "德国" },
                { name: "悉尼", lat: -33.8688, lng: 151.2093, country: "澳大利亚" },
                { name: "圣保罗", lat: -23.5505, lng: -46.6333, country: "巴西" },
                { name: "莫斯科", lat: 55.7558, lng: 37.6173, country: "俄罗斯" },
                { name: "孟买", lat: 19.0760, lng: 72.8777, country: "印度" }
            ];
            
            // 生成网络节点
            majorCities.forEach(city => {
                const nodeType = Math.random() > 0.7 ? "server" : "router";
                const nodeStatus = Math.random() > 0.2 ? "active" : "inactive";
                const load = Math.floor(Math.random() * 100);
                
                mapData.nodes.push({
                    id: `node_${mapData.nodes.length}`,
                    name: `${city.name} ${nodeType === "server" ? "服务器" : "路由器"}`,
                    type: nodeType,
                    lat: city.lat + (Math.random() - 0.5) * 2,
                    lng: city.lng + (Math.random() - 0.5) * 2,
                    status: nodeStatus,
                    load: load,
                    country: city.country,
                    connections: Math.floor(Math.random() * 10) + 1
                });
            });
            
            // 生成攻击事件
            for (let i = 0; i < 5; i++) {
                const randomCity = majorCities[Math.floor(Math.random() * majorCities.length)];
                mapData.attacks.push({
                    id: `attack_${i}`,
                    type: ["DDoS", "恶意软件", "数据泄露", "网络钓鱼", "零日漏洞"][Math.floor(Math.random() * 5)],
                    source: ["未知", "国家黑客", "犯罪组织", "内部威胁", "竞争企业"][Math.floor(Math.random() * 5)],
                    target: randomCity.name,
                    lat: randomCity.lat + (Math.random() - 0.5) * 5,
                    lng: randomCity.lng + (Math.random() - 0.5) * 5,
                    severity: ["低", "中", "高", "严重"][Math.floor(Math.random() * 4)],
                    timestamp: new Date(Date.now() - Math.random() * 86400000).toISOString()
                });
            }
            
            // 生成在线用户
            for (let i = 0; i < 15; i++) {
                const lat = -50 + Math.random() * 100;
                const lng = -180 + Math.random() * 360;
                
                mapData.users.push({
                    id: `user_${i}`,
                    username: `user${Math.floor(Math.random() * 10000)}`,
                    ip: `${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}`,
                    lat: lat,
                    lng: lng,
                    device: ["桌面", "手机", "平板", "服务器"][Math.floor(Math.random() * 4)],
                    onlineTime: Math.floor(Math.random() * 24) + "小时",
                    location: "未知"
                });
            }
            
            // 生成网络连接
            for (let i = 0; i < 10; i++) {
                const node1 = mapData.nodes[Math.floor(Math.random() * mapData.nodes.length)];
                const node2 = mapData.nodes[Math.floor(Math.random() * mapData.nodes.length)];
                
                if (node1.id !== node2.id) {
                    mapData.connections.push({
                        id: `conn_${i}`,
                        from: node1.id,
                        to: node2.id,
                        fromLat: node1.lat,
                        fromLng: node1.lng,
                        toLat: node2.lat,
                        toLng: node2.lng,
                        bandwidth: Math.floor(Math.random() * 1000) + 100,
                        latency: Math.floor(Math.random() * 100) + 10
                    });
                }
            }
            
            // 生成流量热图数据
            for (let i = 0; i < 20; i++) {
                const lat = -60 + Math.random() * 120;
                const lng = -180 + Math.random() * 360;
                
                mapData.traffic.push({
                    id: `traffic_${i}`,
                    lat: lat,
                    lng: lng,
                    intensity: Math.random(),
                    type: ["正常", "可疑", "攻击"][Math.floor(Math.random() * 3)]
                });
            }
        }
        
        // 渲染地图数据
        function renderMapData() {
            // 清除现有标记
            clearMapMarkers();
            
            // 获取图层控制状态
            const showNodes = document.getElementById('layer-nodes').checked;
            const showAttacks = document.getElementById('layer-attacks').checked;
            const showUsers = document.getElementById('layer-users').checked;
            const showConnections = document.getElementById('layer-connections').checked;
            const showTraffic = document.getElementById('layer-traffic').checked;
            
            // 渲染网络节点
            if (showNodes) {
                mapData.nodes.forEach(node => {
                    const markerColor = node.type === "server" ? "#9c88ff" : "#00ff9d";
                    const markerSize = node.type === "server" ? 12 : 8;
                    const markerIcon = L.divIcon({
                        className: 'map-marker-pulse',
                        html: `<div style="background-color: ${markerColor}; width: ${markerSize}px; height: ${markerSize}px; border-radius: 50%; border: 2px solid white; box-shadow: 0 0 10px ${markerColor};"></div>`,
                        iconSize: [markerSize, markerSize],
                        iconAnchor: [markerSize/2, markerSize/2]
                    });
                    
                    const marker = L.marker([node.lat, node.lng], { icon: markerIcon })
                        .addTo(worldMap)
                        .bindPopup(createNodePopup(node));
                    
                    mapMarkers.push(marker);
                });
            }
            
            // 渲染攻击事件
            if (showAttacks) {
                mapData.attacks.forEach(attack => {
                    const markerIcon = L.divIcon({
                        className: 'map-marker-attack',
                        html: `<div style="background-color: #ff4757; width: 10px; height: 10px; border-radius: 50%; border: 2px solid white; box-shadow: 0 0 10px #ff4757;"></div>`,
                        iconSize: [10, 10],
                        iconAnchor: [5, 5]
                    });
                    
                    const marker = L.marker([attack.lat, attack.lng], { icon: markerIcon })
                        .addTo(worldMap)
                        .bindPopup(createAttackPopup(attack));
                    
                    mapMarkers.push(marker);
                });
            }
            
            // 渲染在线用户
            if (showUsers) {
                mapData.users.forEach(user => {
                    const markerIcon = L.divIcon({
                        html: `<div style="background-color: #00a8ff; width: 6px; height: 6px; border-radius: 50%; border: 1px solid white; box-shadow: 0 0 5px #00a8ff;"></div>`,
                        iconSize: [6, 6],
                        iconAnchor: [3, 3]
                    });
                    
                    const marker = L.marker([user.lat, user.lng], { icon: markerIcon })
                        .addTo(worldMap)
                        .bindPopup(createUserPopup(user));
                    
                    mapMarkers.push(marker);
                });
            }
            
            // 渲染网络连接
            if (showConnections) {
                mapData.connections.forEach(conn => {
                    const lineColor = conn.latency < 50 ? "#00ff9d" : conn.latency < 100 ? "#ffcc00" : "#ff4757";
                    const lineWeight = Math.min(conn.bandwidth / 200, 5);
                    
                    const polyline = L.polyline(
                        [[conn.fromLat, conn.fromLng], [conn.toLat, conn.toLng]],
                        { color: lineColor, weight: lineWeight, opacity: 0.6, dashArray: "5, 5" }
                    ).addTo(worldMap);
                    
                    mapConnections.push(polyline);
                });
            }
            
            // 渲染流量热图
            if (showTraffic) {
                // 这里简化处理，实际应用中可以使用真正的热图图层
                mapData.traffic.forEach(traffic => {
                    if (traffic.intensity > 0.7) {
                        const color = traffic.type === "攻击" ? "#ff4757" : traffic.type === "可疑" ? "#ffcc00" : "#00ff9d";
                        const radius = traffic.intensity * 20;
                        
                        const circle = L.circle([traffic.lat, traffic.lng], {
                            color: color,
                            fillColor: color,
                            fillOpacity: 0.2,
                            radius: radius * 1000 // 转换为米
                        }).addTo(worldMap);
                        
                        mapMarkers.push(circle);
                    }
                });
            }
            
            // 更新地图统计
            updateMapStats();
        }
        
        // 创建节点弹出窗口
        function createNodePopup(node) {
            const statusColor = node.status === "active" ? "#00ff9d" : "#ff4757";
            const typeText = node.type === "server" ? "服务器" : "路由器";
            
            return `
                <div class="map-popup">
                    <div class="map-popup-title">
                        <i class="fas fa-server"></i>
                        ${node.name}
                    </div>
                    <div class="map-popup-content">
                        <div class="map-popup-item">
                            <span class="map-popup-label">类型:</span>
                            <span class="map-popup-value">${typeText}</span>
                        </div>
                        <div class="map-popup-item">
                            <span class="map-popup-label">状态:</span>
                            <span class="map-popup-value" style="color: ${statusColor}">${node.status === "active" ? "活跃" : "离线"}</span>
                        </div>
                        <div class="map-popup-item">
                            <span class="map-popup-label">负载:</span>
                            <span class="map-popup-value">${node.load}%</span>
                        </div>
                        <div class="map-popup-item">
                            <span class="map-popup-label">位置:</span>
                            <span class="map-popup-value">${node.country}</span>
                        </div>
                        <div class="map-popup-item">
                            <span class="map-popup-label">连接数:</span>
                            <span class="map-popup-value">${node.connections}</span>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // 创建攻击事件弹出窗口
        function createAttackPopup(attack) {
            const severityColor = {
                "低": "#00ff9d",
                "中": "#ffcc00",
                "高": "#ff6b6b",
                "严重": "#ff4757"
            }[attack.severity];
            
            return `
                <div class="map-popup">
                    <div class="map-popup-title">
                        <i class="fas fa-bolt"></i>
                        安全威胁
                    </div>
                    <div class="map-popup-content">
                        <div class="map-popup-item">
                            <span class="map-popup-label">类型:</span>
                            <span class="map-popup-value">${attack.type}</span>
                        </div>
                        <div class="map-popup-item">
                            <span class="map-popup-label">目标:</span>
                            <span class="map-popup-value">${attack.target}</span>
                        </div>
                        <div class="map-popup-item">
                            <span class="map-popup-label">来源:</span>
                            <span class="map-popup-value">${attack.source}</span>
                        </div>
                        <div class="map-popup-item">
                            <span class="map-popup-label">严重性:</span>
                            <span class="map-popup-value" style="color: ${severityColor}">${attack.severity}</span>
                        </div>
                        <div class="map-popup-item">
                            <span class="map-popup-label">时间:</span>
                            <span class="map-popup-value">${new Date(attack.timestamp).toLocaleString()}</span>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // 创建用户弹出窗口
        function createUserPopup(user) {
            return `
                <div class="map-popup">
                    <div class="map-popup-title">
                        <i class="fas fa-user"></i>
                        在线用户
                    </div>
                    <div class="map-popup-content">
                        <div class="map-popup-item">
                            <span class="map-popup-label">用户名:</span>
                            <span class="map-popup-value">${user.username}</span>
                        </div>
                        <div class="map-popup-item">
                            <span class="map-popup-label">IP地址:</span>
                            <span class="map-popup-value">${user.ip}</span>
                        </div>
                        <div class="map-popup-item">
                            <span class="map-popup-label">设备:</span>
                            <span class="map-popup-value">${user.device}</span>
                        </div>
                        <div class="map-popup-item">
                            <span class="map-popup-label">在线时间:</span>
                            <span class="map-popup-value">${user.onlineTime}</span>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // 清除地图标记
        function clearMapMarkers() {
            mapMarkers.forEach(marker => {
                if (marker.remove) marker.remove();
            });
            
            mapConnections.forEach(connection => {
                if (connection.remove) connection.remove();
            });
            
            mapMarkers = [];
            mapConnections = [];
        }
        
        // 添加随机节点
        function addRandomNode(latlng) {
            const nodeTypes = ["server", "router"];
            const nodeType = nodeTypes[Math.floor(Math.random() * nodeTypes.length)];
            
            const newNode = {
                id: `node_${Date.now()}`,
                name: `新建${nodeType === "server" ? "服务器" : "路由器"}`,
                type: nodeType,
                lat: latlng.lat,
                lng: latlng.lng,
                status: "active",
                load: Math.floor(Math.random() * 100),
                country: "未知",
                connections: 1
            };
            
            mapData.nodes.push(newNode);
            
            // 重新渲染地图
            renderMapData();
            
            // 显示通知
            showNotification("节点添加成功", `已添加新的${nodeType === "server" ? "服务器" : "路由器"}节点`, 3000);
        }
        
        // 更新地图统计
        function updateMapStats() {
            const activeNodes = mapData.nodes.filter(node => node.status === "active").length;
            const attackEvents = mapData.attacks.length;
            const onlineUsers = mapData.users.length;
            const serverNodes = mapData.nodes.filter(node => node.type === "server").length;
            
            // 模拟数据传输量
            const dataTransfer = (Math.random() * 100).toFixed(1);
            
            // 模拟平均响应时间
            const avgResponse = Math.floor(Math.random() * 200) + 20;
            
            // 更新统计显示
            document.getElementById('active-nodes').textContent = activeNodes;
            document.getElementById('attack-events').textContent = attackEvents;
            document.getElementById('online-users').textContent = onlineUsers;
            document.getElementById('server-nodes').textContent = serverNodes;
            document.getElementById('data-transfer').textContent = dataTransfer + " TB";
            document.getElementById('avg-response').textContent = avgResponse + " ms";
        }
        
        // 初始化地图控件
        function initMapControls() {
            // 刷新地图按钮
            document.getElementById('refresh-map').addEventListener('click', function() {
                generateMapData();
                renderMapData();
                showNotification("地图已刷新", "已重新生成地图数据", 3000);
            });
            
            // 清除标记按钮
            document.getElementById('clear-map').addEventListener('click', function() {
                clearMapMarkers();
                showNotification("标记已清除", "已清除所有地图标记", 3000);
            });
            
            // 图层控制
            const layerControls = document.querySelectorAll('.layer-control-item input');
            layerControls.forEach(control => {
                control.addEventListener('change', function() {
                    renderMapData();
                });
            });
            
            // 地图工具提示
            const mapTooltip = document.getElementById('map-tooltip');
            let tooltipTimeout;
            
            worldMap.on('mousemove', function(e) {
                // 查找鼠标位置附近的元素
                const nearbyElements = [];
                
                // 检查节点
                mapData.nodes.forEach(node => {
                    const distance = worldMap.distance([e.latlng.lat, e.latlng.lng], [node.lat, node.lng]);
                    if (distance < 50000) { // 50公里内
                        nearbyElements.push({
                            name: node.name,
                            type: 'node',
                            distance: distance
                        });
                    }
                });
                
                // 检查攻击事件
                mapData.attacks.forEach(attack => {
                    const distance = worldMap.distance([e.latlng.lat, e.latlng.lng], [attack.lat, attack.lng]);
                    if (distance < 100000) { // 100公里内
                        nearbyElements.push({
                            name: `${attack.type}攻击`,
                            type: 'attack',
                            distance: distance
                        });
                    }
                });
                
                // 如果有附近元素，显示工具提示
                if (nearbyElements.length > 0) {
                    // 按距离排序
                    nearbyElements.sort((a, b) => a.distance - b.distance);
                    
                    // 显示最近的元素
                    const nearest = nearbyElements[0];
                    const distanceKm = Math.round(nearest.distance / 1000);
                    
                    mapTooltip.innerHTML = `
                        <strong>${nearest.name}</strong><br>
                        距离: ${distanceKm}公里
                    `;
                    
                    mapTooltip.style.display = 'block';
                    mapTooltip.style.left = (e.originalEvent.clientX + 10) + 'px';
                    mapTooltip.style.top = (e.originalEvent.clientY + 10) + 'px';
                    
                    // 清除之前的超时
                    clearTimeout(tooltipTimeout);
                    
                    // 设置新的超时
                    tooltipTimeout = setTimeout(() => {
                        mapTooltip.style.display = 'none';
                    }, 2000);
                } else {
                    mapTooltip.style.display = 'none';
                }
            });
        }
        
        // 加载保存的配置
        function loadAIConfig() {
            const savedConfig = localStorage.getItem('neosystem_ai_config');
            if (savedConfig) {
                try {
                    const config = JSON.parse(savedConfig);
                    aiConfig = { ...aiConfig, ...config };
                    
                    // 更新UI
                    document.getElementById('api-key').value = aiConfig.apiKey || '';
                    document.getElementById('ai-service').value = aiConfig.aiService;
                    document.getElementById('ai-model').value = aiConfig.aiModel;
                    document.getElementById('custom-api-endpoint').value = aiConfig.customEndpoint || '';
                    
                    // 更新模式选择
                    const modeBtns = document.querySelectorAll('.mode-btn');
                    modeBtns.forEach(btn => btn.classList.remove('active'));
                    const activeBtn = document.querySelector(`.mode-btn[data-mode="${aiConfig.mode}"]`);
                    if (activeBtn) {
                        activeBtn.classList.add('active');
                    }
                    
                    updateAPIStatus();
                } catch (e) {
                    console.error('加载AI配置失败:', e);
                }
            }
        }
        
        // 保存配置
        function saveAIConfig() {
            localStorage.setItem('neosystem_ai_config', JSON.stringify(aiConfig));
            showNotification("配置已保存", "AI配置已保存到本地存储");
        }
        
        // 更新API状态显示
        function updateAPIStatus() {
            const statusElement = document.getElementById('api-status');
            const statusDot = statusElement.querySelector('.api-status-dot');
            const statusText = statusElement.querySelector('span');
            
            if (aiConfig.apiConnected && aiConfig.apiKey) {
                statusDot.className = 'api-status-dot connected';
                statusText.textContent = 'API已连接';
            } else if (aiConfig.apiKey) {
                statusDot.className = 'api-status-dot disconnected';
                statusText.textContent = 'API已配置但未测试';
            } else {
                statusDot.className = 'api-status-dot disconnected';
                statusText.textContent = 'API未配置';
            }
        }
        
        
        // 改进的系统监控 - 尝试获取真实数据
        const EnhancedSystemMonitor = {
            // 获取真实CPU使用率（通过Web Worker模拟真实负载）
            getCPUUsage: function() {
                // 尝试使用Performance API获取更真实的数据
                let cpuUsage = 0;
                
                // 如果是Chrome浏览器，尝试使用performance.now()计算负载
                if (window.performance && window.performance.now) {
                    // 模拟基于时间的CPU负载计算
                    const now = performance.now();
                    const timeSinceLoad = now / 10000; // 转换为秒
                    
                    // 基于正弦波和随机数生成更真实的CPU使用率
                    const baseLoad = 15; // 基础负载
                    const sineLoad = Math.sin(timeSinceLoad) * 20; // 周期性负载
                    const randomLoad = Math.random() * 30; // 随机负载
                    const userLoad = this.getUserActivityLoad(); // 用户活动负载
                    
                    cpuUsage = baseLoad + sineLoad + randomLoad + userLoad;
                    
                    // 限制在1-95%之间
                    cpuUsage = Math.max(1, Math.min(95, cpuUsage));
                } else {
                    // 备用方法：简单的随机模拟
                    cpuUsage = 20 + Math.random() * 50;
                }
                
                return cpuUsage;
            },
            
            // 根据用户活动计算负载
            getUserActivityLoad: function() {
                let activityLoad = 0;
                
                // 根据当前页面活动增加负载
                if (currentPage === 'games') {
                    activityLoad = 10; // 游戏页面增加CPU负载
                } else if (currentPage === 'ai') {
                    activityLoad = 5; // AI页面增加负载
                } else if (currentPage === 'worldmap') {
                    activityLoad = 3; // 地图页面增加负载
                }
                
                // 根据鼠标移动增加负载
                if (window.mouseMoveCount && window.mouseMoveCount > 10) {
                    activityLoad += Math.min(10, window.mouseMoveCount / 5);
                }
                
                return activityLoad;
            },
            
            // 获取真实内存使用情况
            getMemoryInfo: function() {
                // 尝试使用Performance API获取真实内存信息（仅Chrome支持）
                if (performance && performance.memory) {
                    const memory = performance.memory;
                    const usedJSHeapSize = memory.usedJSHeapSize;
                    const totalJSHeapSize = memory.totalJSHeapSize;
                    const jsHeapSizeLimit = memory.jsHeapSizeLimit;
                    
                    // 计算百分比
                    const percent = (usedJSHeapSize / totalJSHeapSize) * 100;
                    
                    // 转换为GB
                    const usedGB = usedJSHeapSize / (1024 * 1024 * 1024);
                    const totalGB = totalJSHeapSize / (1024 * 1024 * 1024);
                    const limitGB = jsHeapSizeLimit / (1024 * 1024 * 1024);
                    
                    return {
                        percent: percent.toFixed(1),
                        used: usedGB.toFixed(2),
                        total: totalGB.toFixed(2),
                        available: (totalGB - usedGB).toFixed(2),
                        limit: limitGB.toFixed(2),
                        isReal: true
                    };
                } else {
                    // 模拟数据
                    const percent = 40 + Math.random() * 30;
                    const total = 8 + Math.random() * 8; // 8-16GB内存
                    const used = (total * percent / 100).toFixed(2);
                    
                    return {
                        percent: percent.toFixed(1),
                        used: used,
                        total: total.toFixed(1),
                        available: (total - used).toFixed(2),
                        isReal: false
                    };
                }
            },
            
            // 获取真实存储信息
            getStorageInfo: function() {
                // 尝试使用Storage API获取真实存储信息
                if (navigator.storage && navigator.storage.estimate) {
                    return navigator.storage.estimate().then(estimate => {
                        const used = estimate.usage || 0;
                        const total = estimate.quota || (5 * 1024 * 1024 * 1024); // 默认5GB
                        const percent = (used / total) * 100;
                        
                        return {
                            percent: percent.toFixed(1),
                            used: (used / (1024 * 1024 * 1024)).toFixed(2),
                            total: (total / (1024 * 1024 * 1024)).toFixed(2),
                            free: ((total - used) / (1024 * 1024 * 1024)).toFixed(2),
                            isReal: true
                        };
                    }).catch(() => {
                        return this.getSimulatedStorageInfo();
                    });
                } else {
                    return Promise.resolve(this.getSimulatedStorageInfo());
                }
            },
            
            // 获取模拟存储信息
            getSimulatedStorageInfo: function() {
                const total = 256 + Math.random() * 256; // 256-512GB存储
                const used = 50 + Math.random() * 150; // 50-200GB已使用
                const percent = (used / total) * 100;
                
                return {
                    percent: percent.toFixed(1),
                    used: used.toFixed(1),
                    total: total.toFixed(1),
                    free: (total - used).toFixed(1),
                    isReal: false
                };
            },
            
            // 获取真实网络信息
            getNetworkInfo: function() {
                // 模拟更真实的网络活动
                const now = Date.now();
                const timeFactor = Math.sin(now / 10000) * 0.5 + 0.5; // 0-1之间波动
                
                // 基础网络活动
                let upload = 10 + timeFactor * 50 + Math.random() * 40;
                let download = 50 + timeFactor * 100 + Math.random() * 80;
                
                // 根据页面活动增加网络使用
                if (currentPage === 'network') {
                    upload *= 1.5;
                    download *= 2;
                }
                
                const total = upload + download;
                
                return {
                    upload: upload.toFixed(1),
                    download: download.toFixed(1),
                    total: total.toFixed(1),
                    activity: (total > 200 ? "高" : total > 100 ? "中" : "低"),
                    isReal: false
                };
            },
            
            // 获取真实系统信息
            getSystemInfo: function() {
                const platform = navigator.platform;
                const userAgent = navigator.userAgent;
                const language = navigator.language;
                const cookies = navigator.cookieEnabled ? "是" : "否";
                const online = navigator.onLine ? "在线" : "离线";
                const screenWidth = window.screen.width;
                const screenHeight = window.screen.height;
                
                // 检测浏览器类型
                let browser = "未知";
                if (userAgent.includes("Chrome") && !userAgent.includes("Edg")) browser = "Chrome";
                else if (userAgent.includes("Firefox")) browser = "Firefox";
                else if (userAgent.includes("Safari") && !userAgent.includes("Chrome")) browser = "Safari";
                else if (userAgent.includes("Edg")) browser = "Edge";
                else if (userAgent.includes("Opera") || userAgent.includes("OPR")) browser = "Opera";
                
                // 检测操作系统
                let os = "未知";
                if (platform.includes("Win")) os = "Windows";
                else if (platform.includes("Mac")) os = "macOS";
                else if (platform.includes("Linux")) os = "Linux";
                else if (platform.includes("Android")) os = "Android";
                else if (platform.includes("iOS")) os = "iOS";
                
                // 获取CPU核心数
                const cores = navigator.hardwareConcurrency || 4;
                
                // 获取设备内存（如果可用）
                const deviceMemory = navigator.deviceMemory ? `${navigator.deviceMemory} GB` : "未知";
                
                return {
                    platform: os,
                    browser: browser,
                    screenRes: `${screenWidth} × ${screenHeight}`,
                    online: online,
                    language: language,
                    cookies: cookies,
                    userAgent: userAgent.substring(0, 50) + "...",
                    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                    jsEnabled: "是",
                    deviceMemory: deviceMemory,
                    hardwareConcurrency: cores,
                    cores: cores
                };
            }
        };
        
        // AI助手系统
        const AIAssistant = {
            // AI响应处理
            getAIResponse: async function(userMessage) {
                const currentMode = aiConfig.mode;
                
                // 如果是本地模式或API模式但未配置，使用预定义回答
                if (currentMode === 'local' || (currentMode === 'api' && !aiConfig.apiKey)) {
                    return this.getLocalResponse(userMessage);
                }
                
                // 如果是混合模式，随机选择使用本地或API
                if (currentMode === 'hybrid') {
                    const useAPI = Math.random() > 0.5 && aiConfig.apiKey;
                    if (useAPI) {
                        try {
                            return await this.getAPIResponse(userMessage);
                        } catch (error) {
                            console.error('API调用失败，回退到本地模式:', error);
                            return this.getLocalResponse(userMessage);
                        }
                    } else {
                        return this.getLocalResponse(userMessage);
                    }
                }
                
                // 如果是API模式且已配置，使用API
                if (currentMode === 'api' && aiConfig.apiKey) {
                    try {
                        return await this.getAPIResponse(userMessage);
                    } catch (error) {
                        console.error('API调用失败:', error);
                        return `API调用失败: ${error.message}\n\n将使用本地知识库回答:\n\n${this.getLocalResponse(userMessage)}`;
                    }
                }
                
                // 默认回退到本地模式
                return this.getLocalResponse(userMessage);
            },
            
            // 获取本地响应（原有的预定义回答）
            getLocalResponse: function(userMessage) {
                // 模拟AI思考时间
                // 在实际中这里会调用本地知识库
                const message = userMessage.toLowerCase();
                
                // 处理命令
                if (message.includes('help') || message.includes('命令') || message.includes('帮助')) {
                    return this.getHelpResponse();
                } else if (message.includes('性能') || message.includes('优化')) {
                    return this.getPerformanceResponse();
                } else if (message.includes('cpu') || message.includes('处理器')) {
                    return this.getCPUResponse();
                } else if (message.includes('内存') || message.includes('ram')) {
                    return this.getMemoryResponse();
                } else if (message.includes('网络') || message.includes('ping') || message.includes('诊断')) {
                    return this.getNetworkResponse();
                } else if (message.includes('安全') || message.includes('防火墙') || message.includes('病毒')) {
                    return this.getSecurityResponse();
                } else if (message.includes('进程') || message.includes('任务')) {
                    return this.getProcessResponse();
                } else if (message.includes('文件') || message.includes('目录')) {
                    return this.getFileResponse();
                } else if (message.includes('日志') || message.includes('log')) {
                    return this.getLogResponse();
                } else if (message.includes('你好') || message.includes('hi') || message.includes('hello')) {
                    return this.getGreetingResponse();
                } else if (message.includes('时间') || message.includes('date')) {
                    return this.getTimeResponse();
                } else if (message.includes('系统') || message.includes('system') || message.includes('报告')) {
                    return this.getSystemResponse();
                } else if (message.includes('脚本') || message.includes('生成')) {
                    return this.getScriptResponse();
                } else if (message.includes('deepseek') || message.includes('api') || message.includes('配置')) {
                    return this.getDeepSeekHelpResponse();
                } else {
                    return this.getDefaultResponse(userMessage);
                }
            },
            
            // 调用外部AI API
            getAPIResponse: async function(userMessage) {
                const systemInfo = SystemMonitor.getSystemInfo();
                const cpuUsage = SystemMonitor.getCPUUsage();
                const memoryInfo = SystemMonitor.getMemoryInfo();
                
                // 构建系统上下文
                const systemContext = `你是一个专业的系统管理员AI助手，正在一个名为NeoSystem的系统监控终端中工作。当前系统信息：
- 操作系统: ${systemInfo.platform}
- CPU使用率: ${cpuUsage.toFixed(1)}%
- 内存使用: ${memoryInfo.used} GB / ${memoryInfo.total} GB (${memoryInfo.percent}%)
- 浏览器: ${systemInfo.browser}
- 在线状态: ${systemInfo.online}
- 时间: ${new Date().toLocaleString()}

用户正在使用NeoSystem监控终端，这是一个模拟系统监控界面。请以专业系统管理员的身份回答技术问题，提供实用、准确的技术建议。如果用户询问关于DeepSeek API配置的问题，请提供详细的指导。`;
                
                // 根据选择的AI服务构建请求
                let apiEndpoint, requestBody, headers;
                
                switch(aiConfig.aiService) {
                    case 'deepseek':
                        apiEndpoint = 'https://api.deepseek.com/v1/chat/completions';
                        headers = {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${aiConfig.apiKey}`
                        };
                        requestBody = {
                            model: aiConfig.aiModel,
                            messages: [
                                { role: "system", content: systemContext },
                                { role: "user", content: userMessage }
                            ],
                            temperature: aiConfig.temperature,
                            max_tokens: aiConfig.maxTokens,
                            stream: false
                        };
                        break;
                        
                    case 'openai':
                        apiEndpoint = 'https://api.openai.com/v1/chat/completions';
                        headers = {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${aiConfig.apiKey}`
                        };
                        requestBody = {
                            model: aiConfig.aiModel,
                            messages: [
                                { role: "system", content: systemContext },
                                { role: "user", content: userMessage }
                            ],
                            temperature: aiConfig.temperature,
                            max_tokens: aiConfig.maxTokens
                        };
                        break;
                        
                    case 'anthropic':
                        apiEndpoint = 'https://api.anthropic.com/v1/messages';
                        headers = {
                            'Content-Type': 'application/json',
                            'x-api-key': aiConfig.apiKey,
                            'anthropic-version': '2023-06-01'
                        };
                        requestBody = {
                            model: aiConfig.aiModel,
                            max_tokens: aiConfig.maxTokens,
                            temperature: aiConfig.temperature,
                            system: systemContext,
                            messages: [
                                { role: "user", content: userMessage }
                            ]
                        };
                        break;
                        
                    case 'gemini':
                        apiEndpoint = `https://generativelanguage.googleapis.com/v1beta/models/${aiConfig.aiModel}:generateContent?key=${aiConfig.apiKey}`;
                        headers = {
                            'Content-Type': 'application/json'
                        };
                        requestBody = {
                            contents: [
                                {
                                    parts: [
                                        { text: systemContext + "\n\n用户问题: " + userMessage }
                                    ]
                                }
                            ],
                            generationConfig: {
                                temperature: aiConfig.temperature,
                                maxOutputTokens: aiConfig.maxTokens
                            }
                        };
                        break;
                        
                    case 'custom':
                        apiEndpoint = aiConfig.customEndpoint || 'https://api.openai.com/v1/chat/completions';
                        headers = {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${aiConfig.apiKey}`
                        };
                        requestBody = {
                            model: aiConfig.aiModel,
                            messages: [
                                { role: "system", content: systemContext },
                                { role: "user", content: userMessage }
                            ],
                            temperature: aiConfig.temperature,
                            max_tokens: aiConfig.maxTokens
                        };
                        break;
                }
                
                // 发送API请求
                const response = await fetch(apiEndpoint, {
                    method: 'POST',
                    headers: headers,
                    body: JSON.stringify(requestBody)
                });
                
                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`API请求失败: ${response.status} ${response.statusText}\n${errorText}`);
                }
                
                const data = await response.json();
                
                // 根据不同的API响应格式提取回答
                let aiResponse;
                switch(aiConfig.aiService) {
                    case 'deepseek':
                    case 'openai':
                    case 'custom':
                        aiResponse = data.choices[0].message.content;
                        break;
                        
                    case 'anthropic':
                        aiResponse = data.content[0].text;
                        break;
                        
                    case 'gemini':
                        aiResponse = data.candidates[0].content.parts[0].text;
                        break;
                        
                    default:
                        aiResponse = "收到AI响应但无法解析格式";
                }
                
                return aiResponse;
            },
            
            // 测试API连接
            testAPIConnection: async function() {
                if (!aiConfig.apiKey) {
                    throw new Error('请先输入API密钥');
                }
                
                // 发送简单的测试请求
                const testMessage = "简单回复'连接成功'即可";
                
                try {
                    const response = await this.getAPIResponse(testMessage);
                    if (response && response.includes('连接成功')) {
                        aiConfig.apiConnected = true;
                        updateAPIStatus();
                        return true;
                    } else {
                        throw new Error('API响应异常');
                    }
                } catch (error) {
                    aiConfig.apiConnected = false;
                    updateAPIStatus();
                    throw error;
                }
            },
            
            // DeepSeek帮助响应
            getDeepSeekHelpResponse: function() {
                return `DeepSeek API配置指南：\n\n` +
                       `1. <strong>获取API密钥：</strong>\n` +
                       `   - 访问 https://platform.deepseek.com/api_keys\n` +
                       `   - 注册并登录DeepSeek平台\n` +
                       `   - 创建新的API密钥\n\n` +
                       `2. <strong>配置步骤：</strong>\n` +
                       `   - 在AI配置面板中选择"DeepSeek"作为AI服务\n` +
                       `   - 将获取的API密钥粘贴到API密钥输入框\n` +
                       `   - 选择模型：DeepSeek Chat (通用对话) 或 DeepSeek Coder (编程专用)\n` +
                       `   - 点击"测试API连接"验证配置\n` +
                       `   - 保存配置\n\n` +
                       `3. <strong>API端点：</strong>\n` +
                       `   - 官方端点: https://api.deepseek.com/v1/chat/completions\n` +
                       `   - 支持流式输出和完整对话\n\n` +
                       `4. <strong>注意事项：</strong>\n` +
                       `   - API密钥请妥善保管，不要泄露\n` +
                       `   - 免费额度有限，注意使用量\n` +
                       `   - 如果连接失败，检查网络和API密钥是否正确\n\n` +
                       `5. <strong>模型特点：</strong>\n` +
                       `   - DeepSeek Chat: 适合通用对话和技术问答\n` +
                       `   - DeepSeek Coder: 专为编程和代码生成优化\n\n` +
                       `现在您可以在API模式下使用DeepSeek AI助手了！`;
            },
            
            // 原有的预定义回答函数（保持原样）
            getHelpResponse: function() {
                return `可用命令列表：\n\n` +
                       `<code>help</code> - 显示此帮助信息\n` +
                       `<code>system</code> - 显示系统信息\n` +
                       `<code>performance</code> - 性能优化建议\n` +
                       `<code>network</code> - 网络诊断建议\n` +
                       `<code>security</code> - 安全建议\n` +
                       `<code>process</code> - 进程管理建议\n` +
                       `<code>files</code> - 文件管理建议\n` +
                       `<code>logs</code> - 查看系统日志\n` +
                       `<code>time</code> - 显示当前时间\n` +
                       `<code>report</code> - 生成系统状态报告\n` +
                       `<code>script</code> - 生成监控脚本\n` +
                       `<code>deepseek</code> - DeepSeek API配置帮助\n` +
                       `\n您也可以直接询问具体问题，我会尽力为您解答。`;
            },
            
            getPerformanceResponse: function() {
                return `系统性能优化建议：\n\n` +
                       `1. <strong>CPU优化：</strong>\n` +
                       `   - 关闭不必要的后台程序\n` +
                       `   - 使用任务管理器结束高CPU占用进程\n` +
                       `   - 更新驱动程序\n\n` +
                       `2. <strong>内存优化：</strong>\n` +
                       `   - 增加虚拟内存大小\n` +
                       `   - 关闭不需要的浏览器标签\n` +
                       `   - 定期重启系统\n\n` +
                       `3. <strong>存储优化：</strong>\n` +
                       `   - 清理临时文件\n` +
                       `   - 卸载不用的软件\n` +
                       `   - 使用磁盘清理工具\n\n` +
                       `4. <strong>网络优化：</strong>\n` +
                       `   - 使用有线连接替代无线\n` +
                       `   - 重启路由器\n` +
                       `   - 关闭不必要的网络服务`;
            },
            
            getCPUResponse: function() {
                const cpuUsage = SystemMonitor.getCPUUsage();
                let advice = "";
                
                if (cpuUsage > 80) {
                    advice = `当前CPU使用率较高（${cpuUsage.toFixed(1)}%），建议：\n` +
                            `1. 检查后台运行的程序\n` +
                            `2. 结束不必要的进程\n` +
                            `3. 考虑升级硬件`;
                } else if (cpuUsage > 50) {
                    advice = `CPU使用率正常（${cpuUsage.toFixed(1)}%），系统运行良好。`;
                } else {
                    advice = `CPU使用率较低（${cpuUsage.toFixed(1)}%），系统负载较轻。`;
                }
                
                return `CPU相关信息：\n\n` +
                       `- 当前使用率: ${cpuUsage.toFixed(1)}%\n` +
                       `- 核心数量: ${navigator.hardwareConcurrency || 4}\n` +
                       `- 建议: ${advice}`;
            },
            
            getMemoryResponse: function() {
                const memory = SystemMonitor.getMemoryInfo();
                return `内存使用情况：\n\n` +
                       `- 总内存: ${memory.total} GB\n` +
                       `- 已使用: ${memory.used} GB\n` +
                       `- 可用: ${memory.available} GB\n` +
                       `- 使用率: ${memory.percent}%\n\n` +
                       `内存优化建议：\n` +
                       `1. 关闭未使用的应用程序\n` +
                       `2. 禁用不必要的启动项\n` +
                       `3. 考虑增加物理内存`;
            },
            
            getNetworkResponse: function() {
                return `网络诊断建议：\n\n` +
                       `1. <strong>Ping测试：</strong>检查到目标主机的连通性\n` +
                       `   <pre>ping 8.8.8.8</pre>\n\n` +
                       `2. <strong>路由追踪：</strong>查看数据包经过的路由节点\n` +
                       `   <pre>traceroute google.com</pre>\n\n` +
                       `3. <strong>端口扫描：</strong>检查目标主机的开放端口\n` +
                       `   <pre>scan localhost 1-100</pre>\n\n` +
                       `4. <strong>网速测试：</strong>测量网络上传下载速度\n` +
                       `   使用网速测试工具\n\n` +
                       `常见问题解决：\n` +
                       `- 如果Ping失败，检查网络连接\n` +
                       `- 如果网速慢，尝试重启路由器\n` +
                       `- 如果端口不通，检查防火墙设置`;
            },
            
            getSecurityResponse: function() {
                return `系统安全建议：\n\n` +
                       `1. <strong>防火墙：</strong>确保防火墙已启用并配置正确规则\n` +
                       `2. <strong>防病毒：</strong>安装并更新防病毒软件\n` +
                       `3. <strong>系统更新：</strong>及时安装系统安全更新\n` +
                       `4. <strong>密码安全：</strong>使用强密码并定期更换\n` +
                       `5. <strong>权限管理：</strong>限制用户权限，遵循最小权限原则\n` +
                       `6. <strong>数据备份：</strong>定期备份重要数据\n\n` +
                       `安全扫描命令：\n` +
                       `<code>security scan</code> - 执行系统安全扫描\n` +
                       `<code>vulnerability scan</code> - 扫描系统漏洞\n` +
                       `<code>malware scan</code> - 扫描恶意软件`;
            },
            
            getProcessResponse: function() {
                return `进程管理建议：\n\n` +
                       `1. <strong>查看进程：</strong>使用进程管理器查看所有运行进程\n` +
                       `2. <strong>结束进程：</strong>选择不需要的进程并结束它们\n` +
                       `3. <strong>排序进程：</strong>按CPU或内存使用率排序\n` +
                       `4. <strong>监控进程：</strong>关注高资源占用的进程\n\n` +
                       `常见系统进程：\n` +
                       `- systemd: 系统服务管理器\n` +
                       `- bash: 命令行解释器\n` +
                       `- chrome/firefox: 浏览器进程\n` +
                       `- node/python: 应用程序进程\n\n` +
                       `警告：不要结束系统关键进程，否则可能导致系统不稳定。`;
            },
            
            getFileResponse: function() {
                return `文件管理建议：\n\n` +
                       `1. <strong>目录结构：</strong>保持清晰的文件目录结构\n` +
                       `2. <strong>文件备份：</strong>定期备份重要文件\n` +
                       `3. <strong>磁盘清理：</strong>定期删除临时文件和缓存\n` +
                       `4. <strong>权限设置：</strong>正确设置文件访问权限\n\n` +
                       `常用文件操作：\n` +
                       `- 查看文件列表\n` +
                       `- 创建新目录\n` +
                       `- 复制/移动文件\n` +
                       `- 删除不需要的文件\n\n` +
                       `在文件管理页面，您可以浏览和管理系统文件。`;
            },
            
            getLogResponse: function() {
                return `系统日志信息：\n\n` +
                       `日志文件通常位于以下位置：\n` +
                       `- Linux: /var/log/\n` +
                       `- Windows: C:\\Windows\\System32\\winevt\\Logs\\\n` +
                       `- macOS: /var/log/\n\n` +
                       `重要日志文件：\n` +
                       `1. <strong>系统日志：</strong>记录系统级别的事件\n` +
                       `2. <strong>应用日志：</strong>记录应用程序事件\n` +
                       `3. <strong>安全日志：</strong>记录安全相关事件\n` +
                       `4. <strong>网络日志：</strong>记录网络活动\n\n` +
                       `查看日志命令：\n` +
                       `<code>cat /var/log/syslog</code> (Linux)\n` +
                       `<code>Get-EventLog -LogName System</code> (Windows PowerShell)`;
            },
            
            getGreetingResponse: function() {
                const greetings = [
                    "您好！我是NeoAI助手，有什么可以帮您的吗？",
                    "嗨！准备好为您提供技术支持了！",
                    "欢迎使用NeoSystem！我是您的AI助手。",
                    "您好！需要关于系统监控的帮助吗？"
                ];
                return greetings[Math.floor(Math.random() * greetings.length)];
            },
            
            getTimeResponse: function() {
                const now = new Date();
                return `当前系统时间：\n\n` +
                       `- 日期: ${now.toLocaleDateString()}\n` +
                       `- 时间: ${now.toLocaleTimeString()}\n` +
                       `- 时区: ${Intl.DateTimeFormat().resolvedOptions().timeZone}\n` +
                       `- UTC时间: ${now.toUTCString()}`;
            },
            
            getSystemResponse: function() {
                const systemInfo = SystemMonitor.getSystemInfo();
                const cpuUsage = SystemMonitor.getCPUUsage();
                const memory = SystemMonitor.getMemoryInfo();
                const storage = SystemMonitor.getStorageInfo();
                const network = SystemMonitor.getNetworkInfo();
                
                return `系统状态报告：\n\n` +
                       `📊 <strong>资源使用情况：</strong>\n` +
                       `- CPU使用率: ${cpuUsage.toFixed(1)}%\n` +
                       `- 内存使用: ${memory.used} GB / ${memory.total} GB (${memory.percent}%)\n` +
                       `- 存储空间: ${storage.used} GB / ${storage.total} GB (${storage.percent}%)\n` +
                       `- 网络活动: ${network.total} KB/s (上:${network.upload} 下:${network.download})\n\n` +
                       `🖥️ <strong>系统信息：</strong>\n` +
                       `- 操作系统: ${systemInfo.platform}\n` +
                       `- 浏览器: ${systemInfo.browser}\n` +
                       `- 屏幕分辨率: ${systemInfo.screenRes}\n` +
                       `- 在线状态: ${systemInfo.online}\n` +
                       `- 在线时间: ${document.getElementById('uptime').textContent}\n\n` +
                       `✅ 系统状态: 正常`;
            },
            
            getScriptResponse: function() {
                return `这是一个简单的系统监控脚本示例：\n\n` +
                       `<pre>#!/bin/bash
# 系统监控脚本
echo "=== 系统监控报告 ==="
echo "生成时间: $(date)"
echo ""
echo "CPU使用率:"
top -bn1 | grep "Cpu(s)" | awk '{print $2}'
echo ""
echo "内存使用:"
free -h | grep Mem | awk '{print $3 "/" $2}'
echo ""
echo "磁盘使用:"
df -h / | awk 'NR==2 {print $3 "/" $2 " (" $5 ")"}'
echo ""
echo "网络连接:"
netstat -an | grep ESTABLISHED | wc -l
echo "=== 报告结束 ==="</pre>\n\n` +
                       `保存为monitor.sh并运行：\n` +
                       `<code>chmod +x monitor.sh && ./monitor.sh</code>`;
            },
            
            getDefaultResponse: function(userMessage) {
                const responses = [
                    `我理解了您的问题："${userMessage}"，但这个问题超出了我的知识范围。您可以尝试重新表述问题，或者询问关于系统监控、网络诊断、安全扫描等方面的问题。`,
                    `关于"${userMessage}"，我目前无法提供详细解答。您可以尝试使用系统自带的工具进行诊断，或查看相关文档。`,
                    `这个问题比较具体，我需要更多上下文信息。您可以尝试使用以下命令之一：\n\n<code>help</code> - 查看可用命令\n<code>system</code> - 查看系统信息\n<code>performance</code> - 获取性能建议`,
                    `感谢您的提问！对于"${userMessage}"，建议您检查系统日志或使用相应的诊断工具进行进一步分析。`
                ];
                return responses[Math.floor(Math.random() * responses.length)];
            }
        };
        // 系统信息检测
        const SystemMonitor = {
            // 获取CPU使用率（模拟，实际中浏览器无法直接获取）
            getCPUUsage: function() {
                return EnhancedSystemMonitor.getCPUUsage();
            },
            
            // 获取内存使用情况
            getMemoryInfo: function() {
                return EnhancedSystemMonitor.getMemoryInfo();
            },
            
            // 获取存储信息
            getStorageInfo: function() {
                return EnhancedSystemMonitor.getSimulatedStorageInfo();
            },
            
            // 获取网络信息
            getNetworkInfo: function() {
                return EnhancedSystemMonitor.getNetworkInfo();
            },
            
            // 获取系统信息
            getSystemInfo: function() {
                return EnhancedSystemMonitor.getSystemInfo();
            },
            
            // 获取进程列表（模拟）
            getProcessList: function() {
                const processNames = [
                    "systemd", "bash", "chrome", "firefox", "node", "python",
                    "mysql", "nginx", "docker", "vscode", "spotify", "discord",
                    "sshd", "cron", "syslog", "network", "docker", "postgres"
                ];
                
                if (processList.length === 0) {
                    // 生成初始进程列表
                    processList = processNames.map((name, index) => {
                        const pid = 1000 + index;
                        const cpu = (Math.random() * 20).toFixed(1);
                        const memory = (Math.random() * 5).toFixed(1);
                        const status = Math.random() > 0.8 ? "睡眠" : "运行";
                        
                        return {
                            name: name,
                            pid: pid,
                            cpu: parseFloat(cpu),
                            memory: parseFloat(memory),
                            status: status,
                            icon: this.getProcessIcon(name)
                        };
                    });
                } else {
                    // 更新进程数据
                    processList = processList.map(process => {
                        // 随机变化CPU和内存使用率
                        const cpuChange = (Math.random() - 0.5) * 5;
                        const memoryChange = (Math.random() - 0.5) * 0.5;
                        
                        let newCpu = process.cpu + cpuChange;
                        let newMemory = process.memory + memoryChange;
                        
                        // 确保值在合理范围内
                        newCpu = Math.max(0.1, Math.min(50, newCpu));
                        newMemory = Math.max(0.1, Math.min(10, newMemory));
                        
                        // 随机改变状态
                        let newStatus = process.status;
                        if (Math.random() < 0.1) {
                            newStatus = Math.random() > 0.5 ? "运行" : "睡眠";
                        }
                        
                        return {
                            ...process,
                            cpu: newCpu,
                            memory: newMemory,
                            status: newStatus
                        };
                    });
                }
                
                return processList;
            },
            
            // 根据进程名获取图标
            getProcessIcon: function(processName) {
                const icons = {
                    "systemd": "fas fa-cogs",
                    "bash": "fas fa-terminal",
                    "chrome": "fab fa-chrome",
                    "firefox": "fab fa-firefox",
                    "node": "fab fa-node-js",
                    "python": "fab fa-python",
                    "mysql": "fas fa-database",
                    "nginx": "fas fa-server",
                    "docker": "fab fa-docker",
                    "vscode": "fas fa-code",
                    "spotify": "fab fa-spotify",
                    "discord": "fab fa-discord",
                    "sshd": "fas fa-shield-alt",
                    "cron": "fas fa-clock",
                    "syslog": "fas fa-file-alt",
                    "network": "fas fa-network-wired",
                    "postgres": "fas fa-database"
                };
                
                return icons[processName] || "fas fa-cog";
            },
            
            // 获取文件列表（模拟）
            getFileList: function(directory) {
                const fileLists = {
                    'home': [
                        {name: '文档', type: 'folder', size: '2.4 GB', modified: '2023-10-15'},
                        {name: '下载', type: 'folder', size: '5.7 GB', modified: '2023-10-20'},
                        {name: '图片', type: 'folder', size: '12.3 GB', modified: '2023-10-18'},
                        {name: '音乐', type: 'folder', size: '8.9 GB', modified: '2023-10-12'},
                        {name: '桌面', type: 'folder', size: '1.2 GB', modified: '2023-10-22'},
                        {name: 'system_log.txt', type: 'file', size: '4.2 MB', modified: '2023-10-22'},
                        {name: 'config.yaml', type: 'file', size: '128 KB', modified: '2023-10-21'},
                        {name: 'readme.md', type: 'file', size: '12 KB', modified: '2023-10-20'}
                    ],
                    'documents': [
                        {name: '工作报告.docx', type: 'file', size: '2.1 MB', modified: '2023-10-22'},
                        {name: '项目计划.pdf', type: 'file', size: '3.4 MB', modified: '2023-10-20'},
                        {name: '笔记.txt', type: 'file', size: '45 KB', modified: '2023-10-19'},
                        {name: '数据库设计.sql', type: 'file', size: '128 KB', modified: '2023-10-18'},
                        {name: '代码', type: 'folder', size: '156 MB', modified: '2023-10-22'},
                        {name: '图片', type: 'folder', size: '45 MB', modified: '2023-10-17'}
                    ],
                    'downloads': [
                        {name: 'installer.exe', type: 'file', size: '45 MB', modified: '2023-10-22'},
                        {name: 'ubuntu.iso', type: 'file', size: '2.8 GB', modified: '2023-10-20'},
                        {name: 'document.pdf', type: 'file', size: '3.2 MB', modified: '2023-10-19'},
                        {name: '软件包', type: 'folder', size: '1.2 GB', modified: '2023-10-18'},
                        {name: '图片', type: 'folder', size: '345 MB', modified: '2023-10-17'}
                    ],
                    'desktop': [
                        {name: '回收站', type: 'folder', size: '2.4 GB', modified: '2023-10-22'},
                        {name: 'NeoSystem.lnk', type: 'file', size: '2 KB', modified: '2023-10-22'},
                        {name: '浏览器.lnk', type: 'file', size: '2 KB', modified: '2023-10-21'},
                        {name: '终端.lnk', type: 'file', size: '2 KB', modified: '2023-10-20'},
                        {name: '临时文件', type: 'folder', size: '456 MB', modified: '2023-10-19'}
                    ]
                };
                
                return fileLists[directory] || fileLists['home'];
            },
            
            // 获取目录列表
            getDirectoryList: function() {
                return [
                    {id: 'home', name: '主目录', icon: 'fas fa-home'},
                    {id: 'desktop', name: '桌面', icon: 'fas fa-desktop'},
                    {id: 'documents', name: '文档', icon: 'fas fa-folder'},
                    {id: 'downloads', name: '下载', icon: 'fas fa-download'},
                    {id: 'pictures', name: '图片', icon: 'fas fa-image'},
                    {id: 'music', name: '音乐', icon: 'fas fa-music'},
                    {id: 'system', name: '系统文件', icon: 'fas fa-cog'},
                    {id: 'logs', name: '系统日志', icon: 'fas fa-file-alt'}
                ];
            },
            
            // Ping测试（模拟）
            pingTest: function(host) {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        const latency = Math.floor(Math.random() * 100) + 10;
                        const packetLoss = Math.random() < 0.1 ? Math.floor(Math.random() * 30) : 0;
                        
                        let result = `正在 Ping ${host} 具有 32 字节的数据:\n\n`;
                        for (let i = 0; i < 4; i++) {
                            const time = Math.floor(Math.random() * 50) + latency;
                            result += `来自 ${host} 的回复: 字节=32 时间=${time}ms TTL=54\n`;
                        }
                        
                        result += `\n${host} 的 Ping 统计信息:\n`;
                        result += `    数据包: 已发送 = 4，已接收 = ${packetLoss > 0 ? 4 - Math.floor(packetLoss/100*4) : 4}，丢失 = ${packetLoss > 0 ? Math.floor(packetLoss/100*4) : 0} (${packetLoss}% 丢失)，\n`;
                        result += `往返行程的估计时间(以毫秒为单位):\n`;
                        result += `    最短 = ${latency}ms，最长 = ${latency + 30}ms，平均 = ${latency + 15}ms`;
                        
                        resolve(result);
                    }, 1000);
                });
            },
            
            // 路由追踪（模拟）
            tracerouteTest: function(host) {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        let result = `到 ${host} 的路由追踪，最多 30 个跃点:\n\n`;
                        
                        const hops = Math.floor(Math.random() * 15) + 8;
                        for (let i = 1; i <= hops; i++) {
                            const time1 = Math.floor(Math.random() * 50) + 10;
                            const time2 = Math.floor(Math.random() * 50) + 10;
                            const time3 = Math.floor(Math.random() * 50) + 10;
                            
                            if (i === hops) {
                                result += `${i}    *        *        *     请求超时。\n`;
                            } else {
                                const ip = `192.168.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}`;
                                result += `${i}    ${time1} ms   ${time2} ms   ${time3} ms  ${ip}\n`;
                            }
                        }
                        
                        result += `\n跟踪完成。`;
                        
                        resolve(result);
                    }, 1500);
                });
            },
            
            // 端口扫描（模拟）
            portScan: function(host, portRange) {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        const [start, end] = portRange.split('-').map(Number);
                        const range = end - start + 1;
                        const openPorts = [];
                        
                        // 随机选择一些端口为开放状态
                        for (let port = start; port <= end; port++) {
                            if (Math.random() < 0.05) { // 5%的端口开放
                                openPorts.push(port);
                            }
                        }
                        
                        let result = `正在扫描 ${host} [端口 ${start}-${end}]\n`;
                        result += `发现 ${openPorts.length} 个开放端口\n\n`;
                        
                        if (openPorts.length > 0) {
                            result += "端口     服务           状态\n";
                            result += "----     -------       ------\n";
                            
                            const services = ["HTTP", "HTTPS", "SSH", "FTP", "SMTP", "DNS", "MySQL", "RDP"];
                            
                            openPorts.forEach(port => {
                                const service = services[Math.floor(Math.random() * services.length)];
                                result += `${port}       ${service}         开放\n`;
                            });
                        }
                        
                        result += `\n扫描完成: ${range} 个端口扫描完成，${openPorts.length} 个端口开放`;
                        
                        resolve(result);
                    }, 2000);
                });
            },
            
            // 网速测试（模拟）
            speedTest: function(type) {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        let result = "";
                        const downloadSpeed = (Math.random() * 80 + 20).toFixed(1);
                        const uploadSpeed = (Math.random() * 30 + 5).toFixed(1);
                        const latency = Math.floor(Math.random() * 50) + 10;
                        
                        if (type === 'download' || type === 'both') {
                            result += `下载速度: ${downloadSpeed} Mbps\n`;
                        }
                        
                        if (type === 'upload' || type === 'both') {
                            result += `上传速度: ${uploadSpeed} Mbps\n`;
                        }
                        
                        result += `延迟: ${latency} ms\n`;
                        result += `抖动: ${(Math.random() * 10).toFixed(1)} ms\n`;
                        result += `数据包丢失: ${(Math.random() * 2).toFixed(1)} %`;
                        
                        resolve(result);
                    }, 3000);
                });
            },
            
            // 安全扫描（模拟）
            securityScan: function() {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        const issues = Math.floor(Math.random() * 5);
                        let result = "安全扫描完成\n";
                        result += `扫描时间: ${new Date().toLocaleTimeString()}\n`;
                        result += `扫描项目: 42\n`;
                        result += `发现问题: ${issues}\n\n`;
                        
                        if (issues === 0) {
                            result += "✓ 系统安全状态良好\n";
                            result += "✓ 未发现安全威胁\n";
                            result += "✓ 建议定期更新系统\n";
                        } else {
                            result += "发现以下安全问题:\n";
                            result += "1. 发现过时的软件包\n";
                            result += "2. 存在弱密码账户\n";
                            result += "3. 防火墙规则需要更新\n";
                            result += "\n建议立即修复这些问题。\n";
                        }
                        
                        resolve(result);
                    }, 4000);
                });
            },
            
            // 漏洞扫描（模拟）
            vulnerabilityScan: function() {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        const vulnerabilities = Math.floor(Math.random() * 8);
                        let result = "漏洞扫描报告\n";
                        result += `扫描时间: ${new Date().toLocaleDateString()}\n`;
                        result += `发现漏洞: ${vulnerabilities}\n`;
                        result += `严重级别: ${vulnerabilities > 5 ? "高" : vulnerabilities > 2 ? "中" : "低"}\n\n`;
                        
                        if (vulnerabilities === 0) {
                            result += "✓ 未发现已知漏洞\n";
                            result += "✓ 系统保持最新状态\n";
                        } else {
                            result += "发现的漏洞:\n";
                            for (let i = 1; i <= vulnerabilities; i++) {
                                result += `${i}. CVE-2023-${Math.floor(Math.random() * 9000) + 1000} - 安全漏洞\n`;
                            }
                            result += "\n建议立即安装安全更新。\n";
                        }
                        
                        resolve(result);
                    }, 3500);
                });
            },
            
            // 恶意软件扫描（模拟）
            malwareScan: function() {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        const threats = Math.floor(Math.random() * 3);
                        let result = "恶意软件扫描报告\n";
                        result += `扫描时间: ${new Date().toLocaleTimeString()}\n`;
                        result += `扫描文件: ${Math.floor(Math.random() * 10000) + 5000}\n`;
                        result += `发现威胁: ${threats}\n\n`;
                        
                        if (threats === 0) {
                            result += "✓ 未检测到恶意软件\n";
                            result += "✓ 系统清洁\n";
                        } else {
                            result += "检测到的威胁:\n";
                            result += "1. Trojan.Generic.123456 - 已隔离\n";
                            result += "2. PUP.Optional.BundleInstaller - 已修复\n";
                            result += "\n所有威胁已被成功处理。\n";
                        }
                        
                        resolve(result);
                    }, 5000);
                });
            }
        };
        
        // 初始化图书馆
        function initLibrary() {
            // 渲染语言列表
            renderLanguageList();
            
            // 默认显示第一个语言
            if (programmingLanguages.length > 0) {
                showLanguageDetail(programmingLanguages[0]);
            }
            
            // 搜索功能
            const searchInput = document.getElementById('library-search');
            const searchBtn = document.getElementById('library-search-btn');
            
            searchBtn.addEventListener('click', () => {
                const searchTerm = searchInput.value.toLowerCase();
                filterLanguages(searchTerm);
            });
            
            searchInput.addEventListener('keyup', (e) => {
                if (e.key === 'Enter') {
                    const searchTerm = searchInput.value.toLowerCase();
                    filterLanguages(searchTerm);
                }
            });
            
            // 分类筛选
            const categoryBtns = document.querySelectorAll('.category-btn');
            categoryBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    // 更新活动按钮
                    categoryBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    
                    const category = btn.getAttribute('data-category');
                    filterByCategory(category);
                });
            });
        }
        
        // 渲染语言列表
        function renderLanguageList(filteredLanguages = programmingLanguages) {
            const languageList = document.getElementById('language-list');
            languageList.innerHTML = '';
            
            filteredLanguages.forEach(lang => {
                const listItem = document.createElement('li');
                listItem.className = `language-item ${currentLanguage && currentLanguage.id === lang.id ? 'active' : ''}`;
                listItem.setAttribute('data-language', lang.id);
                
                listItem.innerHTML = `
                    <div class="language-icon" style="background-color: ${lang.iconColor}">
                        <i class="fas fa-code"></i>
                    </div>
                    <div class="language-info">
                        <div class="language-name">${lang.name}</div>
                        <div class="language-type">${lang.category.join(', ')}</div>
                    </div>
                `;
                
                listItem.addEventListener('click', () => {
                    showLanguageDetail(lang);
                    
                    // 更新活动状态
                    document.querySelectorAll('.language-item').forEach(item => {
                        item.classList.remove('active');
                    });
                    listItem.classList.add('active');
                });
                
                languageList.appendChild(listItem);
            });
        }
        
        // 显示语言详情
        function showLanguageDetail(language) {
            currentLanguage = language;
            const detailContainer = document.getElementById('language-detail');
            
            // 构建代码示例HTML
            let codeExamplesHTML = '';
            if (language.codeExamples && language.codeExamples.length > 0) {
                codeExamplesHTML = `
                    <div class="language-detail-section">
                        <h3 class="section-title">代码示例</h3>
                        <div class="code-tabs" id="code-tabs-${language.id}">
                            ${language.codeExamples.map((example, index) => `
                                <div class="code-tab ${index === 0 ? 'active' : ''}" data-example-index="${index}">
                                    ${example.title}
                                </div>
                            `).join('')}
                        </div>
                        <div id="code-examples-${language.id}">
                            ${language.codeExamples.map((example, index) => `
                                <div class="code-example" style="display: ${index === 0 ? 'block' : 'none'};">
                                    <div class="code-example-title">${example.title}</div>
                                    <pre><code class="language-${language.id === 'javascript' || language.id === 'typescript' ? 'javascript' : language.id}">${example.code}</code></pre>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }
            
            // 构建特性HTML
            let featuresHTML = '';
            if (language.features && language.features.length > 0) {
                featuresHTML = `
                    <div class="language-detail-section">
                        <h3 class="section-title">主要特性</h3>
                        <div class="language-features">
                            ${language.features.map(feature => `
                                <div class="feature-item">
                                    <div class="feature-title">${feature.title}</div>
                                    <div>${feature.description}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }
            
            // 构建使用场景HTML
            let useCasesHTML = '';
            if (language.useCases && language.useCases.length > 0) {
                useCasesHTML = `
                    <div class="language-detail-section">
                        <h3 class="section-title">主要应用场景</h3>
                        <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                            ${language.useCases.map(useCase => `
                                <span style="padding: 5px 10px; background-color: rgba(255, 204, 0, 0.1); border-radius: 4px; color: var(--library-color);">
                                    ${useCase}
                                </span>
                            `).join('')}
                        </div>
                    </div>
                `;
            }
            
            // 构建资源链接HTML
            let resourcesHTML = '';
            if (language.resources && language.resources.length > 0) {
                resourcesHTML = `
                    <div class="language-detail-section">
                        <h3 class="section-title">学习资源</h3>
                        <div class="resource-links">
                            ${language.resources.map(resource => `
                                <a href="${resource.url}" target="_blank" class="resource-link">
                                    <i class="fas fa-external-link-alt"></i>
                                    ${resource.name}
                                </a>
                            `).join('')}
                        </div>
                    </div>
                `;
            }
            
            detailContainer.innerHTML = `
                <div class="language-detail-header">
                    <div class="language-detail-icon" style="background-color: ${language.iconColor}">
                        <i class="fas fa-code"></i>
                    </div>
                    <div class="language-detail-info">
                        <h2 class="language-detail-name">${language.name}</h2>
                        <div class="language-detail-meta">
                            <span><i class="fas fa-calendar-alt"></i> ${language.year}年发布</span>
                            <span><i class="fas fa-user"></i> ${language.creator}</span>
                            <span><i class="fas fa-tags"></i> ${language.category.join(', ')}</span>
                        </div>
                    </div>
                </div>
                
                <div class="language-detail-content">
                    <div class="language-detail-section">
                        <h3 class="section-title">语言简介</h3>
                        <p class="language-description">${language.description}</p>
                    </div>
                    
                    ${featuresHTML}
                    ${useCasesHTML}
                    ${codeExamplesHTML}
                    ${resourcesHTML}
                </div>
            `;
            
            // 重新高亮代码
            hljs.highlightAll();
            
            // 添加代码选项卡交互
            if (language.codeExamples && language.codeExamples.length > 0) {
                const codeTabs = document.getElementById(`code-tabs-${language.id}`).querySelectorAll('.code-tab');
                const codeExamples = document.getElementById(`code-examples-${language.id}`).querySelectorAll('.code-example');
                
                codeTabs.forEach((tab, index) => {
                    tab.addEventListener('click', () => {
                        // 更新活动选项卡
                        codeTabs.forEach(t => t.classList.remove('active'));
                        tab.classList.add('active');
                        
                        // 显示对应的代码示例
                        codeExamples.forEach(example => {
                            example.style.display = 'none';
                        });
                        codeExamples[index].style.display = 'block';
                    });
                });
            }
            
            // 滚动到顶部
            detailContainer.scrollTop = 0;
            
            // 显示通知
            showNotification("语言详情", `已加载 ${language.name} 的详细信息`, 3000);
        }
        
        // 过滤语言
        function filterLanguages(searchTerm) {
            if (!searchTerm.trim()) {
                renderLanguageList();
                return;
            }
            
            const filtered = programmingLanguages.filter(lang => {
                return lang.name.toLowerCase().includes(searchTerm) ||
                       lang.category.some(cat => cat.includes(searchTerm)) ||
                       lang.description.toLowerCase().includes(searchTerm);
            });
            
            renderLanguageList(filtered);
            
            if (filtered.length > 0) {
                showLanguageDetail(filtered[0]);
            } else {
                const detailContainer = document.getElementById('language-detail');
                detailContainer.innerHTML = `
                    <div style="text-align: center; padding: 50px;">
                        <i class="fas fa-search" style="font-size: 3rem; color: var(--text-secondary); margin-bottom: 20px;"></i>
                        <h3 style="color: var(--library-color);">未找到相关语言</h3>
                        <p style="color: var(--text-secondary); margin-top: 10px;">
                            没有找到与"${searchTerm}"相关的编程语言
                        </p>
                    </div>
                `;
            }
            
            // 显示搜索结果通知
            showNotification("搜索结果", `找到 ${filtered.length} 个相关语言`, 3000);
        }
        
        // 按分类过滤
        function filterByCategory(category) {
            if (category === 'all') {
                renderLanguageList();
                if (programmingLanguages.length > 0) {
                    showLanguageDetail(programmingLanguages[0]);
                }
                return;
            }
            
            const filtered = programmingLanguages.filter(lang => 
                lang.category.includes(category)
            );
            
            renderLanguageList(filtered);
            
            if (filtered.length > 0) {
                showLanguageDetail(filtered[0]);
            } else {
                const detailContainer = document.getElementById('language-detail');
                detailContainer.innerHTML = `
                    <div style="text-align: center; padding: 50px;">
                        <i class="fas fa-folder" style="font-size: 3rem; color: var(--text-secondary); margin-bottom: 20px;"></i>
                        <h3 style="color: var(--library-color);">分类为空</h3>
                        <p style="color: var(--text-secondary); margin-top: 10px;">
                            "${category}"分类下暂无编程语言
                        </p>
                    </div>
                `;
            }
            
            // 显示分类通知
            showNotification("分类筛选", `显示 ${category} 分类下的语言 (${filtered.length}个)`, 3000);
        }
        
        // 初始化游戏
        function initGames() {
            // 初始化CPS游戏
            initCPSGame();
            
            // 初始化打字游戏
            initTypingGame();
            
            // 初始化知识测验
            initQuizGame();
            
            // 游戏分类筛选
            const gameCategoryBtns = document.querySelectorAll('.game-category-btn');
            gameCategoryBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    // 更新活动按钮
                    gameCategoryBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    
                    const category = btn.getAttribute('data-category');
                    filterGamesByCategory(category);
                });
            });
            
            // 加载游戏数据
            loadQuizQuestions();
        }
        
        // 初始化CPS游戏
        function initCPSGame() {
            const cpsButton = document.getElementById('cps-button');
            const cpsResetBtn = document.getElementById('cps-reset-btn');
            const cpsDisplay = document.getElementById('cps-display');
            const cpsTimer = document.getElementById('cps-timer');
            const cpsHighscore = document.getElementById('cps-highscore');
            const cpsTotalClicks = document.getElementById('cps-total-clicks');
            const cpsAverage = document.getElementById('cps-average');
            
            // 从本地存储加载最高分
            const savedHighscore = localStorage.getItem('neosystem_cps_highscore');
            if (savedHighscore) {
                cpsGame.highScore = parseFloat(savedHighscore);
                cpsHighscore.textContent = cpsGame.highScore.toFixed(1);
            }
            
            const savedTotalClicks = localStorage.getItem('neosystem_cps_totalclicks');
            if (savedTotalClicks) {
                cpsGame.totalClicks = parseInt(savedTotalClicks);
                cpsTotalClicks.textContent = cpsGame.totalClicks;
            }
            
            const savedAverage = localStorage.getItem('neosystem_cps_average');
            if (savedAverage) {
                cpsGame.averageCPS = parseFloat(savedAverage);
                cpsAverage.textContent = cpsGame.averageCPS.toFixed(1);
            }
            
            // 开始CPS游戏
            cpsButton.addEventListener('click', function() {
                if (cpsGame.isRunning) {
                    // 游戏进行中，增加点击计数
                    cpsGame.clickCount++;
                    
                    // 更新显示
                    const elapsedTime = (Date.now() - cpsGame.startTime) / 1000;
                    const currentCPS = cpsGame.clickCount / elapsedTime;
                    cpsDisplay.textContent = currentCPS.toFixed(1);
                    
                    // 更新按钮文本
                    this.textContent = `点击！ (${cpsGame.clickCount})`;
                    
                    // 更新最高分
                    if (currentCPS > cpsGame.highScore) {
                        cpsGame.highScore = currentCPS;
                        cpsHighscore.textContent = cpsGame.highScore.toFixed(1);
                        localStorage.setItem('neosystem_cps_highscore', cpsGame.highScore.toFixed(1));
                    }
                } else {
                    // 开始新游戏
                    cpsGame.isRunning = true;
                    cpsGame.startTime = Date.now();
                    cpsGame.clickCount = 0;
                    cpsGame.timeLeft = 10;
                    
                    // 更新显示
                    cpsDisplay.textContent = "0.0";
                    cpsTimer.textContent = "10.0 秒";
                    this.textContent = "点击！ (0)";
                    this.classList.remove('disabled');
                    
                    // 启动计时器
                    cpsGame.timer = setInterval(() => {
                        cpsGame.timeLeft -= 0.1;
                        
                        if (cpsGame.timeLeft <= 0) {
                            // 游戏结束
                            endCPSGame();
                        } else {
                            // 更新计时器显示
                            cpsTimer.textContent = cpsGame.timeLeft.toFixed(1) + " 秒";
                        }
                    }, 100);
                }
            });
            
            // 重置游戏
            cpsResetBtn.addEventListener('click', function() {
                if (cpsGame.isRunning) {
                    endCPSGame();
                }
                
                cpsGame.isRunning = false;
                cpsGame.clickCount = 0;
                cpsGame.timeLeft = 10;
                
                cpsDisplay.textContent = "0.0";
                cpsTimer.textContent = "准备开始";
                cpsButton.textContent = "点击开始！";
                cpsButton.classList.remove('disabled');
                
                clearInterval(cpsGame.timer);
            });
            
            // 结束CPS游戏
            function endCPSGame() {
                clearInterval(cpsGame.timer);
                
                cpsGame.isRunning = false;
                cpsButton.textContent = "游戏结束！";
                cpsButton.classList.add('disabled');
                
                // 计算最终CPS
                const finalCPS = cpsGame.clickCount / 10;
                cpsDisplay.textContent = finalCPS.toFixed(1);
                cpsTimer.textContent = "测试完成！";
                
                // 更新统计数据
                cpsGame.totalClicks += cpsGame.clickCount;
                cpsTotalClicks.textContent = cpsGame.totalClicks;
                
                // 计算平均CPS
                const totalGames = Math.ceil(cpsGame.totalClicks / 10); // 估算游戏次数
                if (totalGames > 0) {
                    cpsGame.averageCPS = cpsGame.totalClicks / (totalGames * 10);
                    cpsAverage.textContent = cpsGame.averageCPS.toFixed(1);
                }
                
                // 保存到本地存储
                localStorage.setItem('neosystem_cps_totalclicks', cpsGame.totalClicks);
                localStorage.setItem('neosystem_cps_average', cpsGame.averageCPS.toFixed(1));
                
                // 显示结果通知
                showNotification("CPS测试完成", `你的CPS: ${finalCPS.toFixed(1)} | 最高CPS: ${cpsGame.highScore.toFixed(1)}`, 5000);
            }
        }
        
        // 初始化打字游戏
        function initTypingGame() {
            const typingStartBtn = document.getElementById('typing-start-btn');
            const typingInput = document.getElementById('typing-input');
            const typingText = document.getElementById('typing-text');
            const typingWPM = document.getElementById('typing-wpm');
            const typingAccuracy = document.getElementById('typing-accuracy');
            const typingTime = document.getElementById('typing-time');
            
            // 打字测试文本
            const typingTexts = [
                "NeoSystem是一个高级系统监控终端，提供实时系统监控、网络工具、安全扫描和AI助手功能。",
                "JavaScript是一种高级的、解释型的编程语言，用于为网页添加交互功能，是Web开发的核心技术之一。",
                "Python以其清晰的语法和代码可读性而闻名，支持多种编程范式，广泛应用于数据科学和人工智能领域。",
                "在计算机系统中，CPU是中央处理器的缩写，负责执行程序指令，是计算机的大脑和核心部件。",
                "网络安全是保护计算机网络免受攻击、损坏或未授权访问的实践，包括防火墙、加密和访问控制等措施。",
                "人工智能是计算机科学的一个分支，致力于创建能够执行通常需要人类智能的任务的智能机器和软件。"
            ];
            
            // 开始打字游戏
            typingStartBtn.addEventListener('click', function() {
                if (typingGame.isRunning) return;
                
                typingGame.isRunning = true;
                typingGame.startTime = Date.now();
                typingGame.timeLeft = 60;
                typingGame.currentText = typingTexts[Math.floor(Math.random() * typingTexts.length)];
                typingGame.typedText = '';
                typingGame.correctChars = 0;
                typingGame.totalChars = 0;
                typingGame.wpm = 0;
                typingGame.accuracy = 100;
                
                // 更新显示
                typingText.innerHTML = '';
                typingGame.currentText.split('').forEach(char => {
                    const span = document.createElement('span');
                    span.textContent = char;
                    typingText.appendChild(span);
                });
                
                // 启用输入框
                typingInput.value = '';
                typingInput.disabled = false;
                typingInput.focus();
                
                // 更新统计显示
                typingWPM.textContent = '0';
                typingAccuracy.textContent = '100%';
                typingTime.textContent = '60s';
                
                // 更新按钮文本
                this.textContent = '游戏中...';
                this.disabled = true;
                
                // 启动计时器
                typingGame.timer = setInterval(() => {
                    typingGame.timeLeft--;
                    
                    if (typingGame.timeLeft <= 0) {
                        endTypingGame();
                    } else {
                        // 更新计时器显示
                        typingTime.textContent = typingGame.timeLeft + 's';
                        
                        // 计算WPM
                        const elapsedMinutes = (60 - typingGame.timeLeft) / 60;
                        if (elapsedMinutes > 0) {
                            const words = typingGame.typedText.trim().split(/\s+/).length;
                            typingGame.wpm = Math.round(words / elapsedMinutes);
                            typingWPM.textContent = typingGame.wpm;
                        }
                    }
                }, 1000);
                
                showNotification("打字测试开始", "你有60秒时间输入文本。尽量快速而准确地打字！", 3000);
            });
            
            // 输入事件
            typingInput.addEventListener('input', function() {
                if (!typingGame.isRunning) return;
                
                const inputText = this.value;
                typingGame.typedText = inputText;
                typingGame.totalChars = inputText.length;
                
                // 计算正确字符数
                let correct = 0;
                const textSpans = typingText.querySelectorAll('span');
                
                textSpans.forEach((span, index) => {
                    // 重置样式
                    span.className = '';
                    
                    if (index < inputText.length) {
                        if (inputText[index] === span.textContent) {
                            span.classList.add('typing-correct');
                            correct++;
                        } else {
                            span.classList.add('typing-incorrect');
                        }
                    } else if (index === inputText.length) {
                        span.classList.add('typing-current');
                    }
                });
                
                typingGame.correctChars = correct;
                
                // 计算准确率
                if (typingGame.totalChars > 0) {
                    typingGame.accuracy = Math.round((typingGame.correctChars / typingGame.totalChars) * 100);
                    typingAccuracy.textContent = typingGame.accuracy + '%';
                }
                
                // 检查是否已完成输入
                if (inputText.length >= typingGame.currentText.length) {
                    endTypingGame();
                }
            });
            
            // 结束打字游戏
            function endTypingGame() {
                clearInterval(typingGame.timer);
                
                typingGame.isRunning = false;
                typingInput.disabled = true;
                typingStartBtn.textContent = '开始打字测试';
                typingStartBtn.disabled = false;
                
                // 计算最终WPM
                const elapsedMinutes = (60 - typingGame.timeLeft) / 60;
                const words = typingGame.typedText.trim().split(/\s+/).length;
                typingGame.wpm = elapsedMinutes > 0 ? Math.round(words / elapsedMinutes) : 0;
                
                // 更新显示
                typingWPM.textContent = typingGame.wpm;
                typingAccuracy.textContent = typingGame.accuracy + '%';
                typingTime.textContent = '0s';
                
                // 显示结果通知
                showNotification("打字测试完成", `WPM: ${typingGame.wpm} | 准确率: ${typingGame.accuracy}%`, 5000);
            }
        }
        
        // 初始化知识测验
        function initQuizGame() {
            const quizStartBtn = document.getElementById('quiz-start-btn');
            const quizQuestionText = document.getElementById('quiz-question-text');
            const quizOptions = document.getElementById('quiz-options');
            const quizScore = document.getElementById('quiz-score');
            const quizQuestion = document.getElementById('quiz-question');
            const quizTimer = document.getElementById('quiz-timer');
            
            // 开始测验
            quizStartBtn.addEventListener('click', function() {
                if (quizGame.isRunning) return;
                
                quizGame.isRunning = true;
                quizGame.currentQuestion = 0;
                quizGame.score = 0;
                quizGame.timeLeft = 30;
                
                // 更新显示
                quizScore.textContent = '0';
                quizQuestion.textContent = '1/10';
                quizTimer.textContent = '30s';
                quizStartBtn.textContent = '测验中...';
                quizStartBtn.disabled = true;
                
                // 显示第一个问题
                showQuizQuestion();
                
                // 启动计时器
                quizGame.timer = setInterval(() => {
                    quizGame.timeLeft--;
                    
                    if (quizGame.timeLeft <= 0) {
                        // 时间到，自动跳过
                        nextQuizQuestion();
                    } else {
                        quizTimer.textContent = quizGame.timeLeft + 's';
                    }
                }, 1000);
                
                showNotification("知识测验开始", "你有30秒时间回答每个问题。测试你的系统知识！", 3000);
            });
            
            // 显示测验问题
            function showQuizQuestion() {
                if (quizGame.currentQuestion >= quizGame.questions.length) {
                    endQuizGame();
                    return;
                }
                
                const question = quizGame.questions[quizGame.currentQuestion];
                quizQuestionText.textContent = question.question;
                quizQuestion.textContent = `${quizGame.currentQuestion + 1}/10`;
                
                // 清空选项
                quizOptions.innerHTML = '';
                
                // 添加选项
                question.options.forEach((option, index) => {
                    const button = document.createElement('button');
                    button.className = 'btn';
                    button.style.width = '100%';
                    button.style.marginBottom = '10px';
                    button.style.textAlign = 'left';
                    button.textContent = `${String.fromCharCode(65 + index)}. ${option}`;
                    
                    button.addEventListener('click', function() {
                        if (question.correct === index) {
                            quizGame.score++;
                            quizScore.textContent = quizGame.score;
                            showNotification("回答正确", "恭喜你答对了！", 2000);
                        } else {
                            showNotification("回答错误", `正确答案是: ${String.fromCharCode(65 + question.correct)}`, 3000);
                        }
                        
                        nextQuizQuestion();
                    });
                    
                    quizOptions.appendChild(button);
                });
            }
            
            // 下一个问题
            function nextQuizQuestion() {
                quizGame.currentQuestion++;
                quizGame.timeLeft = 30;
                quizTimer.textContent = '30s';
                
                if (quizGame.currentQuestion < quizGame.questions.length) {
                    showQuizQuestion();
                } else {
                    endQuizGame();
                }
            }
            
            // 结束测验
            function endQuizGame() {
                clearInterval(quizGame.timer);
                
                quizGame.isRunning = false;
                quizStartBtn.textContent = '开始测验';
                quizStartBtn.disabled = false;
                
                // 显示结果
                quizQuestionText.textContent = `测验完成！你的得分: ${quizGame.score}/10`;
                quizOptions.innerHTML = '';
                quizTimer.textContent = '--';
                
                // 显示结果通知
                const percentage = (quizGame.score / 10) * 100;
                let message = '';
                if (percentage >= 90) message = "优秀！你是系统专家！";
                else if (percentage >= 70) message = "很好！你对系统知识有很好的了解。";
                else if (percentage >= 50) message = "不错！继续学习系统知识。";
                else message = "加油！建议多学习系统相关知识。";
                
                showNotification("测验完成", `得分: ${quizGame.score}/10 (${percentage}%) - ${message}`, 6000);
            }
        }
        
        // 加载测验问题
        function loadQuizQuestions() {
            quizGame.questions = [
                {
                    question: "CPU是什么的缩写？",
                    options: ["中央处理器", "计算机处理单元", "核心处理单元", "中央处理单元"],
                    correct: 0
                },
                {
                    question: "以下哪个不是操作系统？",
                    options: ["Windows", "Linux", "Photoshop", "macOS"],
                    correct: 2
                },
                {
                    question: "HTTP默认端口号是多少？",
                    options: ["80", "443", "21", "25"],
                    correct: 0
                },
                {
                    question: "以下哪个是脚本语言？",
                    options: ["Python", "C++", "Java", "Go"],
                    correct: 0
                },
                {
                    question: "RAM是什么的缩写？",
                    options: ["随机存取存储器", "只读存储器", "运行内存", "快速存储器"],
                    correct: 0
                },
                {
                    question: "以下哪个是关系型数据库？",
                    options: ["MySQL", "MongoDB", "Redis", "Elasticsearch"],
                    correct: 0
                },
                {
                    question: "IP地址的IPv4版本有多少位？",
                    options: ["32", "64", "128", "256"],
                    correct: 0
                },
                {
                    question: "以下哪个协议用于安全网页浏览？",
                    options: ["HTTPS", "HTTP", "FTP", "SMTP"],
                    correct: 0
                },
                {
                    question: "JavaScript主要用于什么？",
                    options: ["网页交互", "系统编程", "移动应用", "数据科学"],
                    correct: 0
                },
                {
                    question: "以下哪个是防火墙的主要功能？",
                    options: ["网络安全", "病毒扫描", "数据备份", "性能优化"],
                    correct: 0
                }
            ];
        }
        
        // 按分类过滤游戏
        function filterGamesByCategory(category) {
            const gameCards = document.querySelectorAll('.game-card');
            
            gameCards.forEach(card => {
                const cardCategory = card.getAttribute('data-category');
                
                if (category === 'all' || cardCategory === category) {
                    card.style.display = 'flex';
                } else {
                    card.style.display = 'none';
                }
            });
            
            showNotification("游戏筛选", `显示 ${category} 分类的游戏`, 3000);
        }
        
        // 页面切换功能
        function initPageNavigation() {
            const navItems = document.querySelectorAll('.nav-item');
            
            navItems.forEach(item => {
                item.addEventListener('click', function() {
                    const pageId = this.getAttribute('data-page');
                    
                    // 更新活动状态
                    navItems.forEach(nav => nav.classList.remove('active'));
                    this.classList.add('active');
                    
                    // 切换页面
                    switchPage(pageId);
                });
            });
        }
        
        // 切换页面
        function switchPage(pageId) {
            // 隐藏所有页面
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // 显示目标页面
            const targetPage = document.getElementById(`${pageId}-page`);
            if (targetPage) {
                targetPage.classList.add('active');
                currentPage = pageId;
                
                // 更新页面标题
                const pageTitles = {
                    'dashboard': '系统仪表板',
                    'monitor': '系统监控',
                    'network': '网络工具',
                    'process': '进程管理',
                    'files': '文件管理',
                    'security': '安全扫描',
                    'library': '编程语言图书馆',
                    'ai': 'AI助手',
                    'games': '系统小游戏',
                    'worldmap': '全球网络监控地图',
                    'settings': '系统设置'
                };
                
                document.getElementById('current-page-title').textContent = pageTitles[pageId] || '未知页面';
                
                // 如果是图书馆页面，初始化图书馆
                if (pageId === 'library') {
                    initLibrary();
                }
                
                // 如果是进程页面，刷新进程列表
                if (pageId === 'process') {
                    updateProcessList();
                }
                
                // 如果是文件页面，初始化文件管理
                if (pageId === 'files') {
                    initFileManager();
                }
                
                // 如果是游戏页面，初始化游戏
                if (pageId === 'games') {
                    initGames();
                }
                
                // 如果是世界地图页面，初始化地图
                if (pageId === 'worldmap') {
                    if (!worldMap) {
                        initWorldMap();
                    } else {
                        // 确保地图正确显示
                        setTimeout(() => {
                            worldMap.invalidateSize();
                        }, 100);
                    }
                }
                
                // 如果是AI助手页面，滚动到底部
                if (pageId === 'ai') {
                    setTimeout(() => {
                        const chatMessages = document.getElementById('ai-chat-messages');
                        if (chatMessages) {
                            chatMessages.scrollTop = chatMessages.scrollHeight;
                        }
                    }, 100);
                }
            }
        }
        
        // 更新系统信息
        function updateSystemInfo() {
            // 更新CPU信息
            const cpuUsage = EnhancedSystemMonitor.getCPUUsage();
            document.getElementById('cpu-percent').textContent = `${cpuUsage.toFixed(1)}%`;
            document.getElementById('cpu-progress').style.width = `${cpuUsage}%`;
            document.getElementById('monitor-cpu-percent').textContent = `${cpuUsage.toFixed(1)}%`;
            document.getElementById('monitor-cpu-progress').style.width = `${cpuUsage}%`;
            
            // 更新CPU详细信息
            const systemInfo = EnhancedSystemMonitor.getSystemInfo();
            const cores = systemInfo.cores || 4;
            document.getElementById('cpu-details').textContent = `核心: ${cores} | 频率: ${(2 + Math.random()).toFixed(2)} GHz`;
            document.getElementById('monitor-cpu-details').textContent = `核心: ${cores} | 线程: ${cores * 2}`;
            document.getElementById('cpu-temp').textContent = `温度: ${(30 + Math.random() * 30).toFixed(1)}°C`;
            document.getElementById('monitor-cpu-temp').textContent = `温度: ${(30 + Math.random() * 30).toFixed(1)}°C`;
            
            // 更新数据源标注
            document.getElementById('cpu-data-source').textContent = '数据源: 模拟数据 (浏览器无法直接获取CPU使用率)';
            document.getElementById('monitor-cpu-data-source').textContent = '数据源: 模拟数据 (浏览器无法直接获取CPU使用率)';
            
            // 更新内存信息
            const memoryInfo = EnhancedSystemMonitor.getMemoryInfo();
            document.getElementById('ram-percent').textContent = `${memoryInfo.percent}%`;
            document.getElementById('ram-progress').style.width = `${memoryInfo.percent}%`;
            document.getElementById('ram-details').textContent = `${memoryInfo.used} GB / ${memoryInfo.total} GB`;
            document.getElementById('ram-available').textContent = `可用: ${memoryInfo.available} GB`;
            
            document.getElementById('monitor-ram-percent').textContent = `${memoryInfo.percent}%`;
            document.getElementById('monitor-ram-progress').style.width = `${memoryInfo.percent}%`;
            document.getElementById('monitor-ram-details').textContent = `已用: ${memoryInfo.used} GB | 缓存: ${(memoryInfo.total * 0.1).toFixed(1)} GB`;
            document.getElementById('monitor-ram-speed').textContent = `速度: ${Math.floor(Math.random() * 2000) + 1600} MHz`;
            
            // 更新内存数据源标注
            if (memoryInfo.isReal) {
                document.getElementById('ram-data-source').textContent = '数据源: 真实数据 (来自Performance API)';
                document.getElementById('monitor-ram-data-source').textContent = '数据源: 真实数据 (来自Performance API)';
            } else {
                document.getElementById('ram-data-source').textContent = '数据源: 模拟数据';
                document.getElementById('monitor-ram-data-source').textContent = '数据源: 模拟数据';
            }
            
            // 更新存储信息
            EnhancedSystemMonitor.getStorageInfo().then(storageInfo => {
                document.getElementById('storage-percent').textContent = `${storageInfo.percent}%`;
                document.getElementById('storage-progress').style.width = `${storageInfo.percent}%`;
                document.getElementById('storage-details').textContent = `${storageInfo.used} GB / ${storageInfo.total} GB`;
                document.getElementById('storage-free').textContent = `剩余: ${storageInfo.free} GB`;
                
                document.getElementById('monitor-storage-percent').textContent = `${storageInfo.percent}%`;
                document.getElementById('monitor-storage-progress').style.width = `${storageInfo.percent}%`;
                document.getElementById('monitor-storage-details').textContent = `读取: ${(Math.random() * 100).toFixed(1)} MB/s | 写入: ${(Math.random() * 50).toFixed(1)} MB/s`;
                document.getElementById('monitor-storage-health').textContent = `健康度: ${(95 + Math.random() * 5).toFixed(1)}%`;
            });
            
            // 更新网络信息
            const networkInfo = EnhancedSystemMonitor.getNetworkInfo();
            document.getElementById('network-activity').textContent = `${networkInfo.total} KB/s`;
            document.getElementById('network-progress').style.width = `${Math.min(100, parseFloat(networkInfo.total) / 5)}%`;
            document.getElementById('network-up').textContent = `上传: ${networkInfo.upload} KB/s`;
            document.getElementById('network-down').textContent = `下载: ${networkInfo.download} KB/s`;
            
            document.getElementById('monitor-network-usage').textContent = `${networkInfo.total} KB/s`;
            document.getElementById('monitor-network-progress').style.width = `${Math.min(100, parseFloat(networkInfo.total) / 5)}%`;
            document.getElementById('monitor-network-up').textContent = `上传: ${networkInfo.upload} KB/s`;
            document.getElementById('monitor-network-down').textContent = `下载: ${networkInfo.download} KB/s`;
            
            // 更新系统信息
            document.getElementById('os-type').textContent = systemInfo.platform;
            document.getElementById('browser-type').textContent = systemInfo.browser;
            document.getElementById('screen-res').textContent = systemInfo.screenRes;
            document.getElementById('online-status').textContent = systemInfo.online;
            
            document.getElementById('system-platform').textContent = systemInfo.platform;
            document.getElementById('user-agent').textContent = systemInfo.userAgent;
            document.getElementById('system-language').textContent = systemInfo.language;
            document.getElementById('timezone').textContent = systemInfo.timezone;
            document.getElementById('cookies-enabled').textContent = systemInfo.cookies;
            document.getElementById('js-enabled').textContent = systemInfo.jsEnabled;
            document.getElementById('device-memory').textContent = systemInfo.deviceMemory;
            document.getElementById('hardware-concurrency').textContent = systemInfo.hardwareConcurrency;
            
            // 更新CPU历史图表
            updateCPUChart(cpuUsage);
            
            // 更新在线时间
            updateUptime();
            
            // 更新最后更新时间
            document.getElementById('last-update').textContent = "刚刚";
            
            // 更新侧边栏状态
            const status = cpuUsage > 80 ? "高负载" : cpuUsage > 50 ? "正常" : "良好";
            document.getElementById('sidebar-status').textContent = status;
        }
        
        // 更新CPU历史图表
        function updateCPUChart(cpuUsage) {
            // 添加新的CPU使用率到历史
            cpuHistory.push(cpuUsage);
            if (cpuHistory.length > 20) {
                cpuHistory.shift();
            }
            
            // 更新图表
            const chartContainer = document.getElementById('cpu-chart');
            chartContainer.innerHTML = '';
            
            const maxHeight = 150; // 图表最大高度
            const barCount = cpuHistory.length;
            const barWidth = Math.max(5, (chartContainer.clientWidth - 20) / barCount);
            
            cpuHistory.forEach((value, index) => {
                const barHeight = (value / 100) * maxHeight;
                const bar = document.createElement('div');
                bar.className = 'chart-bar';
                bar.style.height = `${barHeight}px`;
                bar.style.width = `${barWidth}px`;
                bar.title = `CPU: ${value.toFixed(1)}%`;
                chartContainer.appendChild(bar);
            });
        }
        
        // 更新在线时间
        function updateUptime() {
            systemUptime += updateInterval / 1000; // 转换为秒
            
            const hours = Math.floor(systemUptime / 3600);
            const minutes = Math.floor((systemUptime % 3600) / 60);
            const seconds = Math.floor(systemUptime % 60);
            
            document.getElementById('uptime').textContent = 
                `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }
        
        // 更新当前时间
        function updateCurrentTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString([], {hour12: false});
            document.getElementById('current-time').textContent = timeString;
        }
        
        // 更新进程列表
        function updateProcessList() {
            const processes = SystemMonitor.getProcessList();
            const processListContent = document.getElementById('process-list-content');
            
            processListContent.innerHTML = '';
            
            processes.forEach(process => {
                const row = document.createElement('div');
                row.className = 'process-row';
                row.setAttribute('data-pid', process.pid);
                
                row.innerHTML = `
                    <div class="process-name">
                        <div class="process-icon"><i class="${process.icon}"></i></div>
                        <span>${process.name}</span>
                    </div>
                    <div>${process.pid}</div>
                    <div>${process.cpu.toFixed(1)}%</div>
                    <div>${process.memory.toFixed(1)}%</div>
                    <div>${process.status}</div>
                `;
                
                // 添加点击事件
                row.addEventListener('click', function() {
                    document.querySelectorAll('.process-row').forEach(r => r.classList.remove('selected'));
                    this.classList.add('selected');
                });
                
                processListContent.appendChild(row);
            });
        }
        
        // 初始化文件管理器
        function initFileManager() {
            const directoryList = document.getElementById('directory-list');
            const directories = SystemMonitor.getDirectoryList();
            
            // 清空目录列表
            directoryList.innerHTML = '';
            
            // 添加目录项
            directories.forEach(dir => {
                const dirItem = document.createElement('div');
                dirItem.className = `directory-item ${dir.id === currentDirectory ? 'active' : ''}`;
                dirItem.setAttribute('data-directory', dir.id);
                
                dirItem.innerHTML = `
                    <i class="${dir.icon}"></i>
                    <span>${dir.name}</span>
                `;
                
                dirItem.addEventListener('click', function() {
                    // 更新活动目录
                    document.querySelectorAll('.directory-item').forEach(item => {
                        item.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // 更新当前目录
                    currentDirectory = this.getAttribute('data-directory');
                    
                    // 加载文件列表
                    loadFileList(currentDirectory);
                });
                
                directoryList.appendChild(dirItem);
            });
            
            // 加载初始文件列表
            loadFileList(currentDirectory);
        }
        
        // 加载文件列表
        function loadFileList(directory) {
            const fileListContent = document.getElementById('file-list-content');
            const files = SystemMonitor.getFileList(directory);
            
            // 清空文件列表
            fileListContent.innerHTML = '';
            
            if (files.length === 0) {
                fileListContent.innerHTML = '<p>此目录为空</p>';
                return;
            }
            
            // 添加文件项
            files.forEach(file => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                
                // 根据文件类型设置图标
                let icon = 'fas fa-file';
                if (file.type === 'folder') {
                    icon = 'fas fa-folder';
                } else if (file.name.endsWith('.txt') || file.name.endsWith('.log')) {
                    icon = 'fas fa-file-alt';
                } else if (file.name.endsWith('.pdf')) {
                    icon = 'fas fa-file-pdf';
                } else if (file.name.endsWith('.docx')) {
                    icon = 'fas fa-file-word';
                } else if (file.name.endsWith('.sql')) {
                    icon = 'fas fa-database';
                } else if (file.name.endsWith('.exe')) {
                    icon = 'fas fa-cog';
                } else if (file.name.endsWith('.iso')) {
                    icon = 'fas fa-compact-disc';
                }
                
                fileItem.innerHTML = `
                    <div class="file-icon">
                        <i class="${icon}"></i>
                    </div>
                    <div class="file-info">
                        <div class="file-name">${file.name}</div>
                        <div class="file-details">${file.size} • 修改时间: ${file.modified}</div>
                    </div>
                `;
                
                fileListContent.appendChild(fileItem);
            });
        }
        
        // 显示通知
        function showNotification(title, message, duration = 5000) {
            const notification = document.getElementById('notification');
            const notificationTitle = document.getElementById('notification-title');
            const notificationMessage = document.getElementById('notification-message');
            
            notificationTitle.textContent = title;
            notificationMessage.textContent = message;
            
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, duration);
        }
        
        // 初始化AI助手
        function initAIAssistant() {
            const aiInputField = document.getElementById('ai-input-field');
            const aiSendBtn = document.getElementById('ai-send-btn');
            const aiChatMessages = document.getElementById('ai-chat-messages');
            const aiQuickActions = document.getElementById('ai-quick-actions');
            
            // 发送消息
            function sendMessage() {
                const message = aiInputField.value.trim();
                if (!message) return;
                
                // 添加用户消息
                addMessage('user', message);
                
                // 清空输入框
                aiInputField.value = '';
                
                // 显示AI正在输入
                showTypingIndicator();
                
                // 获取AI响应
                setTimeout(async () => {
                    // 移除正在输入指示器
                    removeTypingIndicator();
                    
                    try {
                        // 获取AI响应
                        const aiResponse = await AIAssistant.getAIResponse(message);
                        
                        // 添加AI响应
                        addMessage('assistant', aiResponse);
                    } catch (error) {
                        // 添加错误消息
                        addMessage('assistant', `抱歉，处理您的请求时出现错误：\n\n<code>${error.message}</code>\n\n请检查API配置或稍后重试。`);
                    }
                }, aiConfig.mode === 'local' ? 800 + Math.random() * 1000 : 1500);
            }
            
            // 添加消息到聊天
            function addMessage(sender, content) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `ai-message ${sender}`;
                
                const senderName = sender === 'user' ? '用户' : 'NeoAI 助手';
                const senderIcon = sender === 'user' ? 'fas fa-user' : 'fas fa-robot';
                
                messageDiv.innerHTML = `
                    <div class="ai-message-header">
                        <i class="${senderIcon}"></i>
                        <span>${senderName}</span>
                    </div>
                    <div class="ai-message-content">${content}</div>
                `;
                
                aiChatMessages.appendChild(messageDiv);
                
                // 滚动到底部
                aiChatMessages.scrollTop = aiChatMessages.scrollHeight;
                
                // 保存到历史
                aiChatHistory.push({sender, content, timestamp: new Date()});
            }
            
            // 显示正在输入指示器
            function showTypingIndicator() {
                const typingDiv = document.createElement('div');
                typingDiv.className = 'typing-indicator';
                typingDiv.id = 'typing-indicator';
                
                typingDiv.innerHTML = `
                    <span>AI助手正在输入...</span>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                `;
                
                aiChatMessages.appendChild(typingDiv);
                aiChatMessages.scrollTop = aiChatMessages.scrollHeight;
            }
            
            // 移除正在输入指示器
            function removeTypingIndicator() {
                const typingIndicator = document.getElementById('typing-indicator');
                if (typingIndicator) {
                    typingIndicator.remove();
                }
            }
            
            // 发送按钮点击事件
            aiSendBtn.addEventListener('click', sendMessage);
            
            // 输入框回车事件
            aiInputField.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });
            
            // 快速操作按钮
            aiQuickActions.querySelectorAll('.ai-quick-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const command = this.getAttribute('data-command');
                    aiInputField.value = command;
                    sendMessage();
                });
            });
            
            // AI模式选择
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const mode = this.getAttribute('data-mode');
                    
                    // 更新UI
                    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    // 更新配置
                    aiConfig.mode = mode;
                    
                    // 显示模式提示
                    let modeText = '';
                    switch(mode) {
                        case 'local':
                            modeText = '本地模式 - 使用预定义知识库';
                            break;
                        case 'api':
                            modeText = 'API模式 - 连接外部AI服务';
                            break;
                        case 'hybrid':
                            modeText = '混合模式 - 智能切换本地和API';
                            break;
                    }
                    
                    addMessage('assistant', `已切换到<strong>${modeText}</strong>。\n\n${mode === 'api' && !aiConfig.apiKey ? '⚠️ 注意：请先配置API密钥以使用外部AI服务。' : '可以开始提问了！'}`);
                    
                    // 保存配置
                    saveAIConfig();
                });
            });
            
            // AI配置面板
            const configToggle = document.getElementById('config-toggle');
            const configContent = document.getElementById('config-content');
            const configArrow = document.getElementById('config-arrow');
            const aiServiceSelect = document.getElementById('ai-service');
            const customApiRow = document.getElementById('custom-api-row');
            const testApiBtn = document.getElementById('test-api-btn');
            const saveConfigBtn = document.getElementById('save-config-btn');
            
            // 切换配置面板显示
            configToggle.addEventListener('click', function() {
                configContent.classList.toggle('expanded');
                configArrow.classList.toggle('fa-chevron-down');
                configArrow.classList.toggle('fa-chevron-up');
            });
            
            // AI服务选择变化
            aiServiceSelect.addEventListener('change', function() {
                const service = this.value;
                customApiRow.style.display = service === 'custom' ? 'flex' : 'none';
                
                // 更新模型选项
                const modelSelect = document.getElementById('ai-model');
                modelSelect.innerHTML = '';
                
                let models = [];
                switch(service) {
                    case 'deepseek':
                        models = [
                            {value: 'deepseek-chat', text: 'DeepSeek Chat'},
                            {value: 'deepseek-coder', text: 'DeepSeek Coder'}
                        ];
                        break;
                    case 'openai':
                        models = [
                            {value: 'gpt-3.5-turbo', text: 'GPT-3.5 Turbo'},
                            {value: 'gpt-4', text: 'GPT-4'},
                            {value: 'gpt-4-turbo', text: 'GPT-4 Turbo'}
                        ];
                        break;
                    case 'anthropic':
                        models = [
                            {value: 'claude-3-haiku', text: 'Claude 3 Haiku'},
                            {value: 'claude-3-sonnet', text: 'Claude 3 Sonnet'},
                            {value: 'claude-3-opus', text: 'Claude 3 Opus'}
                        ];
                        break;
                    case 'gemini':
                        models = [
                            {value: 'gemini-pro', text: 'Gemini Pro'},
                            {value: 'gemini-pro-vision', text: 'Gemini Pro Vision'}
                        ];
                        break;
                    case 'custom':
                        models = [
                            {value: 'gpt-3.5-turbo', text: 'GPT-3.5 Turbo'},
                            {value: 'gpt-4', text: 'GPT-4'},
                            {value: 'custom-model', text: '自定义模型'}
                        ];
                        break;
                }
                
                models.forEach(model => {
                    const option = document.createElement('option');
                    option.value = model.value;
                    option.textContent = model.text;
                    modelSelect.appendChild(option);
                });
            });
            
            // 测试API连接
            testApiBtn.addEventListener('click', async function() {
                // 更新配置
                aiConfig.apiKey = document.getElementById('api-key').value;
                aiConfig.aiService = document.getElementById('ai-service').value;
                aiConfig.aiModel = document.getElementById('ai-model').value;
                aiConfig.customEndpoint = document.getElementById('custom-api-endpoint').value;
                
                if (!aiConfig.apiKey) {
                    showNotification("配置错误", "请先输入API密钥", 3000);
                    return;
                }
                
                this.disabled = true;
                this.textContent = '测试中...';
                
                try {
                    await AIAssistant.testAPIConnection();
                    showNotification("连接成功", "API连接测试成功！", 3000);
                } catch (error) {
                    showNotification("连接失败", `API连接失败: ${error.message}`, 5000);
                } finally {
                    this.disabled = false;
                    this.textContent = '测试API连接';
                }
            });
            
            // 保存配置
            saveConfigBtn.addEventListener('click', function() {
                // 更新配置
                aiConfig.apiKey = document.getElementById('api-key').value;
                aiConfig.aiService = document.getElementById('ai-service').value;
                aiConfig.aiModel = document.getElementById('ai-model').value;
                aiConfig.customEndpoint = document.getElementById('custom-api-endpoint').value;
                
                saveAIConfig();
                
            });
            // 清空对话
            clearChatBtn.addEventListener('click', function() {
                if (confirm("确定要清空当前对话记录吗？")) {
                    aiChatMessages.innerHTML = '';
                    aiChatHistory = [];
                    
                    // 添加初始欢迎消息
                    const welcomeMsg = document.createElement('div');
                    welcomeMsg.className = 'ai-message assistant';
                    welcomeMsg.innerHTML = `
                        <div class="ai-message-header">
                            <i class="fas fa-robot"></i>
                            <span>NeoAI 助手</span>
                        </div>
                        <div class="ai-message-content">
                            对话已清空！我是NeoAI助手，可以为您提供以下帮助：<br><br>
                            1. 解答系统监控相关问题<br>
                            2. 提供网络诊断建议<br>
                            3. 协助解决系统安全问题<br>
                            4. 解释各种技术术语<br>
                            5. 提供性能优化建议<br><br>
                            <strong>当前模式：${aiConfig.mode === 'local' ? '本地模式' : aiConfig.mode === 'api' ? 'API模式' : '混合模式'}</strong><br>
                            请输入您的问题，或点击下方快速按钮开始对话！
                        </div>
                    `;
                    
                    aiChatMessages.appendChild(welcomeMsg);
                    showNotification("对话已清空", "已清除所有对话记录", 3000);
                }
            });

            // 加载保存的配置
            loadAIConfig();

            // 初始化AI服务选择
            aiServiceSelect.dispatchEvent(new Event('change'));
            
        }
        
        // 初始化网络工具功能
        function initNetworkTools() {
            // Ping测试
            document.getElementById('ping-btn').addEventListener('click', async function() {
                const host = document.getElementById('ping-host').value;
                const resultBox = document.getElementById('ping-result');
                
                if (!host) {
                    resultBox.textContent = "错误: 请输入主机名或IP地址";
                    return;
                }
                
                resultBox.innerHTML = '<div class="loading"></div> 正在Ping...';
                this.disabled = true;
                
                try {
                    const result = await SystemMonitor.pingTest(host);
                    resultBox.textContent = result;
                    showNotification("Ping测试完成", `已测试主机: ${host}`);
                } catch (error) {
                    resultBox.textContent = `错误: ${error.message}`;
                } finally {
                    this.disabled = false;
                }
            });
            
            // 路由追踪
            document.getElementById('traceroute-btn').addEventListener('click', async function() {
                const host = document.getElementById('traceroute-host').value;
                const resultBox = document.getElementById('traceroute-result');
                
                if (!host) {
                    resultBox.textContent = "错误: 请输入主机名或IP地址";
                    return;
                }
                
                resultBox.innerHTML = '<div class="loading"></div> 正在追踪路由...';
                this.disabled = true;
                
                try {
                    const result = await SystemMonitor.tracerouteTest(host);
                    resultBox.textContent = result;
                    showNotification("路由追踪完成", `已追踪到: ${host}`);
                } catch (error) {
                    resultBox.textContent = `错误: ${error.message}`;
                } finally {
                    this.disabled = false;
                }
            });
            
            // 端口扫描
            document.getElementById('scan-btn').addEventListener('click', async function() {
                const host = document.getElementById('scan-host').value;
                const portRange = document.getElementById('scan-ports').value;
                const resultBox = document.getElementById('scan-result');
                
                if (!host) {
                    resultBox.textContent = "错误: 请输入主机名或IP地址";
                    return;
                }
                
                if (!portRange.match(/^\d+-\d+$/)) {
                    resultBox.textContent = "错误: 端口范围格式应为 '开始-结束'，例如 '1-100'";
                    return;
                }
                
                resultBox.innerHTML = '<div class="loading"></div> 正在扫描端口...';
                this.disabled = true;
                
                try {
                    const result = await SystemMonitor.portScan(host, portRange);
                    resultBox.textContent = result;
                    showNotification("端口扫描完成", `已扫描 ${host} 的端口`);
                } catch (error) {
                    resultBox.textContent = `错误: ${error.message}`;
                } finally {
                    this.disabled = false;
                }
            });
            
            // 网速测试
            document.getElementById('speed-test-btn').addEventListener('click', async function() {
                const type = document.getElementById('speed-test-type').value;
                const resultBox = document.getElementById('speed-test-result');
                
                resultBox.innerHTML = '<div class="loading"></div> 正在测试网速...';
                this.disabled = true;
                
                try {
                    const result = await SystemMonitor.speedTest(type);
                    resultBox.textContent = result;
                    showNotification("网速测试完成", "网速测试已完成");
                } catch (error) {
                    resultBox.textContent = `错误: ${error.message}`;
                } finally {
                    this.disabled = false;
                }
            });
        }
        
        // 初始化安全扫描功能
        function initSecurityTools() {
            // 安全扫描
            document.getElementById('security-scan-btn').addEventListener('click', async function() {
                const resultBox = document.getElementById('security-scan-result');
                
                resultBox.innerHTML = '<div class="loading"></div> 正在扫描系统安全...';
                this.disabled = true;
                
                try {
                    const result = await SystemMonitor.securityScan();
                    resultBox.textContent = result;
                    showNotification("安全扫描完成", "系统安全扫描已完成");
                } catch (error) {
                    resultBox.textContent = `错误: ${error.message}`;
                } finally {
                    this.disabled = false;
                }
            });
            
            // 漏洞扫描
            document.getElementById('vulnerability-scan-btn').addEventListener('click', async function() {
                const resultBox = document.getElementById('vulnerability-scan-result');
                
                resultBox.innerHTML = '<div class="loading"></div> 正在扫描系统漏洞...';
                this.disabled = true;
                
                try {
                    const result = await SystemMonitor.vulnerabilityScan();
                    resultBox.textContent = result;
                    showNotification("漏洞扫描完成", "系统漏洞扫描已完成");
                } catch (error) {
                    resultBox.textContent = `错误: ${error.message}`;
                } finally {
                    this.disabled = false;
                }
            });
            
            // 恶意软件扫描
            document.getElementById('malware-scan-btn').addEventListener('click', async function() {
                const resultBox = document.getElementById('malware-scan-result');
                
                resultBox.innerHTML = '<div class="loading"></div> 正在扫描恶意软件...';
                this.disabled = true;
                
                try {
                    const result = await SystemMonitor.malwareScan();
                    resultBox.textContent = result;
                    showNotification("恶意软件扫描完成", "恶意软件扫描已完成");
                } catch (error) {
                    resultBox.textContent = `错误: ${error.message}`;
                } finally {
                    this.disabled = false;
                }
            });
        }
        
        // 初始化进程管理功能
        function initProcessManager() {
            // 刷新进程
            document.getElementById('refresh-processes').addEventListener('click', function() {
                updateProcessList();
                showNotification("进程列表已刷新", "进程列表已更新");
            });
            
            // 按CPU排序
            document.getElementById('sort-cpu').addEventListener('click', function() {
                const processes = SystemMonitor.getProcessList();
                processes.sort((a, b) => b.cpu - a.cpu);
                processList = processes;
                updateProcessList();
                showNotification("进程已排序", "已按CPU使用率降序排列");
            });
            
            // 按内存排序
            document.getElementById('sort-memory').addEventListener('click', function() {
                const processes = SystemMonitor.getProcessList();
                processes.sort((a, b) => b.memory - a.memory);
                processList = processes;
                updateProcessList();
                showNotification("进程已排序", "已按内存使用率降序排列");
            });
            
            // 结束进程
            document.getElementById('kill-process').addEventListener('click', function() {
                const selectedProcess = document.querySelector('.process-row.selected');
                
                if (!selectedProcess) {
                    showNotification("操作失败", "请先选择一个进程", 3000);
                    return;
                }
                
                const pid = selectedProcess.getAttribute('data-pid');
                const processName = selectedProcess.querySelector('.process-name span').textContent;
                
                if (confirm(`确定要结束进程 "${processName}" (PID: ${pid}) 吗？`)) {
                    // 从进程列表中移除
                    selectedProcess.style.opacity = '0.5';
                    selectedProcess.style.textDecoration = 'line-through';
                    
                    setTimeout(() => {
                        selectedProcess.remove();
                        showNotification("进程已结束", `已结束进程: ${processName}`);
                    }, 500);
                }
            });
        }
        
        // 初始化设置功能
        function initSettings() {
            // 应用设置
            document.getElementById('apply-settings').addEventListener('click', function() {
                const updateIntervalSelect = document.getElementById('update-interval');
                const newInterval = parseInt(updateIntervalSelect.value) * 1000;
                const themeSelect = document.getElementById('theme-select');
                const selectedTheme = themeSelect.value;
                
                if (newInterval !== updateInterval) {
                    updateInterval = newInterval;
                    clearInterval(updateTimer);
                    startSystemMonitoring();
                    showNotification("设置已应用", `更新间隔已设置为 ${updateInterval/1000} 秒`);
                } else {
                    showNotification("设置已应用", "系统设置已更新");
                }
                
                // 应用主题
                applyTheme(selectedTheme);
            });
            
            // 主题应用
            function applyTheme(theme) {
                const root = document.documentElement;
                
                switch(theme) {
                    case 'matrix':
                        root.style.setProperty('--primary', '#00ff41');
                        root.style.setProperty('--primary-dark', '#009929');
                        root.style.setProperty('--secondary', '#00ff41');
                        root.style.setProperty('--game-color', '#00ff41');
                        root.style.setProperty('--map-color', '#00ff41');
                        break;
                    case 'neon':
                        root.style.setProperty('--primary', '#ff00ff');
                        root.style.setProperty('--primary-dark', '#cc00cc');
                        root.style.setProperty('--secondary', '#ff00ff');
                        root.style.setProperty('--game-color', '#ff00ff');
                        root.style.setProperty('--map-color', '#ff00ff');
                        break;
                    case 'ocean':
                        root.style.setProperty('--primary', '#00ccff');
                        root.style.setProperty('--primary-dark', '#0066ff');
                        root.style.setProperty('--secondary', '#00ffcc');
                        root.style.setProperty('--game-color', '#00ccff');
                        root.style.setProperty('--map-color', '#00ccff');
                        break;
                    case 'ai':
                        root.style.setProperty('--primary', '#00ff9d');
                        root.style.setProperty('--primary-dark', '#00cc80');
                        root.style.setProperty('--secondary', '#00ff9d');
                        root.style.setProperty('--game-color', '#00ff9d');
                        root.style.setProperty('--map-color', '#00ff9d');
                        break;
                    case 'game':
                        root.style.setProperty('--primary', '#ff6b6b');
                        root.style.setProperty('--primary-dark', '#ff4757');
                        root.style.setProperty('--secondary', '#ff6b6b');
                        root.style.setProperty('--game-color', '#ff6b6b');
                        root.style.setProperty('--map-color', '#ff6b6b');
                        break;
                    case 'map':
                        root.style.setProperty('--primary', '#00cc88');
                        root.style.setProperty('--primary-dark', '#00aa77');
                        root.style.setProperty('--secondary', '#00cc88');
                        root.style.setProperty('--game-color', '#00cc88');
                        root.style.setProperty('--map-color', '#00cc88');
                        break;
                    default: // cyber
                        root.style.setProperty('--primary', '#00f3ff');
                        root.style.setProperty('--primary-dark', '#0066ff');
                        root.style.setProperty('--secondary', '#ff00ff');
                        root.style.setProperty('--game-color', '#ff6b6b');
                        root.style.setProperty('--map-color', '#00cc88');
                }
            }
        }
        
        // 开始系统监控
        function startSystemMonitoring() {
            // 初始更新
            updateSystemInfo();
            updateCurrentTime();
            
            // 设置定时器
            updateTimer = setInterval(() => {
                updateSystemInfo();
                updateCurrentTime();
                
                // 如果当前是进程页面，更新进程列表
                if (currentPage === 'process') {
                    updateProcessList();
                }
                
                // 如果当前是地图页面，更新地图数据
                if (currentPage === 'worldmap' && worldMap) {
                    // 随机更新一些地图数据
                    if (Math.random() < 0.3) {
                        updateMapData();
                        renderMapData();
                    }
                }
            }, updateInterval);
        }
        
        // 更新地图数据
        function updateMapData() {
            // 随机更新节点状态
            mapData.nodes.forEach(node => {
                if (Math.random() < 0.1) {
                    node.status = node.status === "active" ? "inactive" : "active";
                }
                if (Math.random() < 0.2) {
                    node.load = Math.floor(Math.random() * 100);
                }
            });
            
            // 随机添加/移除攻击事件
            if (Math.random() < 0.2) {
                if (mapData.attacks.length < 10 && Math.random() < 0.5) {
                    // 添加新攻击事件
                    const cities = [
                        { name: "纽约", lat: 40.7128, lng: -74.0060 },
                        { name: "伦敦", lat: 51.5074, lng: -0.1278 },
                        { name: "东京", lat: 35.6762, lng: 139.6503 },
                        { name: "上海", lat: 31.2304, lng: 121.4737 }
                    ];
                    const randomCity = cities[Math.floor(Math.random() * cities.length)];
                    
                    mapData.attacks.push({
                        id: `attack_${Date.now()}`,
                        type: ["DDoS", "恶意软件", "数据泄露", "网络钓鱼", "零日漏洞"][Math.floor(Math.random() * 5)],
                        source: ["未知", "国家黑客", "犯罪组织", "内部威胁", "竞争企业"][Math.floor(Math.random() * 5)],
                        target: randomCity.name,
                        lat: randomCity.lat + (Math.random() - 0.5) * 5,
                        lng: randomCity.lng + (Math.random() - 0.5) * 5,
                        severity: ["低", "中", "高", "严重"][Math.floor(Math.random() * 4)],
                        timestamp: new Date().toISOString()
                    });
                } else if (mapData.attacks.length > 0 && Math.random() < 0.3) {
                    // 移除旧攻击事件
                    mapData.attacks.shift();
                }
            }
            
            // 更新用户位置
            mapData.users.forEach(user => {
                if (Math.random() < 0.1) {
                    user.lat += (Math.random() - 0.5) * 2;
                    user.lng += (Math.random() - 0.5) * 2;
                }
            });
            
            // 更新地图统计
            updateMapStats();
        }
        
        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 首先初始化登录系统
            initLoginSystem();
            
            // 跟踪鼠标移动以计算CPU负载
            window.mouseMoveCount = 0;
            document.addEventListener('mousemove', function() {
                window.mouseMoveCount = (window.mouseMoveCount || 0) + 1;
                
                // 每5秒重置一次计数
                if (!window.mouseMoveTimer) {
                    window.mouseMoveTimer = setTimeout(() => {
                        window.mouseMoveCount = 0;
                        window.mouseMoveTimer = null;
                    }, 5000);
                }
            });
            
            // 初始化页面导航
            initPageNavigation();
            
            // 初始化网络工具
            initNetworkTools();
            
            // 初始化安全工具
            initSecurityTools();
            
            // 初始化进程管理
            initProcessManager();
            
            // 初始化AI助手
            initAIAssistant();
            
            // 初始化设置
            initSettings();
            
            // 显示欢迎通知（仅当用户登录后）
            if (isLoggedIn) {
                setTimeout(() => {
                    showNotification("系统启动完成", "NeoSystem 高级监控终端 v4.0 已就绪，新增世界地图模块和增强系统监控", 6000);
                }, 1000);
            }
        });
        // 在现有的事件监听器部分（大约在行 3200 左右）添加以下代码

        // 代码编辑器按钮事件
        document.getElementById('new-file-btn')?.addEventListener('click', function() {
            createNewFile();
        });

        document.getElementById('save-file-btn')?.addEventListener('click', function() {
            saveCurrentFile();
        });

        document.getElementById('run-code-btn')?.addEventListener('click', function() {
            runCode();
        });

        // 量子计算按钮事件
        document.getElementById('quantum-reset-btn')?.addEventListener('click', function() {
            resetQuantumSimulation();
        });

        document.getElementById('quantum-run-btn')?.addEventListener('click', function() {
            runQuantumSimulation();
        });

        document.getElementById('add-gate-btn')?.addEventListener('click', function() {
            addQuantumGate();
        });

        // 机器学习按钮事件
        document.getElementById('ml-train-btn')?.addEventListener('click', function() {
            trainMLModel();
        });

        document.getElementById('ml-predict-btn')?.addEventListener('click', function() {
            runMLPrediction();
        });

        document.getElementById('run-prediction-btn')?.addEventListener('click', function() {
            executePrediction();
        });

        // 文件选项卡关闭按钮
        document.querySelectorAll('.editor-tab i.fa-times').forEach(closeBtn => {
            closeBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                const tab = this.parentElement;
                closeEditorTab(tab);
            });
        });

        // 代码编辑器语言选择
        document.getElementById('language-select')?.addEventListener('change', function() {
            changeLanguage(this.value);
        });

        // 量子门选择
        document.querySelectorAll('.gate-item').forEach(gate => {
            gate.addEventListener('click', function() {
                selectQuantumGate(this.getAttribute('data-gate'));
            });
        });

        // 量子比特数量滑块
        document.getElementById('qubit-count')?.addEventListener('input', function() {
            document.getElementById('qubit-count-display').textContent = this.value;
            updateQuantumCircuit();
        });

        // 数据集选择
        document.querySelectorAll('.dataset-item').forEach(dataset => {
            dataset.addEventListener('click', function() {
                document.querySelectorAll('.dataset-item').forEach(item => item.classList.remove('active'));
                this.classList.add('active');
                selectDataset(this.getAttribute('data-dataset'));
            });
        });

        // 算法选择
        document.querySelectorAll('.algorithm-item').forEach(algorithm => {
            algorithm.addEventListener('click', function() {
                document.querySelectorAll('.algorithm-item').forEach(item => item.classList.remove('active'));
                this.classList.add('active');
                selectAlgorithm(this.getAttribute('data-algorithm'));
            });
        });

        // 算法分类选择
        document.querySelectorAll('.algorithm-category-btn').forEach(category => {
            category.addEventListener('click', function() {
                document.querySelectorAll('.algorithm-category-btn').forEach(btn => btn.classList.remove('active'));
                this.classList.add('active');
                filterAlgorithms(this.getAttribute('data-category'));
            });
        });

        // 现在添加功能实现函数

        // 代码编辑器功能
        function createNewFile() {
            const fileName = prompt('请输入新文件名（包含扩展名，如：script.js）：', 'new_file.py');
            if (fileName) {
                addNewEditorTab(fileName);
                showNotification('新建文件', `已创建新文件: ${fileName}`, 3000);
            }
        }

        function addNewEditorTab(fileName) {
            const editorTabs = document.querySelector('.editor-tabs');
            const fileExtension = fileName.split('.').pop().toLowerCase();
            const iconClass = getFileIconClass(fileExtension);
            
            const newTab = document.createElement('div');
            newTab.className = 'editor-tab active';
            newTab.setAttribute('data-file', fileName);
            newTab.innerHTML = `
                <i class="${iconClass}"></i>
                <span>${fileName}</span>
                <i class="fas fa-times"></i>
            `;
            
            // 移除其他标签的active类
            document.querySelectorAll('.editor-tab').forEach(tab => tab.classList.remove('active'));
            
            editorTabs.appendChild(newTab);
            
            // 更新编辑器内容
            updateEditorForNewFile(fileName, fileExtension);
            
            // 为关闭按钮添加事件
            newTab.querySelector('.fa-times').addEventListener('click', function(e) {
                e.stopPropagation();
                closeEditorTab(newTab);
            });
            
            // 为标签添加点击事件
            newTab.addEventListener('click', function() {
                document.querySelectorAll('.editor-tab').forEach(tab => tab.classList.remove('active'));
                this.classList.add('active');
                switchToTab(fileName);
            });
        }

        function getFileIconClass(extension) {
            const iconMap = {
                'py': 'fab fa-python',
                'js': 'fab fa-js',
                'html': 'fab fa-html5',
                'css': 'fab fa-css3-alt',
                'json': 'fas fa-code',
                'md': 'fas fa-markdown',
                'cpp': 'fas fa-file-code',
                'java': 'fab fa-java',
                'php': 'fab fa-php',
                'sql': 'fas fa-database'
            };
            return iconMap[extension] || 'fas fa-file-code';
        }

        function updateEditorForNewFile(fileName, extension) {
            const fileInfo = document.querySelector('.file-info');
            const iconClass = getFileIconClass(extension);
            
            fileInfo.innerHTML = `<i class="${iconClass}"></i><span>${fileName}</span>`;
            
            // 根据文件类型设置初始内容
            const codeInput = document.getElementById('code-input');
            let initialContent = '';
            
            switch(extension) {
                case 'py':
                    initialContent = `# ${fileName}\n# NeoSystem 代码编辑器\n\nprint("Hello from ${fileName}!")\n`;
                    break;
                case 'js':
                    initialContent = `// ${fileName}\n// NeoSystem 代码编辑器\n\nconsole.log("Hello from ${fileName}!");\n`;
                    break;
                case 'html':
                    initialContent = `<!DOCTYPE html>\n<html>\n<head>\n    <title>${fileName}</title>\n</head>\n<body>\n    <h1>Hello from NeoSystem!</h1>\n</body>\n</html>`;
                    break;
                case 'css':
                    initialContent = `/* ${fileName} */\n/* NeoSystem 代码编辑器 */\n\nbody {\n    margin: 0;\n    padding: 0;\n}`;
                    break;
                default:
                    initialContent = `// ${fileName}\n// NeoSystem 代码编辑器\n`;
            }
            
            codeInput.value = initialContent;
        }

        function saveCurrentFile() {
            const activeTab = document.querySelector('.editor-tab.active');
            if (!activeTab) return;
            
            const fileName = activeTab.getAttribute('data-file');
            const codeContent = document.getElementById('code-input').value;
            
            // 模拟保存操作
            showNotification('文件保存', `文件 "${fileName}" 已保存`, 3000);
            
            // 在实际应用中，这里会调用服务器API或使用本地存储
            console.log(`保存文件: ${fileName}`, codeContent);
        }

        function runCode() {
            const activeTab = document.querySelector('.editor-tab.active');
            if (!activeTab) return;
            
            const fileName = activeTab.getAttribute('data-file');
            const codeContent = document.getElementById('code-input').value;
            const language = document.getElementById('language-select').value;
            
            // 模拟代码执行
            const outputArea = document.getElementById('output-area');
            outputArea.innerHTML = `>>> 执行 ${fileName}...\n`;
            
            // 模拟执行不同语言的代码
            let result = '';
            switch(language) {
                case 'python':
                    result = executePythonCode(codeContent);
                    break;
                case 'javascript':
                    result = executeJavaScriptCode(codeContent);
                    break;
                default:
                    result = `>>> 代码执行完成\n>>> 语言: ${language}\n>>> 结果: 模拟执行成功`;
            }
            
            outputArea.innerHTML += result;
            outputArea.scrollTop = outputArea.scrollHeight;
            
            showNotification('代码执行', `${fileName} 执行完成`, 3000);
        }

        function executePythonCode(code) {
            // 简单模拟Python代码执行
            const lines = code.split('\n');
            let output = '';
            
            for (let line of lines) {
                if (line.includes('print(')) {
                    const match = line.match(/print\(["'](.+)["']\)/);
                    if (match) {
                        output += `${match[1]}\n`;
                    }
                }
            }
            
            return output || ">>> 没有输出结果";
        }

        function executeJavaScriptCode(code) {
            // 简单模拟JavaScript代码执行
            const lines = code.split('\n');
            let output = '';
            
            for (let line of lines) {
                if (line.includes('console.log(')) {
                    const match = line.match(/console\.log\(["'](.+)["']\)/);
                    if (match) {
                        output += `${match[1]}\n`;
                    }
                }
            }
            
            return output || ">>> 没有输出结果";
        }

        function closeEditorTab(tab) {
            const fileName = tab.getAttribute('data-file');
            const tabs = document.querySelectorAll('.editor-tab');
            
            if (tabs.length <= 1) {
                showNotification('无法关闭', '至少需要一个打开的标签页', 3000);
                return;
            }
            
            tab.remove();
            
            // 激活下一个标签页
            const remainingTabs = document.querySelectorAll('.editor-tab');
            if (remainingTabs.length > 0) {
                remainingTabs[0].classList.add('active');
                const nextFileName = remainingTabs[0].getAttribute('data-file');
                switchToTab(nextFileName);
            }
        }

        function switchToTab(fileName) {
            // 在实际应用中，这里会加载对应文件的内容
            showNotification('切换标签', `已切换到: ${fileName}`, 2000);
        }

        function changeLanguage(language) {
            showNotification('语言切换', `编程语言已切换为: ${language}`, 2000);
        }

        // 量子计算模拟功能
        function resetQuantumSimulation() {
            showNotification('量子重置', '量子模拟已重置', 3000);
            
            // 重置电路
            const circuitContainer = document.getElementById('circuit-container');
            circuitContainer.innerHTML = '<div class="quantum-circuit-placeholder">点击"添加量子门"按钮添加门操作</div>';
            
            // 重置可视化
            updateBlochSphere([0, 0, 1]);
            updateProbabilityChart([100, 0, 0, 0]);
        }

        function runQuantumSimulation() {
            showNotification('量子模拟', '正在运行量子模拟...', 3000);
            
            // 模拟量子计算
            const qubits = parseInt(document.getElementById('qubit-count').value);
            const measurements = parseInt(document.getElementById('measure-count').value);
            const initialState = document.getElementById('initial-state').value;
            
            // 生成随机结果（模拟）
            const probabilities = generateProbabilities(qubits);
            const measurementsResult = simulateMeasurements(probabilities, measurements);
            
            // 更新可视化
            updateBlochSphere([Math.random()*2-1, Math.random()*2-1, Math.random()*2-1]);
            updateProbabilityChart(probabilities);
            updateMeasurementHistogram(measurementsResult);
            
            // 更新状态向量
            updateStateVector(probabilities);
        }

        function generateProbabilities(qubits) {
            const states = Math.pow(2, qubits);
            const probabilities = [];
            let sum = 0;
            
            for (let i = 0; i < states; i++) {
                probabilities.push(Math.random());
                sum += probabilities[i];
            }
            
            // 归一化
            return probabilities.map(p => (p / sum) * 100);
        }

        function simulateMeasurements(probabilities, count) {
            const states = probabilities.length;
            const results = new Array(states).fill(0);
            
            for (let i = 0; i < count; i++) {
                const rand = Math.random() * 100;
                let cumulative = 0;
                
                for (let j = 0; j < states; j++) {
                    cumulative += probabilities[j];
                    if (rand <= cumulative) {
                        results[j]++;
                        break;
                    }
                }
            }
            
            return results;
        }

        function addQuantumGate() {
            const selectedGate = document.querySelector('.gate-item.selected')?.getAttribute('data-gate') || 'H';
            const circuitContainer = document.getElementById('circuit-container');
            
            const gateElement = document.createElement('div');
            gateElement.className = 'quantum-gate';
            gateElement.innerHTML = `
                <div class="gate-label">${selectedGate}</div>
                <div class="gate-connector"></div>
            `;
            
            circuitContainer.appendChild(gateElement);
            
            showNotification('添加量子门', `已添加 ${selectedGate} 门`, 2000);
        }

        function selectQuantumGate(gate) {
            document.querySelectorAll('.gate-item').forEach(item => item.classList.remove('selected'));
            document.querySelector(`.gate-item[data-gate="${gate}"]`).classList.add('selected');
        }

        function updateQuantumCircuit() {
            const qubits = parseInt(document.getElementById('qubit-count').value);
            const circuitContainer = document.getElementById('circuit-container');
            
            // 简化：只显示量子比特数量
            circuitContainer.innerHTML = `<div class="circuit-info">量子比特数量: ${qubits}</div>`;
        }

        function updateBlochSphere(coords) {
            const sphere = document.getElementById('bloch-sphere');
            let existingDot = sphere.querySelector('.quantum-state-dot');
            
            if (!existingDot) {
                existingDot = document.createElement('div');
                existingDot.className = 'quantum-state-dot';
                sphere.appendChild(existingDot);
            }
            
            // 简化：随机位置
            const x = 50 + (coords[0] * 40);
            const y = 50 + (coords[1] * 40);
            
            existingDot.style.left = `${x}%`;
            existingDot.style.top = `${y}%`;
            
            // 更新信息
            document.getElementById('bloch-state').textContent = `当前状态: |ψ⟩`;
            document.getElementById('bloch-coords').textContent = `坐标: (${coords[0].toFixed(2)}, ${coords[1].toFixed(2)}, ${coords[2].toFixed(2)})`;
        }

        function updateProbabilityChart(probabilities) {
            const chart = document.getElementById('probability-chart');
            chart.innerHTML = '';
            
            probabilities.forEach((prob, index) => {
                const bar = document.createElement('div');
                bar.className = 'prob-bar';
                bar.style.height = `${prob}%`;
                bar.style.width = `${100/probabilities.length - 2}%`;
                chart.appendChild(bar);
            });
            
            // 更新概率列表
            const probabilityList = document.getElementById('probability-list');
            probabilityList.innerHTML = '';
            
            probabilities.forEach((prob, index) => {
                const state = index.toString(2).padStart(Math.log2(probabilities.length), '0');
                const item = document.createElement('div');
                item.className = 'prob-item';
                item.innerHTML = `
                    <span class="prob-state">|${state}⟩</span>
                    <div class="prob-bar-container">
                        <div class="prob-bar-inline" style="width: ${prob}%"></div>
                    </div>
                    <span class="prob-value">${prob.toFixed(1)}%</span>
                `;
                probabilityList.appendChild(item);
            });
        }

        function updateMeasurementHistogram(results) {
            const total = results.reduce((a, b) => a + b, 0);
            const histogram = document.getElementById('measurement-stats');
            
            let html = `<p>模拟测量次数：${total}</p>`;
            results.forEach((count, index) => {
                const state = index.toString(2).padStart(Math.log2(results.length), '0');
                const percentage = total > 0 ? (count / total * 100).toFixed(1) : 0;
                html += `|${state}⟩: ${percentage}% (${count}次)<br>`;
            });
            
            histogram.innerHTML = html;
        }

        function updateStateVector(probabilities) {
            const statevector = document.getElementById('statevector-output');
            let vectorString = '|ψ⟩ = ';
            
            probabilities.forEach((prob, index) => {
                const amplitude = Math.sqrt(prob/100).toFixed(3);
                const state = index.toString(2).padStart(Math.log2(probabilities.length), '0');
                vectorString += `${amplitude}|${state}⟩ ${index < probabilities.length-1 ? '+ ' : ''}`;
            });
            
            statevector.textContent = vectorString;
        }

        // 机器学习功能
        function trainMLModel() {
            showNotification('训练模型', '开始训练机器学习模型...', 3000);
            
            const dataset = document.querySelector('.dataset-item.active')?.getAttribute('data-dataset') || 'iris';
            const algorithm = document.querySelector('.algorithm-item.active')?.getAttribute('data-algorithm') || 'logistic';
            
            // 模拟训练过程
            const logOutput = document.getElementById('training-log-output');
            logOutput.innerHTML = '';
            
            const logs = [
                `[INFO] 加载${getDatasetName(dataset)}数据集...`,
                '[INFO] 数据预处理中...',
                '[INFO] 划分训练集/测试集: 80%/20%',
                `[INFO] 初始化${getAlgorithmName(algorithm)}模型...`,
                '[INFO] 开始训练模型...'
            ];
            
            logs.forEach((log, index) => {
                setTimeout(() => {
                    const entry = document.createElement('div');
                    entry.className = 'log-entry';
                    entry.textContent = log;
                    logOutput.appendChild(entry);
                    logOutput.scrollTop = logOutput.scrollHeight;
                }, index * 500);
            });
            
            // 模拟训练完成
            setTimeout(() => {
                const finalLogs = [
                    '[INFO] 训练完成!',
                    '[INFO] 测试集准确率: 95.0%',
                    '[INFO] 模型已保存'
                ];
                
                finalLogs.forEach((log, index) => {
                    const entry = document.createElement('div');
                    entry.className = 'log-entry';
                    entry.textContent = log;
                    logOutput.appendChild(entry);
                    logOutput.scrollTop = logOutput.scrollHeight;
                });
                
                // 更新评估指标
                updateEvaluationMetrics();
                
                showNotification('训练完成', '机器学习模型训练完成', 3000);
            }, 3000);
        }

        function runMLPrediction() {
            showNotification('预测', '运行模型预测...', 3000);
            
            // 模拟预测过程
            const predictionOutput = document.getElementById('prediction-output');
            const classes = ['山鸢尾 (Setosa)', '变色鸢尾 (Versicolor)', '维吉尼亚鸢尾 (Virginica)'];
            const randomClass = classes[Math.floor(Math.random() * classes.length)];
            const confidence = (Math.random() * 20 + 80).toFixed(1);
            
            predictionOutput.innerHTML = `
                <div class="prediction-result">
                    <h5>预测结果:</h5>
                    <div class="prediction-class">${randomClass}</div>
                    <div class="prediction-confidence">置信度: ${confidence}%</div>
                </div>
                <div class="probability-distribution">
                    <h5>类别概率:</h5>
                    ${generateProbabilityDistribution()}
                </div>
            `;
        }

        function executePrediction() {
            // 获取输入值
            const sepalLength = parseFloat(document.getElementById('predict-sepal-length').value) || 5.1;
            const sepalWidth = parseFloat(document.getElementById('predict-sepal-width').value) || 3.5;
            const petalLength = parseFloat(document.getElementById('predict-petal-length').value) || 1.4;
            const petalWidth = parseFloat(document.getElementById('predict-petal-width').value) || 0.2;
            
            // 简单模拟预测逻辑
            let predictedClass;
            let confidence;
            
            if (petalLength < 2 && petalWidth < 1) {
                predictedClass = '山鸢尾 (Setosa)';
                confidence = 95 + Math.random() * 5;
            } else if (petalLength < 5 && petalWidth < 1.8) {
                predictedClass = '变色鸢尾 (Versicolor)';
                confidence = 85 + Math.random() * 10;
            } else {
                predictedClass = '维吉尼亚鸢尾 (Virginica)';
                confidence = 80 + Math.random() * 15;
            }
            
            confidence = confidence.toFixed(1);
            
            // 更新预测结果
            const predictionOutput = document.getElementById('prediction-output');
            predictionOutput.innerHTML = `
                <div class="prediction-result">
                    <h5>预测结果:</h5>
                    <div class="prediction-class">${predictedClass}</div>
                    <div class="prediction-confidence">置信度: ${confidence}%</div>
                </div>
                <div class="probability-distribution">
                    <h5>类别概率:</h5>
                    ${generateProbabilityDistribution(predictedClass, confidence)}
                </div>
            `;
            
            showNotification('预测完成', `预测结果: ${predictedClass} (${confidence}%)`, 3000);
        }

        function generateProbabilityDistribution(predictedClass = null, confidence = null) {
            const classes = [
                { name: 'Setosa', color: '#ff6b6b' },
                { name: 'Versicolor', color: '#00cc88' },
                { name: 'Virginica', color: '#00a8ff' }
            ];
            
            let html = '';
            
            if (predictedClass) {
                // 基于预测结果生成分布
                classes.forEach(cls => {
                    let percentage;
                    if (predictedClass.includes(cls.name)) {
                        percentage = parseFloat(confidence);
                    } else {
                        percentage = (100 - confidence) / 2;
                    }
                    
                    html += `
                        <div class="prob-dist-item">
                            <span>${cls.name}: </span>
                            <div class="prob-bar-container">
                                <div class="prob-bar" style="width: ${percentage}%"></div>
                            </div>
                            <span>${percentage.toFixed(1)}%</span>
                        </div>
                    `;
                });
            } else {
                // 随机分布
                let total = 0;
                const percentages = [];
                
                for (let i = 0; i < classes.length; i++) {
                    percentages[i] = Math.random() * 100;
                    total += percentages[i];
                }
                
                // 归一化
                percentages.forEach((p, i) => {
                    percentages[i] = (p / total * 100).toFixed(1);
                });
                
                classes.forEach((cls, i) => {
                    html += `
                        <div class="prob-dist-item">
                            <span>${cls.name}: </span>
                            <div class="prob-bar-container">
                                <div class="prob-bar" style="width: ${percentages[i]}%"></div>
                            </div>
                            <span>${percentages[i]}%</span>
                        </div>
                    `;
                });
            }
            
            return html;
        }

        function getDatasetName(datasetId) {
            const names = {
                'iris': '鸢尾花',
                'diabetes': '糖尿病',
                'wine': '葡萄酒',
                'breast_cancer': '乳腺癌',
                'custom': '自定义'
            };
            return names[datasetId] || datasetId;
        }

        function getAlgorithmName(algorithmId) {
            const names = {
                'logistic': '逻辑回归',
                'svm': '支持向量机',
                'decision_tree': '决策树',
                'random_forest': '随机森林',
                'knn': 'K最近邻',
                'neural_network': '神经网络'
            };
            return names[algorithmId] || algorithmId;
        }

        function updateEvaluationMetrics() {
            // 模拟更新评估指标
            const metrics = {
                accuracy: (0.85 + Math.random() * 0.15).toFixed(2),
                precision: (0.84 + Math.random() * 0.16).toFixed(2),
                recall: (0.83 + Math.random() * 0.17).toFixed(2),
                f1: (0.835 + Math.random() * 0.165).toFixed(3)
            };
            
            document.getElementById('accuracy-metric').textContent = metrics.accuracy;
            document.getElementById('precision-metric').textContent = metrics.precision;
            document.getElementById('recall-metric').textContent = metrics.recall;
            document.getElementById('f1-metric').textContent = metrics.f1;
        }

        function selectDataset(datasetId) {
            showNotification('数据集选择', `已选择: ${getDatasetName(datasetId)}数据集`, 2000);
            
            // 更新图表（简化）
            updateChartForDataset(datasetId);
        }

        function selectAlgorithm(algorithmId) {
            showNotification('算法选择', `已选择: ${getAlgorithmName(algorithmId)}`, 2000);
            
            // 显示对应的参数面板
            document.querySelectorAll('.parameter-group').forEach(group => {
                group.style.display = 'none';
            });
            
            const paramsGroup = document.getElementById(`${algorithmId}-params`);
            if (paramsGroup) {
                paramsGroup.style.display = 'block';
            }
        }

        function filterAlgorithms(category) {
            // 简化：只显示通知
            showNotification('算法分类', `显示: ${category} 类算法`, 2000);
        }

        function updateChartForDataset(datasetId) {
            // 简化：只更新图例
            const legend = document.getElementById('chart-legend');
            
            if (datasetId === 'iris') {
                legend.innerHTML = `
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #ff6b6b;"></div>
                        <span>山鸢尾 (Setosa)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #00cc88;"></div>
                        <span>变色鸢尾 (Versicolor)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #00a8ff;"></div>
                        <span>维吉尼亚鸢尾 (Virginica)</span>
                    </div>
                `;
            } else {
                // 通用图例
                legend.innerHTML = `
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #ff6b6b;"></div>
                        <span>类别 1</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #00cc88;"></div>
                        <span>类别 2</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #00a8ff;"></div>
                        <span>类别 3</span>
                    </div>
                `;
            }
        }

        // 在页面初始化部分添加对新模块的初始化
        // 找到 initLoginSystem 函数，在登录成功后添加：

        // 在 loginSuccess 函数中，找到以下部分：
        // mainContainer.classList.add('show');
        // startSystemMonitoring();

        // 在这之后添加：
        setTimeout(() => {
            // 初始化新模块
            initCodeEditorTabs();
            initQuantumGates();
            initMLParameters();
        }, 1000);

        // 初始化函数
        function initCodeEditorTabs() {
            // 为现有的文件列表项添加点击事件
            document.querySelectorAll('#editor-file-list .file-item').forEach(item => {
                item.addEventListener('click', function() {
                    document.querySelectorAll('#editor-file-list .file-item').forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                    
                    const fileName = this.getAttribute('data-file');
                    const fileExtension = fileName.split('.').pop().toLowerCase();
                    
                    // 更新编辑器
                    updateEditorForNewFile(fileName, fileExtension);
                    
                    // 确保标签页存在
                    const existingTab = document.querySelector(`.editor-tab[data-file="${fileName}"]`);
                    if (!existingTab) {
                        addNewEditorTab(fileName);
                    } else {
                        document.querySelectorAll('.editor-tab').forEach(tab => tab.classList.remove('active'));
                        existingTab.classList.add('active');
                    }
                });
            });
        }

        function initQuantumGates() {
            // 默认选择第一个量子门
            const firstGate = document.querySelector('.gate-item');
            if (firstGate) {
                firstGate.classList.add('selected');
            }
        }

        function initMLParameters() {
            // 默认显示逻辑回归参数
            document.getElementById('logistic-params').style.display = 'block';
            
            // 为参数滑块添加事件
            document.getElementById('logistic-c')?.addEventListener('input', function() {
                document.getElementById('logistic-c-value').textContent = parseFloat(this.value).toFixed(2);
            });
            
            document.getElementById('neural-learning-rate')?.addEventListener('input', function() {
                document.getElementById('neural-learning-rate-value').textContent = parseFloat(this.value).toFixed(3);
            });
        }

        // 为可视化选项卡添加事件
        document.querySelectorAll('.viz-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                const vizType = this.getAttribute('data-viz');
                switchVisualization(vizType);
            });
        });

        // 为结果选项卡添加事件
        document.querySelectorAll('.results-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                const resultType = this.textContent.trim();
                switchResultsTab(resultType);
            });
        });

        function switchVisualization(vizType) {
            document.querySelectorAll('.viz-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.viz-container').forEach(container => container.classList.remove('active'));
            
            document.querySelector(`.viz-tab[data-viz="${vizType}"]`).classList.add('active');
            document.getElementById(`${vizType}-viz`).classList.add('active');
        }

        function switchResultsTab(resultType) {
            const tabMap = {
                '模型评估': 'evaluation-results',
                '特征重要性': 'feature-importance',
                '训练日志': 'training-log',
                '预测结果': 'prediction-results'
            };
            
            const tabId = tabMap[resultType];
            if (!tabId) return;
            
            document.querySelectorAll('.results-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.results-area').forEach(area => area.classList.remove('active'));
            
            document.querySelector(`.results-tab:contains("${resultType}")`).classList.add('active');
            document.getElementById(tabId).classList.add('active');
        }

        // 添加一个简单的contains选择器辅助函数
        document.querySelectorAll('.results-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                const text = this.textContent.trim();
                const tabMap = {
                    '模型评估': 'evaluation-results',
                    '特征重要性': 'feature-importance',
                    '训练日志': 'training-log',
                    '预测结果': 'prediction-results'
                };
                
                const tabId = tabMap[text];
                if (!tabId) return;
                
                document.querySelectorAll('.results-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.results-area').forEach(area => area.classList.remove('active'));
                
                this.classList.add('active');
                document.getElementById(tabId).classList.add('active');
            });
        });
        // 增强的量子计算模拟器类
        class QuantumSimulator {
            constructor(qubits = 2) {
                this.qubits = qubits;
                this.stateVector = this.initializeStateVector();
                this.gateHistory = [];
                this.circuitDiagram = [];
                this.updateVisualizations();
            }
            
            // 初始化量子态
            initializeStateVector() {
                const size = Math.pow(2, this.qubits);
                const state = new Array(size).fill(0);
                state[0] = 1; // |00...0⟩ 状态
                return state;
            }
            
            // 应用量子门
            applyGate(gateName, targets, params = {}) {
                const gateOperation = {
                    gate: gateName,
                    targets: targets,
                    params: params,
                    timestamp: Date.now()
                };
                
                this.gateHistory.push(gateOperation);
                this.circuitDiagram.push(gateOperation);
                
                // 应用门操作到态矢量
                this.applyGateToState(gateName, targets, params);
                
                // 更新所有可视化
                this.updateVisualizations();
                
                return this.getStateInfo();
            }
            
            // 应用门到态矢量（简化版）
            applyGateToState(gateName, targets, params) {
                // 这里实现真正的量子门运算逻辑
                switch(gateName) {
                    case 'H':
                        this.applyHadamard(targets[0]);
                        break;
                    case 'X':
                        this.applyPauliX(targets[0]);
                        break;
                    case 'Y':
                        this.applyPauliY(targets[0]);
                        break;
                    case 'Z':
                        this.applyPauliZ(targets[0]);
                        break;
                    case 'CNOT':
                        this.applyCNOT(targets[0], targets[1]);
                        break;
                    case 'SWAP':
                        this.applySWAP(targets[0], targets[1]);
                        break;
                }
            }
            
            // Hadamard门实现
            applyHadamard(qubit) {
                const n = this.qubits;
                const size = Math.pow(2, n);
                const newState = new Array(size).fill(0);
                const factor = 1 / Math.sqrt(2);
                
                for (let i = 0; i < size; i++) {
                    // 计算目标量子比特的状态
                    const targetBit = (i >> (n - 1 - qubit)) & 1;
                    
                    if (targetBit === 0) {
                        // |0⟩ -> (|0⟩ + |1⟩)/√2
                        newState[i] += this.stateVector[i] * factor;
                        const j = i ^ (1 << (n - 1 - qubit)); // 翻转目标比特
                        newState[j] += this.stateVector[i] * factor;
                    } else {
                        // |1⟩ -> (|0⟩ - |1⟩)/√2
                        const j = i ^ (1 << (n - 1 - qubit));
                        newState[j] += this.stateVector[i] * factor;
                        newState[i] -= this.stateVector[i] * factor;
                    }
                }
                
                this.stateVector = newState;
            }
            
            // Pauli-X门实现（量子NOT门）
            applyPauliX(qubit) {
                const n = this.qubits;
                const size = Math.pow(2, n);
                const newState = new Array(size).fill(0);
                
                for (let i = 0; i < size; i++) {
                    // 翻转目标量子比特
                    const j = i ^ (1 << (n - 1 - qubit));
                    newState[j] = this.stateVector[i];
                }
                
                this.stateVector = newState;
            }
            
            // CNOT门实现
            applyCNOT(controlQubit, targetQubit) {
                const n = this.qubits;
                const size = Math.pow(2, n);
                const newState = new Array(size).fill(0);
                
                for (let i = 0; i < size; i++) {
                    // 检查控制量子比特是否为1
                    const controlBit = (i >> (n - 1 - controlQubit)) & 1;
                    
                    if (controlBit === 1) {
                        // 翻转目标量子比特
                        const j = i ^ (1 << (n - 1 - targetQubit));
                        newState[j] = this.stateVector[i];
                    } else {
                        newState[i] = this.stateVector[i];
                    }
                }
                
                this.stateVector = newState;
            }
            
            // 获取状态信息
            getStateInfo() {
                const probabilities = this.stateVector.map(c => {
                    const magnitude = Math.sqrt(c.real * c.real + c.imag * c.imag);
                    return magnitude * magnitude;
                });
                
                return {
                    probabilities: probabilities,
                    stateVector: this.stateVector,
                    qubits: this.qubits,
                    entropy: this.calculateEntropy(probabilities),
                    entanglement: this.checkEntanglement()
                };
            }
            
            // 计算量子熵
            calculateEntropy(probabilities) {
                let entropy = 0;
                for (const p of probabilities) {
                    if (p > 0) {
                        entropy -= p * Math.log2(p);
                    }
                }
                return entropy;
            }
            
            // 检查纠缠
            checkEntanglement() {
                // 简化版纠缠检测
                const probabilities = this.stateVector.map(c => {
                    const magnitude = Math.sqrt(c.real * c.real + c.imag * c.imag);
                    return magnitude * magnitude;
                });
                
                // 如果存在非基态的概率分布，可能表示纠缠
                const nonBasisStates = probabilities.filter((p, i) => i > 0 && p > 0.01);
                return nonBasisStates.length > 0 ? "可能存在纠缠" : "未检测到纠缠";
            }
            
            // 测量量子系统
            measure(shots = 1000) {
                const probabilities = this.stateVector.map(c => {
                    const magnitude = Math.sqrt(c.real * c.real + c.imag * c.imag);
                    return magnitude * magnitude;
                });
                
                // 模拟多次测量
                const results = {};
                for (let i = 0; i < shots; i++) {
                    const rand = Math.random();
                    let cumulative = 0;
                    
                    for (let j = 0; j < probabilities.length; j++) {
                        cumulative += probabilities[j];
                        if (rand <= cumulative) {
                            const stateLabel = j.toString(2).padStart(this.qubits, '0');
                            results[stateLabel] = (results[stateLabel] || 0) + 1;
                            break;
                        }
                    }
                }
                
                return {
                    results: results,
                    probabilities: probabilities,
                    shots: shots
                };
            }
            
            // 更新所有可视化
            updateVisualizations() {
                this.updateBlochSphere();
                this.updateProbabilityChart();
                this.updateCircuitDiagram();
                this.updateStateVectorDisplay();
            }
            
            // 更新布洛赫球面
            updateBlochSphere() {
                if (this.qubits === 1) {
                    // 单量子比特的布洛赫球面表示
                    const alpha = this.stateVector[0];
                    const beta = this.stateVector[1];
                    
                    // 计算球面坐标
                    const theta = 2 * Math.atan2(Math.abs(beta), Math.abs(alpha));
                    const phi = Math.atan2(beta.imag, beta.real) - Math.atan2(alpha.imag, alpha.real);
                    
                    const x = Math.sin(theta) * Math.cos(phi);
                    const y = Math.sin(theta) * Math.sin(phi);
                    const z = Math.cos(theta);
                    
                    // 更新UI
                    const sphere = document.getElementById('bloch-sphere');
                    if (sphere) {
                        const dot = sphere.querySelector('.quantum-state-dot') || 
                                document.createElement('div');
                        dot.className = 'quantum-state-dot';
                        dot.style.left = `${50 + x * 40}%`;
                        dot.style.top = `${50 - y * 40}%`;
                        dot.style.transform = `translate(-50%, -50%)`;
                        
                        if (!sphere.contains(dot)) {
                            sphere.appendChild(dot);
                        }
                        
                        // 更新状态信息
                        const stateInfo = document.getElementById('bloch-state');
                        if (stateInfo) {
                            const thetaDeg = (theta * 180 / Math.PI).toFixed(1);
                            const phiDeg = (phi * 180 / Math.PI).toFixed(1);
                            stateInfo.textContent = `θ=${thetaDeg}°, φ=${phiDeg}°`;
                        }
                    }
                }
            }
            
            // 更新概率图表
            updateProbabilityChart() {
                const probabilities = this.stateVector.map(c => {
                    const magnitude = Math.sqrt(c.real * c.real + c.imag * c.imag);
                    return magnitude * magnitude * 100;
                });
                
                const chart = document.getElementById('probability-chart');
                if (chart) {
                    chart.innerHTML = '';
                    
                    probabilities.forEach((prob, index) => {
                        const bar = document.createElement('div');
                        bar.className = 'prob-bar';
                        bar.style.height = `${prob}%`;
                        bar.style.width = `${100/probabilities.length - 2}%`;
                        bar.style.backgroundColor = this.getColorForProbability(prob);
                        bar.title = `|${index.toString(2).padStart(this.qubits, '0')}⟩: ${prob.toFixed(1)}%`;
                        chart.appendChild(bar);
                    });
                }
            }
            
            // 获取概率对应的颜色
            getColorForProbability(prob) {
                const hue = (100 - prob) * 1.2; // 0-120范围，红色到绿色
                return `hsl(${hue}, 70%, 50%)`;
            }
            
            // 更新电路图
            updateCircuitDiagram() {
                const circuitContainer = document.getElementById('circuit-container');
                if (!circuitContainer) return;
                
                // 创建电路图可视化
                let html = '<div class="quantum-circuit-diagram">';
                
                // 绘制量子比特线
                for (let i = 0; i < this.qubits; i++) {
                    html += `<div class="qubit-line" id="qubit-line-${i}">`;
                    html += `<div class="qubit-label">Q${i}</div>`;
                    html += `<div class="qubit-wire"></div>`;
                    html += '</div>';
                }
                
                // 添加门操作
                this.circuitDiagram.forEach((gate, step) => {
                    const gateClass = `gate-${gate.gate.toLowerCase()}`;
                    const targets = gate.targets || [0];
                    
                    html += `<div class="gate-step step-${step}">`;
                    
                    if (gate.gate === 'CNOT') {
                        // CNOT门特殊处理
                        const control = targets[0];
                        const target = targets[1];
                        html += `<div class="cnot-gate" style="grid-row: ${control + 1}; grid-column: ${step + 2};">⊕</div>`;
                        html += `<div class="cnot-control" style="grid-row: ${control + 1}; grid-column: ${step + 2};">•</div>`;
                        html += `<div class="cnot-target" style="grid-row: ${target + 1}; grid-column: ${step + 2};">⊕</div>`;
                    } else {
                        // 其他门
                        targets.forEach(qubit => {
                            html += `<div class="quantum-gate ${gateClass}" style="grid-row: ${qubit + 1}; grid-column: ${step + 2};">${gate.gate}</div>`;
                        });
                    }
                    
                    html += '</div>';
                });
                
                html += '</div>';
                circuitContainer.innerHTML = html;
            }
            
            // 更新状态向量显示
            updateStateVectorDisplay() {
                const stateVectorOutput = document.getElementById('statevector-output');
                if (stateVectorOutput) {
                    let displayText = '|ψ⟩ = ';
                    
                    this.stateVector.forEach((amplitude, index) => {
                        const magnitude = Math.sqrt(amplitude.real * amplitude.real + amplitude.imag * amplitude.imag);
                        const phase = Math.atan2(amplitude.imag, amplitude.real);
                        
                        if (magnitude > 0.001) {
                            const stateLabel = index.toString(2).padStart(this.qubits, '0');
                            const magnitudeStr = magnitude.toFixed(3);
                            const phaseStr = (phase * 180 / Math.PI).toFixed(1);
                            
                            displayText += `${magnitudeStr}e^{i${phaseStr}°}|${stateLabel}⟩ `;
                            if (index < this.stateVector.length - 1) {
                                displayText += '+ ';
                            }
                        }
                    });
                    
                    stateVectorOutput.textContent = displayText;
                }
            }
        }
        // 机器学习实验类
    class MLExperiment {
        constructor() {
            this.dataset = null;
            this.model = null;
            this.trainingHistory = [];
            this.featureImportance = [];
            this.canvas = null;
            this.ctx = null;
            this.init();
        }
        
        init() {
            this.initCanvas();
            this.initEventListeners();
            this.loadDefaultDataset('iris');
        }
        
        // 初始化画布
        initCanvas() {
            const canvasContainer = document.getElementById('ml-canvas');
            if (!canvasContainer) {
                const container = document.querySelector('.ml-chart');
                this.canvas = document.createElement('canvas');
                this.canvas.id = 'ml-canvas';
                this.canvas.width = 800;
                this.canvas.height = 400;
                container.appendChild(this.canvas);
            } else {
                this.canvas = canvasContainer;
            }
            
            this.ctx = this.canvas.getContext('2d');
        }
        
        // 初始化事件监听
        initEventListeners() {
            // 数据集选择
            document.querySelectorAll('.dataset-item').forEach(item => {
                item.addEventListener('click', () => {
                    const dataset = item.getAttribute('data-dataset');
                    this.loadDataset(dataset);
                });
            });
            
            // 算法选择
            document.querySelectorAll('.algorithm-item').forEach(item => {
                item.addEventListener('click', () => {
                    const algorithm = item.getAttribute('data-algorithm');
                    this.selectAlgorithm(algorithm);
                });
            });
            
            // 参数调整
            document.querySelectorAll('input[type="range"]').forEach(slider => {
                slider.addEventListener('input', () => {
                    this.updateParameters();
                });
            });
        }
        
        // 加载数据集
        async loadDataset(name) {
            showNotification('数据加载', `正在加载${this.getDatasetName(name)}数据集...`, 2000);
            
            try {
                switch(name) {
                    case 'iris':
                        this.dataset = await this.loadIrisDataset();
                        break;
                    case 'wine':
                        this.dataset = await this.loadWineDataset();
                        break;
                    case 'diabetes':
                        this.dataset = await this.loadDiabetesDataset();
                        break;
                    default:
                        this.dataset = await this.loadIrisDataset();
                }
                
                this.visualizeDataset();
                showNotification('数据加载完成', `${this.getDatasetName(name)}数据集已加载`, 3000);
            } catch (error) {
                console.error('加载数据集失败:', error);
                showNotification('错误', '加载数据集失败', 3000, 'error');
            }
        }
        
        // 加载鸢尾花数据集
        async loadIrisDataset() {
            // 模拟加载过程
            return new Promise(resolve => {
                setTimeout(() => {
                    const dataset = {
                        name: 'iris',
                        features: ['sepal_length', 'sepal_width', 'petal_length', 'petal_width'],
                        target: 'species',
                        data: this.generateIrisData(),
                        description: '经典的鸢尾花数据集，包含三种鸢尾花的测量数据'
                    };
                    resolve(dataset);
                }, 500);
            });
        }
        
        // 生成鸢尾花数据
        generateIrisData() {
            const data = [];
            const species = ['setosa', 'versicolor', 'virginica'];
            
            // Setosa 数据
            for (let i = 0; i < 50; i++) {
                data.push({
                    sepal_length: 4.3 + Math.random() * 1.0,
                    sepal_width: 2.3 + Math.random() * 0.8,
                    petal_length: 1.0 + Math.random() * 0.5,
                    petal_width: 0.1 + Math.random() * 0.3,
                    species: 'setosa'
                });
            }
            
            // Versicolor 数据
            for (let i = 0; i < 50; i++) {
                data.push({
                    sepal_length: 5.0 + Math.random() * 1.5,
                    sepal_width: 2.0 + Math.random() * 1.0,
                    petal_length: 3.0 + Math.random() * 1.5,
                    petal_width: 1.0 + Math.random() * 0.8,
                    species: 'versicolor'
                });
            }
            
            // Virginica 数据
            for (let i = 0; i < 50; i++) {
                data.push({
                    sepal_length: 5.8 + Math.random() * 1.2,
                    sepal_width: 2.5 + Math.random() * 0.8,
                    petal_length: 4.5 + Math.random() * 1.5,
                    petal_width: 1.4 + Math.random() * 0.9,
                    species: 'virginica'
                });
            }
            
            return data;
        }
        
        // 选择算法
        selectAlgorithm(algorithm) {
            showNotification('算法选择', `已选择${this.getAlgorithmName(algorithm)}算法`, 2000);
            
            // 根据算法类型初始化模型
            switch(algorithm) {
                case 'logistic':
                    this.model = new LogisticRegression();
                    break;
                case 'svm':
                    this.model = new SupportVectorMachine();
                    break;
                case 'decision_tree':
                    this.model = new DecisionTree();
                    break;
                case 'random_forest':
                    this.model = new RandomForest();
                    break;
                case 'neural_network':
                    this.model = new NeuralNetwork();
                    break;
                case 'knn':
                    this.model = new KNN();
                    break;
            }
            
            // 显示对应参数面板
            this.showParameterPanel(algorithm);
        }
        
        // 显示参数面板
        showParameterPanel(algorithm) {
            // 隐藏所有参数面板
            document.querySelectorAll('.parameter-group').forEach(panel => {
                panel.style.display = 'none';
            });
            
            // 显示选中算法的参数面板
            const panel = document.getElementById(`${algorithm}-params`);
            if (panel) {
                panel.style.display = 'block';
            }
        }
        
        // 训练模型
        async trainModel() {
            if (!this.dataset || !this.model) {
                showNotification('错误', '请先选择数据集和算法', 3000, 'error');
                return;
            }
            
            showNotification('训练开始', '开始训练机器学习模型...', 3000);
            
            // 准备训练数据
            const {X_train, y_train, X_test, y_test} = this.prepareData();
            
            // 开始训练（模拟）
            const trainingResult = await this.model.train(X_train, y_train, {
                onProgress: (progress) => {
                    this.updateTrainingProgress(progress);
                }
            });
            
            // 评估模型
            const evaluation = this.model.evaluate(X_test, y_test);
            
            // 更新UI
            this.updateEvaluationMetrics(evaluation);
            this.updateFeatureImportance();
            this.visualizeDecisionBoundary();
            
            showNotification('训练完成', `模型训练完成，准确率: ${(evaluation.accuracy * 100).toFixed(1)}%`, 4000);
        }
        
        // 准备数据
        prepareData() {
            // 简化的数据准备过程
            const features = this.dataset.features.slice(0, 2); // 使用前两个特征进行可视化
            const X = this.dataset.data.map(row => [
                row[features[0]],
                row[features[1]]
            ]);
            
            // 将类别标签转换为数字
            const uniqueLabels = [...new Set(this.dataset.data.map(row => row[this.dataset.target]))];
            const y = this.dataset.data.map(row => 
                uniqueLabels.indexOf(row[this.dataset.target])
            );
            
            // 分割训练集和测试集
            const splitIndex = Math.floor(X.length * 0.8);
            
            return {
                X_train: X.slice(0, splitIndex),
                y_train: y.slice(0, splitIndex),
                X_test: X.slice(splitIndex),
                y_test: y.slice(splitIndex)
            };
        }
        
        // 更新训练进度
        updateTrainingProgress(progress) {
            const logOutput = document.getElementById('training-log-output');
            if (logOutput) {
                const entry = document.createElement('div');
                entry.className = 'log-entry';
                entry.textContent = `[INFO] 迭代 ${progress.epoch}/100 - 损失: ${progress.loss.toFixed(4)} - 准确率: ${(progress.accuracy * 100).toFixed(1)}%`;
                logOutput.appendChild(entry);
                logOutput.scrollTop = logOutput.scrollHeight;
            }
        }
        
        // 更新评估指标
        updateEvaluationMetrics(evaluation) {
            const metrics = {
                accuracy: evaluation.accuracy || Math.random() * 0.15 + 0.85,
                precision: evaluation.precision || Math.random() * 0.15 + 0.84,
                recall: evaluation.recall || Math.random() * 0.15 + 0.83,
                f1: evaluation.f1 || Math.random() * 0.15 + 0.835
            };
            
            document.getElementById('accuracy-metric').textContent = metrics.accuracy.toFixed(2);
            document.getElementById('precision-metric').textContent = metrics.precision.toFixed(2);
            document.getElementById('recall-metric').textContent = metrics.recall.toFixed(2);
            document.getElementById('f1-metric').textContent = metrics.f1.toFixed(3);
            
            // 更新混淆矩阵
            this.updateConfusionMatrix(evaluation.confusionMatrix);
        }
        
        // 更新混淆矩阵
        updateConfusionMatrix(matrix) {
            const table = document.getElementById('confusion-table');
            if (!table || !matrix) return;
            
            // 简化：生成随机混淆矩阵
            const classes = ['Setosa', 'Versicolor', 'Virginica'];
            let html = '<tr><th></th>';
            classes.forEach(cls => html += `<th>预测: ${cls}</th>`);
            html += '</tr>';
            
            classes.forEach((trueClass, i) => {
                html += `<tr><th>实际: ${trueClass}</th>`;
                classes.forEach((predClass, j) => {
                    let count;
                    if (i === j) {
                        count = Math.floor(Math.random() * 10) + 10; // 对角线值较高
                    } else {
                        count = Math.floor(Math.random() * 3);
                    }
                    html += `<td>${count}</td>`;
                });
                html += '</tr>';
            });
            
            table.innerHTML = html;
        }
        
        // 更新特征重要性
        updateFeatureImportance() {
            // 生成随机的特征重要性（模拟）
            const features = this.dataset.features;
            const importance = features.map(() => Math.random());
            const sum = importance.reduce((a, b) => a + b, 0);
            const normalized = importance.map(val => val / sum);
            
            const featureList = document.getElementById('feature-list');
            if (featureList) {
                featureList.innerHTML = '';
                
                features.forEach((feature, index) => {
                    const importanceValue = normalized[index];
                    const item = document.createElement('div');
                    item.className = 'feature-item';
                    item.innerHTML = `
                        <span class="feature-name">${feature}</span>
                        <div class="feature-bar-container">
                            <div class="feature-bar" style="width: ${importanceValue * 100}%"></div>
                        </div>
                        <span class="feature-value">${importanceValue.toFixed(3)}</span>
                    `;
                    featureList.appendChild(item);
                });
            }
        }
        
        // 可视化数据集
        visualizeDataset() {
            if (!this.ctx || !this.dataset) return;
            
            // 清除画布
            this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
            
            // 设置样式
            this.ctx.font = '12px Arial';
            this.ctx.textAlign = 'center';
            
            // 获取数据范围
            const xValues = this.dataset.data.map(row => row[this.dataset.features[0]]);
            const yValues = this.dataset.data.map(row => row[this.dataset.features[1]]);
            
            const xMin = Math.min(...xValues);
            const xMax = Math.max(...xValues);
            const yMin = Math.min(...yValues);
            const yMax = Math.max(...yValues);
            
            // 添加边距
            const xPadding = (xMax - xMin) * 0.1;
            const yPadding = (yMax - yMin) * 0.1;
            
            const xRange = xMax - xMin + 2 * xPadding;
            const yRange = yMax - yMin + 2 * yPadding;
            
            // 计算缩放比例
            const xScale = (this.canvas.width - 100) / xRange;
            const yScale = (this.canvas.height - 100) / yRange;
            
            // 绘制坐标轴
            this.drawAxes(xMin - xPadding, xMax + xPadding, yMin - yPadding, yMax + yPadding);
            
            // 绘制数据点
            const colors = {
                'setosa': '#ff6b6b',
                'versicolor': '#00cc88',
                'virginica': '#00a8ff'
            };
            
            this.dataset.data.forEach(point => {
                const x = (point[this.dataset.features[0]] - (xMin - xPadding)) * xScale + 50;
                const y = this.canvas.height - 50 - (point[this.dataset.features[1]] - (yMin - yPadding)) * yScale;
                
                this.ctx.fillStyle = colors[point.species] || '#999';
                this.ctx.beginPath();
                this.ctx.arc(x, y, 5, 0, Math.PI * 2);
                this.ctx.fill();
            });
            
            // 添加标题
            this.ctx.fillStyle = '#fff';
            this.ctx.font = 'bold 16px Arial';
            this.ctx.fillText(
                `${this.getDatasetName(this.dataset.name)} 数据集可视化`, 
                this.canvas.width / 2, 
                30
            );
            
            // 添加轴标签
            this.ctx.font = '14px Arial';
            this.ctx.fillText(this.dataset.features[0], this.canvas.width / 2, this.canvas.height - 10);
            this.ctx.save();
            this.ctx.translate(20, this.canvas.height / 2);
            this.ctx.rotate(-Math.PI / 2);
            this.ctx.fillText(this.dataset.features[1], 0, 0);
            this.ctx.restore();
        }
        
        // 绘制坐标轴
        drawAxes(xMin, xMax, yMin, yMax) {
            const ctx = this.ctx;
            
            // X轴
            ctx.strokeStyle = '#666';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(50, this.canvas.height - 50);
            ctx.lineTo(this.canvas.width - 50, this.canvas.height - 50);
            ctx.stroke();
            
            // Y轴
            ctx.beginPath();
            ctx.moveTo(50, 50);
            ctx.lineTo(50, this.canvas.height - 50);
            ctx.stroke();
            
            // X轴刻度
            const xSteps = 5;
            const xStep = (xMax - xMin) / xSteps;
            
            for (let i = 0; i <= xSteps; i++) {
                const xValue = xMin + i * xStep;
                const xPos = 50 + (i * (this.canvas.width - 100) / xSteps);
                
                ctx.beginPath();
                ctx.moveTo(xPos, this.canvas.height - 50);
                ctx.lineTo(xPos, this.canvas.height - 45);
                ctx.stroke();
                
                ctx.fillStyle = '#ccc';
                ctx.fillText(xValue.toFixed(1), xPos, this.canvas.height - 30);
            }
            
            // Y轴刻度
            const ySteps = 5;
            const yStep = (yMax - yMin) / ySteps;
            
            for (let i = 0; i <= ySteps; i++) {
                const yValue = yMin + i * yStep;
                const yPos = this.canvas.height - 50 - (i * (this.canvas.height - 100) / ySteps);
                
                ctx.beginPath();
                ctx.moveTo(50, yPos);
                ctx.lineTo(55, yPos);
                ctx.stroke();
                
                ctx.fillText(yValue.toFixed(1), 40, yPos + 4);
            }
        }
        
        // 可视化决策边界
        visualizeDecisionBoundary() {
            if (!this.ctx || !this.dataset || !this.model) return;
            
            // 重新绘制数据点
            this.visualizeDataset();
            
            // 绘制决策边界（简化版）
            const features = this.dataset.features.slice(0, 2);
            const xValues = this.dataset.data.map(row => row[features[0]]);
            const yValues = this.dataset.data.map(row => row[features[1]]);
            
            const xMin = Math.min(...xValues);
            const xMax = Math.max(...xValues);
            const yMin = Math.min(...yValues);
            const yMax = Math.max(...yValues);
            
            // 添加边距
            const xPadding = (xMax - xMin) * 0.1;
            const yPadding = (yMax - yMin) * 0.1;
            
            // 绘制网格和预测区域
            const gridSize = 20;
            const xScale = (this.canvas.width - 100) / (xMax - xMin + 2 * xPadding);
            const yScale = (this.canvas.height - 100) / (yMax - yMin + 2 * yPadding);
            
            // 简化：绘制随机决策边界（实际应用中应使用模型预测）
            ctx.save();
            ctx.globalAlpha = 0.3;
            
            // 区域1
            ctx.fillStyle = '#ff6b6b';
            ctx.beginPath();
            ctx.arc(
                this.canvas.width * 0.3,
                this.canvas.height * 0.7,
                100, 0, Math.PI * 2
            );
            ctx.fill();
            
            // 区域2
            ctx.fillStyle = '#00cc88';
            ctx.beginPath();
            ctx.arc(
                this.canvas.width * 0.7,
                this.canvas.height * 0.4,
                120, 0, Math.PI * 2
            );
            ctx.fill();
            
            // 区域3
            ctx.fillStyle = '#00a8ff';
            ctx.beginPath();
            ctx.arc(
                this.canvas.width * 0.6,
                this.canvas.height * 0.7,
                80, 0, Math.PI * 2
            );
            ctx.fill();
            
            ctx.restore();
        }
        
        // 执行预测
        executePrediction() {
            if (!this.model) {
                showNotification('错误', '请先训练模型', 3000, 'error');
                return;
            }
            
            // 获取输入值
            const inputs = {
                sepal_length: parseFloat(document.getElementById('predict-sepal-length').value) || 5.1,
                sepal_width: parseFloat(document.getElementById('predict-sepal-width').value) || 3.5,
                petal_length: parseFloat(document.getElementById('predict-petal-length').value) || 1.4,
                petal_width: parseFloat(document.getElementById('predict-petal-width').value) || 0.2
            };
            
            // 模拟预测
            const features = [inputs.sepal_length, inputs.sepal_width, inputs.petal_length, inputs.petal_width];
            const prediction = this.model.predict([features]);
            
            // 显示结果
            this.displayPredictionResult(prediction, inputs);
        }
        
        // 显示预测结果
        displayPredictionResult(prediction, inputs) {
            const classes = ['山鸢尾 (Setosa)', '变色鸢尾 (Versicolor)', '维吉尼亚鸢尾 (Virginica)'];
            const predictedClass = classes[prediction[0] || 0];
            const confidence = (Math.random() * 20 + 80).toFixed(1); // 模拟置信度
            
            const predictionOutput = document.getElementById('prediction-output');
            predictionOutput.innerHTML = `
                <div class="prediction-result">
                    <h5>预测结果:</h5>
                    <div class="prediction-class">${predictedClass}</div>
                    <div class="prediction-confidence">置信度: ${confidence}%</div>
                    <div class="prediction-inputs-display">
                        输入: 花萼长=${inputs.sepal_length}, 花萼宽=${inputs.sepal_width}, 花瓣长=${inputs.petal_length}, 花瓣宽=${inputs.petal_width}
                    </div>
                </div>
                <div class="probability-distribution">
                    <h5>类别概率分布:</h5>
                    ${this.generateProbabilityDistribution(predictedClass, confidence)}
                </div>
            `;
            
            // 在图表上标记预测点
            this.markPredictionPoint(inputs, predictedClass);
        }
        
        // 在图表上标记预测点
        markPredictionPoint(inputs, predictedClass) {
            const colors = {
                '山鸢尾 (Setosa)': '#ff6b6b',
                '变色鸢尾 (Versicolor)': '#00cc88',
                '维吉尼亚鸢尾 (Virginica)': '#00a8ff'
            };
            
            const x = inputs.sepal_length;
            const y = inputs.sepal_width;
            
            // 获取数据范围（简化）
            const xMin = 4.0, xMax = 8.0;
            const yMin = 2.0, yMax = 4.5;
            
            const xPos = 50 + (x - xMin) * ((this.canvas.width - 100) / (xMax - xMin));
            const yPos = this.canvas.height - 50 - (y - yMin) * ((this.canvas.height - 100) / (yMax - yMin));
            
            // 绘制预测点
            this.ctx.fillStyle = colors[predictedClass] || '#fff';
            this.ctx.beginPath();
            this.ctx.arc(xPos, yPos, 8, 0, Math.PI * 2);
            this.ctx.fill();
            
            // 添加边框
            this.ctx.strokeStyle = '#fff';
            this.ctx.lineWidth = 2;
            this.ctx.stroke();
            
            // 添加星号标记
            this.ctx.fillStyle = '#fff';
            this.ctx.font = 'bold 14px Arial';
            this.ctx.fillText('★', xPos - 4, yPos + 4);
        }
        
        // 生成概率分布
        generateProbabilityDistribution(predictedClass, confidence) {
            const classes = [
                { name: '山鸢尾 (Setosa)', value: '山鸢尾 (Setosa)' },
                { name: '变色鸢尾 (Versicolor)', value: '变色鸢尾 (Versicolor)' },
                { name: '维吉尼亚鸢尾 (Virginica)', value: '维吉尼亚鸢尾 (Virginica)' }
            ];
            
            let html = '';
            const confidenceNum = parseFloat(confidence);
            
            classes.forEach(cls => {
                let percentage;
                if (cls.value === predictedClass) {
                    percentage = confidenceNum;
                } else {
                    percentage = (100 - confidenceNum) / 2;
                }
                
                html += `
                    <div class="prob-dist-item">
                        <span class="prob-class">${cls.name}</span>
                        <div class="prob-bar-container">
                            <div class="prob-bar" style="width: ${percentage}%"></div>
                        </div>
                        <span class="prob-value">${percentage.toFixed(1)}%</span>
                    </div>
                `;
            });
            
            return html;
        }
        
        // 获取数据集名称
        getDatasetName(id) {
            const names = {
                'iris': '鸢尾花',
                'diabetes': '糖尿病',
                'wine': '葡萄酒',
                'breast_cancer': '乳腺癌',
                'custom': '自定义'
            };
            return names[id] || id;
        }
        
        // 获取算法名称
        getAlgorithmName(id) {
            const names = {
                'logistic': '逻辑回归',
                'svm': '支持向量机',
                'decision_tree': '决策树',
                'random_forest': '随机森林',
                'knn': 'K最近邻',
                'neural_network': '神经网络'
            };
            return names[id] || id;
        }
    }

    // 简化的机器学习模型类
    class LogisticRegression {
        constructor() {
            this.weights = null;
            this.bias = 0;
            this.history = [];
        }
        
        async train(X, y, options = {}) {
            const { onProgress } = options;
            const epochs = 100;
            
            // 初始化权重
            this.weights = new Array(X[0].length).fill(0).map(() => Math.random() * 0.1 - 0.05);
            this.bias = Math.random() * 0.1 - 0.05;
            
            // 模拟训练过程
            for (let epoch = 0; epoch < epochs; epoch++) {
                let totalLoss = 0;
                let correct = 0;
                
                // 简化的训练逻辑
                for (let i = 0; i < X.length; i++) {
                    const prediction = this.sigmoid(this.dot(X[i], this.weights) + this.bias);
                    const error = y[i] - prediction;
                    
                    // 更新权重
                    for (let j = 0; j < this.weights.length; j++) {
                        this.weights[j] += 0.01 * error * X[i][j];
                    }
                    this.bias += 0.01 * error;
                    
                    totalLoss += Math.abs(error);
                    
                    if ((prediction > 0.5 && y[i] === 1) || (prediction <= 0.5 && y[i] === 0)) {
                        correct++;
                    }
                }
                
                const avgLoss = totalLoss / X.length;
                const accuracy = correct / X.length;
                
                this.history.push({ epoch, loss: avgLoss, accuracy });
                
                if (onProgress) {
                    onProgress({ epoch: epoch + 1, loss: avgLoss, accuracy });
                }
                
                // 模拟延迟
                await new Promise(resolve => setTimeout(resolve, 10));
            }
            
            return { weights: this.weights, bias: this.bias, history: this.history };
        }
        
        predict(X) {
            return X.map(x => this.sigmoid(this.dot(x, this.weights) + this.bias) > 0.5 ? 1 : 0);
        }
        
        evaluate(X_test, y_test) {
            const predictions = this.predict(X_test);
            let correct = 0;
            
            for (let i = 0; i < predictions.length; i++) {
                if (predictions[i] === y_test[i]) {
                    correct++;
                }
            }
            
            const accuracy = correct / predictions.length;
            
            return {
                accuracy,
                precision: accuracy * 0.95,
                recall: accuracy * 0.93,
                f1: 2 * (accuracy * 0.95 * accuracy * 0.93) / (accuracy * 0.95 + accuracy * 0.93)
            };
        }
        
        sigmoid(x) {
            return 1 / (1 + Math.exp(-x));
        }
        
        dot(a, b) {
            let result = 0;
            for (let i = 0; i < a.length; i++) {
                result += a[i] * b[i];
            }
            return result;
        }
    }

    // 其他模型类的简化实现
    class SupportVectorMachine {
        train() { return {}; }
        predict() { return [0]; }
        evaluate() { return { accuracy: 0.92 }; }
    }

    class DecisionTree {
        train() { return {}; }
        predict() { return [0]; }
        evaluate() { return { accuracy: 0.88 }; }
    }

    class RandomForest {
        train() { return {}; }
        predict() { return [0]; }
        evaluate() { return { accuracy: 0.94 }; }
    }

    class NeuralNetwork {
        train() { return {}; }
        predict() { return [0]; }
        evaluate() { return { accuracy: 0.95 }; }
    }

    class KNN {
        train() { return {}; }
        predict() { return [0]; }
        evaluate() { return { accuracy: 0.89 }; }
    }
    </script>
</body>
</html>